<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>AD7879 Input Touch Screen Digitizer Linux Driver &#8212; Linux Kernel: Variant from Analog Devices, Inc. v6.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=8e8a900e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/style.min.css?v=cf8483f0" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    <script src="../../../_static/documentation_options.js?v=cb43cce9"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/tabs.js?v=3ee01567"></script>
    <script defer="" src="../../../_static/app.umd.js?v=96350458"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="ADP1650 LED Flash Linux Driver" href="../leds/adp1650.html" />
    <link rel="prev" title="AD7877 Input Touch Screen Controller Linux Driver" href="ad7877.html" />
   
  
    <meta name="robots" content="noindex">
  
  


<style>
  body {
    
  }

  body.dark {
    
  }

  @media (prefers-color-scheme: dark) {
    body:not(.light) {
      
    }
  }
</style>
  </head><body>
  <input type="checkbox" id="input-show-toc">
  <input type="checkbox" id="input-show-localtoc">
  <header>
    <div class="header">
      <div id="left">
        <label id="show-sidebar" for="input-show-toc" title="Show/hide index"></label>
      </div>
      <div id="right">
        <span>
          <a id="logo-org" href="https://analog.com"></a>
              <a id="no-logo" href="../../../index.html">
                Linux Kernel: Variant from Analog Devices, Inc.
              </a>
        </span>
        <span class="reverse">
          <label id="show-localtoc" for="input-show-localtoc" title="Show/hide contents"></label>
        </span>
      </div>
    </div>
    <div class="repotoc-tree">
      <root>
  <a href="../../../../documentation/eval/index.html">Evaluation Boards</a>
  <a href="../../../../documentation/university/index.html">University Program</a>
  <a href="../../../../hdl/index.html">HDL</a>
  <a href="../../../../no-OS/index.html">no-OS</a>
  <a href="../../../../pyadi-iio/index.html">pyadi-iio</a>
  <a href="../../../../precision-converters-firmware/index.html">Precision Converters Firmware</a>
  <a href="../../../../PrecisionToolbox/index.html">Precision Toolbox</a>
</root>

    </div>
  </header>

    <div class="localtoc">
      <div class="tocwrapper">
        <div>
          <div class="localtoc-header">On this page</div>
          <a id="scroll-up" href="#top-anchor" title="Back to top"></a>
        </div>
        <nav>
          <ul>
<li><a class="reference internal" href="#">AD7879 Input Touch Screen Digitizer Linux Driver</a><ul>
<li><a class="reference internal" href="#supported-devices">Supported Devices</a></li>
<li><a class="reference internal" href="#evaluation-boards">Evaluation Boards</a></li>
<li><a class="reference internal" href="#description">Description</a></li>
<li><a class="reference internal" href="#configuration">Configuration</a></li>
<li><a class="reference internal" href="#software-configurable-features">Software configurable features</a></li>
<li><a class="reference internal" href="#source-code">Source Code</a><ul>
<li><a class="reference internal" href="#status">Status</a></li>
<li><a class="reference internal" href="#files">Files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-platform-device-initialization">Example platform device initialization</a><ul>
<li><a class="reference internal" href="#example-platform-board-file-spi-interface-version">Example Platform / Board file (SPI Interface Version)</a></li>
<li><a class="reference internal" href="#example-platform-board-file-i2c-interface-version">Example Platform / Board file (I2C Interface Version)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adding-linux-driver-support">Adding Linux driver support</a></li>
<li><a class="reference internal" href="#hardware-configuration">Hardware configuration</a></li>
<li><a class="reference internal" href="#driver-testing">Driver testing</a><ul>
<li><a class="reference internal" href="#driver-compiled-as-a-module">Driver compiled as a module</a></li>
<li><a class="reference internal" href="#driver-compiled-into-the-kernel">Driver compiled into the kernel</a></li>
<li><a class="reference internal" href="#common-problems">Common Problems</a></li>
<li><a class="reference internal" href="#checking-for-proper-installation">Checking for proper installation</a></li>
<li><a class="reference internal" href="#use-the-event-test-utility-to-test-proper-function">Use the event_test utility to test proper function</a></li>
<li><a class="reference internal" href="#find-input-by-name">Find Input by name</a></li>
<li><a class="reference internal" href="#touchscreen-calibration">Touchscreen calibration</a></li>
<li><a class="reference internal" href="#using-the-ad7879-in-microwin-nano-x">Using the AD7879 in Microwin / Nano-X</a><ul>
<li><a class="reference internal" href="#user-configuration">User Configuration</a></li>
<li><a class="reference internal" href="#testing-and-calibration">Testing and Calibration</a></li>
<li><a class="reference internal" href="#nanox-with-tslib">Nanox with tslib</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-links-graphical-browser">Example Links Graphical Browser</a><ul>
<li><a class="reference internal" href="#enable-links">Enable Links</a></li>
<li><a class="reference internal" href="#start-links">Start Links</a></li>
</ul>
</li>
<li><a class="reference internal" href="#driver-source">Driver Source</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </nav>
      </div>
    </div>

  
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
              <a id="no-logo" href="../../../index.html">
                Linux Kernel: Variant from Analog Devices, Inc.
              </a><input id="input-switch-toc" type="checkbox">
<label id="show-repotoc" for="input-switch-toc">
All content
</label>
<label id="show-toc" for="input-switch-toc">
Content on this topic
</label>
<div class="repotoc-tree">
  <root>
  <a href="../../../../documentation/eval/index.html">Evaluation Boards</a>
  <a href="../../../../documentation/university/index.html">University Program</a>
  <a href="../../../../hdl/index.html">HDL</a>
  <a href="../../../../no-OS/index.html">no-OS</a>
  <a href="../../../../pyadi-iio/index.html">pyadi-iio</a>
  <a href="../../../../precision-converters-firmware/index.html">Precision Converters Firmware</a>
  <a href="../../../../PrecisionToolbox/index.html">Precision Toolbox</a>
</root>

</div>
<div class="toc-tree">
  <html>
  <body><ul class="current">
<li class="toctree-l1 current"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-1" id="toctree-collapse-1" checked=""/><div class="collapse"><a class="reference internal" href="../../../drivers_index.html">Linux Drivers</a><label for="toctree-collapse-1"><div class="icon"></div></label></div><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../multifunction-device/adp5520.html">ADP5501</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backlight/adp8860.html">ADP8860</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backlight/adp8870.html">ADP8870</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clk/adi/clk-ad9545.c.html">AD9545</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-keyboard/adp5588.html">ADP5587</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-keyboard/adp5589.html">ADP5585</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hwmon/axi_fan_control.html">Fan Control IP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hwmon/ltc2947.html">LTC2947</a></li>
<li class="toctree-l2"><a class="reference internal" href="../net-phy/adin1100.html">ADIN1100</a></li>
<li class="toctree-l2"><a class="reference internal" href="../net-phy/adin.html">ADIN1200</a></li>
<li class="toctree-l2"><a class="reference internal" href="../net-mac-phy/adin1110.html">ADIN1110</a></li>
<li class="toctree-l2"><a class="reference internal" href="../net-mac-phy/adin2111.html">ADIN2111</a></li>
<li class="toctree-l2"><a class="reference internal" href="../net-mac-phy/open_alliance.html">Open Alliance - 10BASE-T1x MAC-PHY Serial Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adxl313.html">ADXL312,</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-misc/adxl345.html">ADXL345</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adxl355.html">ADXL355</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-misc/adxl362.html">ADXL362</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adxl367.html">ADXL367</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adxl372.html">ADXL372</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adis16201.html">ADIS16201</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adis16203.html">ADIS16203</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adis16209.html">ADIS16209</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adis16240.html">ADIS16240</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-amplifiers/ad8366.html">AD8366</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-amplifiers/ada4250.html">ADA4250</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-amplifiers/hmc425a.html">HMC425</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad400x.html">AD4003</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad4630.html">AD4030-24</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad9208.html">AD6684</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7476a.html">AD7091</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7091r5.html">AD7091R-5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7091r8.html">AD7091R-8</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7124.html">AD7124</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7780.html">AD7170</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7192.html">AD7190</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7266.html">AD7265</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7280a.html">AD7280A</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7291.html">AD7291</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7298.html">AD7298</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad738x.html">AD7380</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7606.html">AD7605-4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7766.html">AD7766-1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7768-1.html">AD7768-1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7768.html">AD7768</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7793.html">AD7785</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7791.html">AD7787</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7887.html">AD7887</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7998.html">AD7991</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad9083.html">AD9083</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-mxfe/ad9081.html">AD9207</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../resources/tools-software/linux-drivers/iio-adc/ad9208.html">AD9208</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/axi-adc-hdl.html">AD9234</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/adaq8092.html">ADAQ8092</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/adas1000.html">ADAS1000</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-transceiver/adar1000.html">ADAR1000</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-cdc/ad7152.html">AD7152</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-cdc/ad7150.html">AD7150</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-cdc/ad7745.html">AD7745</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-addac/ad74413r.html">AD74412R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/axi-ad3552r.html">AD3552R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5064.html">AD5024</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5446.html">AD5300</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5676.html">AD5310R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5360.html">AD5360</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5380.html">AD5380</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5449.html">AD5415</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5421.html">AD5421</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5504.html">AD5501</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5592r.html">AD5592R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5593r.html">AD5593R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5624r.html">AD5624</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5755.html">AD5735</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5764.html">AD5744</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5758.html">AD5758</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5791.html">AD5760</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5770r.html">AD5770R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dds/axi-dac-dds-hdl.html">AD9122</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ltc2664.html">LTC2664</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dds/ad9832.html">AD9832</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dds/ad9834.html">AD9833</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-filter/admv8818.html">ADMV8818</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ad9162.html">AD9161</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ad9508.html">AD9508</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ad9517.html">AD9516-0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ad9523.html">AD9523-1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ad9528.html">AD9528</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf4159.html">ADF4159</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf4350.html">ADF4350</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf4360.html">ADF4360-0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf4371.html">ADF4371</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf4377.html">ADF4377</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf5355.html">ADF4355</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/admv1013.html">ADMV1013</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/admv1014.html">ADMV1014</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adrf6780.html">ADRF6780</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/hmc7044.html">HMC7044</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ltc6952.html">LTC6952</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adis16060.html">ADIS16060</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adis16080.html">ADIS16080</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adis16130.html">ADIS16130</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adis16136.html">ADIS16133</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adis16260.html">ADIS16251</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adxrs450.html">ADXRS450</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-impedance-analyzer/ad5933.html">AD5933</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-inertial-measurement-units/adis16400.html">ADIS16300</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-inertial-measurement-units/adis16480.html">ADIS16375</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-inertial-measurement-units/adis16475.html">ADIS16460</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-resolver/ad2s90.html">AD2S90</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-resolver/ad2s1200.html">AD2S1200</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-resolver/ad2s1210.html">AD2S1210</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad6676.html">AD6676</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-transceiver/ad9361.html">AD9361</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-transceiver/ad9371.html">AD9371</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-transceiver/adrv9002.html">ADRV9002</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-transceiver/adrv9009.html">ADRV9008-1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-temperature/ltc2983.html">LTC2983</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-vector-power/adl5960.html">ADL5960</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-misc/ad714x.html">AD7142</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7873.html">AD7873</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7877.html">AD7877</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">AD7879</a></li>
<li class="toctree-l2"><a class="reference internal" href="../leds/adp1650.html">ADP1650</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc/dpot.html">AD5160</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mux/adgs1408.html">ADGS1408</a></li>
<li class="toctree-l2"><a class="reference internal" href="../networking-mac802154/adf7242.html">ADF7241</a></li>
<li class="toctree-l2"><a class="reference internal" href="../regulator/adp150.html">ADP122</a></li>
<li class="toctree-l2"><a class="reference internal" href="../regulator/ad5398.html">AD5398</a></li>
<li class="toctree-l2"><a class="reference internal" href="../serial/max310x.html">MAX3107</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/ad1835a.html">AD1835A</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/ad1936.html">AD1933</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/ad73322.html">AD73311</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/adau1361.html">ADAU1361</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/adau1372.html">ADAU1372</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/adau1373.html">ADAU1373</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/adau1381.html">ADAU1381</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/adau1701.html">ADAU1401A</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/adau1977.html">ADAU1977</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/adau7002.html">ADAU7002</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/adau7118.html">ADAU7118</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/adav801.html">ADAV801</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/ssm2602.html">SSM2602</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/ssm4567.html">SSM4567</a></li>
<li class="toctree-l2"><a class="reference internal" href="../drm/adv7511.html">ADV7511</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../guides/build.html">Building Kernels</a></li>
</ul>
</body>
</html>

</div>
        </div>
      </div>

  <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper" id="top-anchor">
          <div class="body" role="main">
            
  <section class="tex2jax_ignore mathjax_ignore" id="ad7879-input-touch-screen-digitizer-linux-driver">
<h1>AD7879 Input Touch Screen Digitizer Linux Driver<a class="headerlink" href="#ad7879-input-touch-screen-digitizer-linux-driver" title="Link to this heading">¶</a></h1>
<section id="supported-devices">
<h2>Supported Devices<a class="headerlink" href="#supported-devices" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://analog.com/AD7879">AD7879</a></p></li>
<li><p><a class="reference external" href="https://analog.com/AD7879">AD7879-1</a></p></li>
<li><p><a class="reference external" href="https://analog.com/AD7889">AD7889</a></p></li>
<li><p><a class="reference external" href="https://analog.com/AD7889">AD7889-1</a></p></li>
</ul>
</section>
<section id="evaluation-boards">
<h2>Evaluation Boards<a class="headerlink" href="#evaluation-boards" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://analog.com/EVAL-AD7879EBZ">EVAL-AD7879EBZ</a></p></li>
<li><p><a class="reference external" href="https://analog.com/EVAL-AD7879-1EBZ">EVAL-AD7879-1EBZ</a></p></li>
</ul>
</section>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<p>The AD7879/AD7889 is a 12-bit successive approximation ADC with a synchronous serial interface and low on-resistance switches for driving 4-wire resistive touch screens. The AD7879 works with a very low power supply, a single 1.6 V to 3.6V, and features throughput rates of 105 kSPS.</p>
<p>The device includes a shutdown mode, which reduces its current consumption to less than 5 uA.</p>
<p>To reduce the effects of noise from LCDs and other sources, the AD7879 contains a preprocessing block. The preprocessing function consists of a median and an averaging filter. The combination of these two techniques provides a more robust solution, discarding the spurious noise in the signal and keeping only the data of interest. The size of both filters is programmable. Other user-programmable conversion controls include variable acquisition time, and first conversion delay. Up to 16 averages can be taken per conversion. The AD7879 can run in either slave or stand-alone mode, using an automatic conversion sequencer and timer.</p>
<a class="reference internal image-reference" href="../../../_images/ad7879_filter_example.png"><img alt="ad7879_filter_example.png" src="../../../_images/ad7879_filter_example.png" style="width: 500px;" />
</a>
<p>The AD7879 has a programmable pin that can operate as either an auxiliary input to the ADC, as a battery monitor, or as a GPIO. There is a programmable interrupt output which can operate in three modes, as a general purpose interrupt to signal when new data is available INT, as an interrupt to indicate when limits are exceeded, or as a pen down interrupt when the screen is touched, PENIRQ. The AD7879 offers temperature and touch-pressure measurement.</p>
<p>It is available in various packages.
It has either an** SPI (AD7879)(AD7889)** or <strong>I2C (AD7879-1)(AD7889-1)</strong> interface.</p>
<p><em><strong>See also:</strong></em> <a class="reference internal" href="#docs%3Euclinux-dist:tslib"><span class="xref myst">uclinux-dist:tslib</span></a></p>
<p><em><strong>See also:</strong></em> <a class="reference internal" href="ad7877.html"><span class="doc std std-doc">AD7877 Touchscreen Device Driver</span></a></p>
</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Link to this heading">¶</a></h2>
<p><strong>AD7879-1/AD7889-1 I2C Device Address options:</strong></p>
<table>
<thead>
<tr class="header">
<th>ADD1</th>
<th>ADD0</th>
<th>I2C Address</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0</td>
<td>0x2C</td>
</tr>
<tr class="even">
<td>0</td>
<td>1</td>
<td>0x2D</td>
</tr>
<tr class="odd">
<td>1</td>
<td>0</td>
<td>0x2E</td>
</tr>
<tr class="even">
<td>1</td>
<td>1</td>
<td>0x2F</td>
</tr>
</tbody>
</table>
</section>
<section id="software-configurable-features">
<h2>Software configurable features<a class="headerlink" href="#software-configurable-features" title="Link to this heading">¶</a></h2>
<p><strong>Software configurable:</strong></p>
<ul class="simple">
<li><p>First Conversion Delay (128us…4.096ms in steps up 128us)</p></li>
<li><p>Acquisition Time (2us, 4us, 8us, 16us)</p></li>
<li><p>Average Filter (2,4,8,16)</p></li>
<li><p>Median Filter (0,4,8,16)</p></li>
<li><p>Pen Down Acquisition Interval Timer (550us…9.44ms in steps of 35us)</p></li>
<li><p>Auxiliary GPIO can be exported to GPIOLIB, and therefore used system-wide</p></li>
</ul>
</section>
<section id="source-code">
<h2>Source Code<a class="headerlink" href="#source-code" title="Link to this heading">¶</a></h2>
<section id="status">
<h3>Status<a class="headerlink" href="#status" title="Link to this heading">¶</a></h3>
<table>
<thead>
<tr class="header">
<th>Source</th>
<th>Mainlined?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="git.linux.org&gt;drivers/input/touchscreen/ad7879.c">git</a></td>
<td><a href="git.linux.org&gt;drivers/input/touchscreen/ad7879.c">Yes</a></td>
</tr>
</tbody>
</table>
</section>
<section id="files">
<h3>Files<a class="headerlink" href="#files" title="Link to this heading">¶</a></h3>
<table>
<thead>
<tr class="header">
<th>Function</th>
<th>File</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>driver</td>
<td><a href="git.linux.org&gt;drivers/input/touchscreen/ad7879.c">drivers/input/touchscreen/ad7879.c</a></td>
</tr>
<tr class="even">
<td>i2c bus support</td>
<td><a href="git.linux.org&gt;drivers/input/touchscreen/ad7879-i2c.c">drivers/input/touchscreen/ad7879-i2c.c</a></td>
</tr>
<tr class="odd">
<td>spi bus support</td>
<td><a href="git.linux.org&gt;drivers/input/touchscreen/ad7879-spi.c">drivers/input/touchscreen/ad7879-spi.c</a></td>
</tr>
<tr class="even">
<td>include</td>
<td><a href="git.linux.org&gt;include/linux/spi/ad7879.h">include/linux/spi/ad7879.h</a></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="example-platform-device-initialization">
<h2>Example platform device initialization<a class="headerlink" href="#example-platform-device-initialization" title="Link to this heading">¶</a></h2>
<!-- CMDS: noheader firstseconly noeditbtn -->
<p>Touchscreen characteristics vary between boards and models. The platform_data for the device’s “struct device” holds this information.</p>
<source trunk/include/linux/spi/ad7879.h c linux-kernel>
<section id="example-platform-board-file-spi-interface-version">
<h3>Example Platform / Board file (SPI Interface Version)<a class="headerlink" href="#example-platform-board-file-spi-interface-version" title="Link to this heading">¶</a></h3>
<!-- CMDS: firstseconly -->
<p>These snippets are all from the same file. <code class="docutils literal notranslate"><span class="pre">arch/blackfin/mach-bf537/boards/stamp.c</span></code>:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="cp">## include &lt;linux/spi/ad7879.h&gt;</span>

<span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">ad7879_platform_data</span><span class="w"> </span><span class="n">bfin_ad7879_ts_info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">.</span><span class="n">model</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="mi">7879</span><span class="p">,</span><span class="w"> </span><span class="cm">/* Model = AD7879 */</span>
<span class="w">    </span><span class="p">.</span><span class="n">x_plate_ohms</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mi">620</span><span class="p">,</span><span class="w">  </span><span class="cm">/* 620 Ohm from the touch datasheet */</span>
<span class="w">    </span><span class="p">.</span><span class="n">pressure_max</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mi">10000</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">pressure_min</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">first_conversion_delay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">    </span><span class="cm">/* wait 512us before do a first conversion */</span>
<span class="w">    </span><span class="p">.</span><span class="n">acquisition_time</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">    </span><span class="cm">/* 4us acquisition time per sample */</span>
<span class="w">    </span><span class="p">.</span><span class="n">median</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">    </span><span class="cm">/* do 8 measurements */</span>
<span class="w">    </span><span class="p">.</span><span class="n">averaging</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">    </span><span class="cm">/* take the average of 4 middle samples */</span>
<span class="w">    </span><span class="p">.</span><span class="n">pen_down_acc_interval</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">255</span><span class="p">,</span><span class="w">  </span><span class="cm">/* 9.4 ms */</span>
<span class="w">    </span><span class="p">.</span><span class="n">gpio_export</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">    </span><span class="cm">/* Export GPIO to gpiolib */</span>
<span class="w">    </span><span class="p">.</span><span class="n">gpio_base</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w">   </span><span class="cm">/* Dynamic allocation */</span>
<span class="p">};</span>
</pre></div>
</div>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">spi_board_info</span><span class="w"> </span><span class="n">bfin_spi_board_info</span><span class="p">[]</span><span class="w"> </span><span class="n">__initdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="cp">## if defined(CONFIG_TOUCHSCREEN_AD7879_SPI) || defined(CONFIG_TOUCHSCREEN_AD7879_SPI_MODULE)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="p">.</span><span class="n">modalias</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ad7879&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">platform_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">bfin_ad7879_ts_info</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">irq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IRQ_PF7</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">max_speed_hz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5000000</span><span class="p">,</span><span class="w">     </span><span class="cm">/* max spi clock (SCK) speed in HZ */</span>
<span class="w">        </span><span class="p">.</span><span class="n">bus_num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">chip_select</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">controller_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">spi_ad7879_chip_info</span><span class="p">,</span><span class="w"> </span><span class="cm">/* only needed on Blackfin */</span>
<span class="w">        </span><span class="p">.</span><span class="n">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SPI_CPHA</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">SPI_CPOL</span><span class="p">,</span>
<span class="w">    </span><span class="p">},</span>
<span class="cp">## endif</span>
<span class="p">};</span>
</pre></div>
</div>
</section>
<section id="example-platform-board-file-i2c-interface-version">
<h3>Example Platform / Board file (I2C Interface Version)<a class="headerlink" href="#example-platform-board-file-i2c-interface-version" title="Link to this heading">¶</a></h3>
<!-- CMDS: firstseconly noeditbtn -->
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="cp">## include &lt;linux/spi/ad7879.h&gt;</span>

<span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">ad7879_platform_data</span><span class="w"> </span><span class="n">bfin_ad7879_ts_info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">.</span><span class="n">model</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="mi">7879</span><span class="p">,</span><span class="w"> </span><span class="cm">/* Model = AD7879 */</span>
<span class="w">    </span><span class="p">.</span><span class="n">x_plate_ohms</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mi">620</span><span class="p">,</span><span class="w">  </span><span class="cm">/* 620 Ohm from the touch datasheet */</span>
<span class="w">    </span><span class="p">.</span><span class="n">pressure_max</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mi">10000</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">pressure_min</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">first_conversion_delay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">    </span><span class="cm">/* wait 512us before do a first conversion */</span>
<span class="w">    </span><span class="p">.</span><span class="n">acquisition_time</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">    </span><span class="cm">/* 4us acquisition time per sample */</span>
<span class="w">    </span><span class="p">.</span><span class="n">median</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">    </span><span class="cm">/* do 8 measurements */</span>
<span class="w">    </span><span class="p">.</span><span class="n">averaging</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">    </span><span class="cm">/* take the average of 4 middle samples */</span>
<span class="w">    </span><span class="p">.</span><span class="n">pen_down_acc_interval</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">255</span><span class="p">,</span><span class="w">  </span><span class="cm">/* 9.4 ms */</span>
<span class="w">    </span><span class="p">.</span><span class="n">gpio_export</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">    </span><span class="cm">/* Export GPIO to gpiolib */</span>
<span class="w">    </span><span class="p">.</span><span class="n">gpio_base</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w">   </span><span class="cm">/* Dynamic allocation */</span>
<span class="p">};</span>
</pre></div>
</div>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">i2c_board_info</span><span class="w"> </span><span class="n">__initdata</span><span class="w"> </span><span class="n">bfin_i2c_board_info</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="cp">## if defined(CONFIG_TOUCHSCREEN_AD7879_I2C) || defined(CONFIG_TOUCHSCREEN_AD7879_I2C_MODULE)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">I2C_BOARD_INFO</span><span class="p">(</span><span class="s">&quot;ad7879&quot;</span><span class="p">,</span><span class="w"> </span><span class="mh">0x2F</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">irq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IRQ_PG5</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">platform_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">bfin_ad7879_ts_info</span><span class="p">,</span>
<span class="w">    </span><span class="p">},</span>
<span class="cp">## endif</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="adding-linux-driver-support">
<h2>Adding Linux driver support<a class="headerlink" href="#adding-linux-driver-support" title="Link to this heading">¶</a></h2>
<p>Configure kernel with “make menuconfig” (alternatively use “make xconfig” or
“make qconfig”)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<!-- ATTRS: round="" help="" -->
<p>The AD7879 Driver depends on <strong>CONFIG_SPI</strong> or <strong>CONFIG_I2C</strong></p>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Input device support
  -*- Generic input layer (needed for keyboard, mouse, ...)
  &lt; &gt;   Support for memoryless force-feedback devices
  &lt; &gt;   Polled input device skeleton
  &lt; &gt;   Sparse keymap support library
        *** Userland interfaces ***
  &lt; &gt;   Mouse interface
  &lt; &gt;   Joystick interface
  &lt;*&gt;   Event interface
  &lt; &gt;   Event debugging
        *** Input Device Drivers ***
  [ ]   Keyboards  ---&gt;
  [ ]   Mice  ---&gt;
  [ ]   Joysticks/Gamepads  ---&gt;
  [ ]   Tablets  ---&gt;
  [*]   Touchscreens  ---&gt;

     --- Touchscreens
     &lt; &gt;   ADS7846/TSC2046/AD7873 and AD(S)7843 based touchscreens (NEW)
     &lt; &gt;   AD7877 based touchscreens
     &lt;*&gt;   Analog Devices AD7879-1/AD7889-1 touchscreen interface (NEW)
        &lt;*&gt;     support I2C bus connection
        &lt; &gt;     support SPI bus connection (NEW)

  [ ]   Miscellaneous devices  ---&gt;
      Hardware I/O ports  ---&gt;
</pre></div>
</div>
</section>
<section id="hardware-configuration">
<h2>Hardware configuration<a class="headerlink" href="#hardware-configuration" title="Link to this heading">¶</a></h2>
<a class="reference internal image-reference" href="../../../_images/ad7879_example_schematic.png"><img alt="ad7879_example_schematic.png" src="../../../_images/ad7879_example_schematic.png" style="width: 800px;" />
</a>
</section>
<section id="driver-testing">
<h2>Driver testing<a class="headerlink" href="#driver-testing" title="Link to this heading">¶</a></h2>
<section id="driver-compiled-as-a-module">
<h3>Driver compiled as a module<a class="headerlink" href="#driver-compiled-as-a-module" title="Link to this heading">¶</a></h3>
</section>
<section id="driver-compiled-into-the-kernel">
<h3>Driver compiled into the kernel<a class="headerlink" href="#driver-compiled-into-the-kernel" title="Link to this heading">¶</a></h3>
<p>Your kernel startup messages should include something like this</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>input: AD7879 Touchscreen as /class/input/input0
ad7879 spi0.1: touchscreen, irq 57
</pre></div>
</div>
</section>
<section id="common-problems">
<h3>Common Problems<a class="headerlink" href="#common-problems" title="Link to this heading">¶</a></h3>
<p>In case you see a message like this</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>spi0.1: Failed to probe AD7879 Touchscreen
</pre></div>
</div>
<p>This means that the SPI communication and initialization with the AD7879 touchscreen controller/digitizer failed. <strong>check bus_num and chip_select in your platform device file</strong></p>
</section>
<section id="checking-for-proper-installation">
<h3>Checking for proper installation<a class="headerlink" href="#checking-for-proper-installation" title="Link to this heading">¶</a></h3>
<p>After the kernel boot your device folder should include at least one device node for the touchscreen</p>
<p>Check that the interrupt is registered.</p>
</section>
<section id="use-the-event-test-utility-to-test-proper-function">
<h3>Use the event_test utility to test proper function<a class="headerlink" href="#use-the-event-test-utility-to-test-proper-function" title="Link to this heading">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>root:/&gt; event_test /dev/input/event0
Input driver version is 1.0.0
Input device ID: bus 0x0 vendor 0x0 product 0x0 version 0x0
Input device name: &quot;AD7879 Touchscreen&quot;
Supported events:
  Event type 0 (Sync)
  Event type 1 (Key)
    Event code 330 (Touch)
  Event type 3 (Absolute)
    Event code 0 (X)
      Value   1268
      Min        0
      Max     4095
    Event code 1 (Y)
      Value   1250
      Min        0
      Max     4095
    Event code 24 (Pressure)
      Value      0
      Min        0
      Max    10000
Testing ... (interrupt to exit)
Event: time 67435.364000, type 1 (Key), code 330 (Touch), value 1
Event: time 67435.364000, type 3 (Absolute), code 0 (X), value 1624
Event: time 67435.364000, type 3 (Absolute), code 1 (Y), value 1514
Event: time 67435.364000, type 3 (Absolute), code 24 (Pressure), value 349
Event: time 67435.364000, -------------- Report Sync ------------
Event: time 67435.408000, type 3 (Absolute), code 0 (X), value 1626
Event: time 67435.408000, type 3 (Absolute), code 1 (Y), value 1516
Event: time 67435.408000, type 3 (Absolute), code 24 (Pressure), value 342
Event: time 67435.408000, -------------- Report Sync ------------
Event: time 67435.452000, type 3 (Absolute), code 1 (Y), value 1514
Event: time 67435.452000, type 3 (Absolute), code 24 (Pressure), value 339
Event: time 67435.452000, -------------- Report Sync ------------
Event: time 67435.496000, type 3 (Absolute), code 0 (X), value 1625
Event: time 67435.496000, type 3 (Absolute), code 24 (Pressure), value 343
Event: time 67435.496000, -------------- Report Sync ------------
Event: time 67435.596000, type 3 (Absolute), code 24 (Pressure), value 0
Event: time 67435.596000, type 1 (Key), code 330 (Touch), value 0
Event: time 67435.596000, -------------- Report Sync ------------
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<!-- ATTRS: tip="" -->
<p>In case you touch the surface and don’t receive events, it’s likely that something with your /DAV Interrupt is wrong.
<strong>check irq number in your platform device file</strong></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<!-- ATTRS: tip="" -->
<p>In case you get a message like: <code class="docutils literal notranslate"><span class="pre">evtest:</span> <span class="pre">No</span> <span class="pre">such</span> <span class="pre">device</span></code>, it’s likely that you have not install the necessary modules</p>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>root:/&gt; cat /proc/interrupts
  6:       7898   Blackfin Core Timer
 10:          1   rtc-bfin
 18:          0   BFIN_UART_RX
 19:        105   BFIN_UART_TX
 24:         77   EMAC_RX
 42:          0   PPI ERROR
 57:        168   ad7879
Err:          0
root:/&gt;
</pre></div>
</div>
</section>
<section id="find-input-by-name">
<h3>Find Input by name<a class="headerlink" href="#find-input-by-name" title="Link to this heading">¶</a></h3>
<p>In case you like to find out which input/event interface is connected to your touchscreen, use the sysfs entries</p>
<p>```{code-block} bashroot:/sys/class/input&gt; <strong>for i in <code class="docutils literal notranslate"><span class="pre">find</span> <span class="pre">/sys/class/input/</span> <span class="pre">-name</span> <span class="pre">name</span></code> ; do echo -n “<span class="math notranslate nohighlight">\(i : &quot;; cat \)</span>i; done</strong>
./input2/name : Logitech USB Receive
./input1/name : Logitech USB Receiver
./input0/name : AD7879 Touchscreen</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
#### Under the device folder there are auxiliary functions such as GPIO and disable controls

    root:/&gt; cd sys/class/input/input0/device/
    root:/sys/devices/platform/bfin-spi.0/spi0.1&gt; ls -al
    drwxr-xr-x    3 root     root            0 Jan  3 13:02 .
    drwxr-xr-x    5 root     root            0 Jan  3 13:02 ..
    lrwxrwxrwx    1 root     root            0 Jan  3 13:04 bus -&gt; ../../../../bus/spi
    -rw-rw-r--    1 root     root         4096 Jan  3 13:04 disable
    lrwxrwxrwx    1 root     root            0 Jan  3 13:04 driver -&gt; ../../../../bus/spi/drivers/ad7879
    -rw-rw-r--    1 root     root         4096 Jan  3 13:04 gpio
    lrwxrwxrwx    1 root     root            0 Jan  3 13:04 input:input0 -&gt; ../../../../class/input/input0
    -r--r--r--    1 root     root         4096 Jan  3 13:04 modalias
    drwxr-xr-x    2 root     root            0 Jan  3 13:04 power
    lrwxrwxrwx    1 root     root            0 Jan  3 13:04 subsystem -&gt; ../../../../bus/spi
    -rw-r--r--    1 root     root         4096 Jan  3 13:04 uevent
    root:/sys/devices/platform/bfin-spi.0/spi0.1&gt; cat gpio
    0
    root:/sys/devices/platform/bfin-spi.0/spi0.1&gt; echo 1 &gt; gpio
    root:/sys/devices/platform/bfin-spi.0/spi0.1&gt; cat gpio
    1
    root:/sys/devices/platform/bfin-spi.0/spi0.1&gt;

### More Information

&lt;!-- CMDS: noheader firstseconly noeditbtn --&gt;
```{include} resources_tools-software_linux-drivers_snippets_SUB_input_pointers.md
</pre></div>
</div>
</section>
<section id="touchscreen-calibration">
<h3>Touchscreen calibration<a class="headerlink" href="#touchscreen-calibration" title="Link to this heading">¶</a></h3>
<p>See the <a class="reference internal" href="#docs%3Euclinux-dist:tslib"><span class="xref myst">uclinux-dist:tslib</span></a> page for more information.</p>
</section>
<section id="using-the-ad7879-in-microwin-nano-x">
<h3>Using the AD7879 in Microwin / Nano-X<a class="headerlink" href="#using-the-ad7879-in-microwin-nano-x" title="Link to this heading">¶</a></h3>
<section id="user-configuration">
<h4>User Configuration<a class="headerlink" href="#user-configuration" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>Enable Microwin during Customize Application/Library Settings</p></li>
<li><p>Manually edit user/microwin/src/config</p></li>
</ul>
<p><em>Enable:</em>
<strong>AD7877MOUSE = Y</strong></p>
<p><em>Disable:</em>
<strong>NOMOUSE = N</strong></p>
</section>
<section id="testing-and-calibration">
<h4>Testing and Calibration<a class="headerlink" href="#testing-and-calibration" title="Link to this heading">¶</a></h4>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>root:/&gt; nano-X &amp;
210
root:/&gt; nanowm &amp;
211
root:/&gt; nxcal &lt;-- TS Calibration Utility
root:/&gt; nxeyes
</pre></div>
</div>
</section>
<section id="nanox-with-tslib">
<h4>Nanox with tslib<a class="headerlink" href="#nanox-with-tslib" title="Link to this heading">¶</a></h4>
<p>For kernel after 2.6.22, “/dev/input/ts*” interface has been deprecated in linux. Nanox need to use tslib for touchscreen. To enable:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>####################################################################
# Mouse drivers
# GPMMOUSE      gpm mouse
# SERMOUSE      serial Microsoft, PC, Logitech, PS/2 mice (/dev/psaux)
# SUNMOUSE      Sun Workstation mouse (/dev/sunmouse)
# NOMOUSE       no mouse driver
#
# Touchscreen drivers
# IPAQMOUSE     Compaq iPAQ, Intel Assabet (/dev/h3600_tsraw)
# ZAURUSMOUSE   Sharp Zaurus (/dev/sharp_ts)
# TUXMOUSE      TuxScreen (/dev/ucb1x00-ts)
# ADSMOUSE      Applied Data Systems GC+ (/dev/ts)
# ADS7846MOUSE          ADS7846 chip, PSI OMAP Innovator (/dev/innnovator_ts)
# EPMOUSE       Embedded Planet (/dev/tpanel)
# VHMOUSE       Vtech Helio (/dev/tpanel)
# MTMOUSE       MicroTouch serial (/dev/ttyS1)
# PSIONMOUSE    Psion 5 (/dev/touch_psion)
# YOPYMOUSE     Yopy (/dev/yopy-ts)
# HARRIERMOUSE  NEC Harrier (/dev/tpanel)
# AD7877MOUSE   Analog Devices AD7877/9 Touch Screen Digitizer (/dev/ts0)
# TSLIBMOUSE    Common touchscreen driver using tslib
####################################################################
GPMMOUSE                 = N
SERMOUSE                 = N
SUNMOUSE                 = N
IPAQMOUSE                = N
ZAURUSMOUSE              = N
TUXMOUSE                 = N
ADSMOUSE                 = N
ADS7846MOUSE             = N
EPMOUSE                  = N
VHMOUSE                  = N
MTMOUSE                  = N
PSIONMOUSE               = N
YOPYMOUSE                = N
HARRIERMOUSE             = N
LIRCMOUSE                = N
AD7879MOUSE              = N
TSLIBMOUSE               = Y
NOMOUSE                  = N
</pre></div>
</div>
<p>Before start nano-x, need to set up <a class="reference internal" href="#docs%3Euclinux-dist:tslib"><span class="xref myst">uclinux-dist:tslib</span></a> first (including running ts_calibrate):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>root:/&gt; . /etc/tslib.env
root:/&gt; ts_calibrate
root:/&gt; nano-X &amp;
root:/&gt; nanowm &amp;
</pre></div>
</div>
</section>
</section>
<section id="example-links-graphical-browser">
<h3>Example Links Graphical Browser<a class="headerlink" href="#example-links-graphical-browser" title="Link to this heading">¶</a></h3>
<p><a class="reference internal" href="#docs%3Euclinux-dist:browsers"><span class="xref myst">uclinux-dist:browsers</span></a></p>
<section id="enable-links">
<h4>Enable Links<a class="headerlink" href="#enable-links" title="Link to this heading">¶</a></h4>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Network Applications
    [*] links (web browswer)
</pre></div>
</div>
</section>
<section id="start-links">
<h4>Start Links<a class="headerlink" href="#start-links" title="Link to this heading">¶</a></h4>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>root:/&gt; links -g http://uclinux.org

   ~~~~~~~~~~~~~~~~~~~~~~~~~~| DirectFB 1.2.3 |~~~~~~~~~~~~~~~~~~~~~~~~~~
        (c) 2001-2008  The world wide DirectFB Open Source Community
        (c) 2000-2004  Convergence (integrated media) GmbH
      ----------------------------------------------------------------

(*) DirectFB/Core: Single Application Core. (2008-10-08 07:38)
(*) Direct/Thread: Started &#39;VT Switcher&#39; (235) [CRITICAL OTHER/OTHER 0/0] &lt;12288&gt;...
(*) Direct/Thread: Started &#39;Keyboard Input&#39; (236) [INPUT OTHER/OTHER 0/0] &lt;12288&gt;...
(*) DirectFB/Input: Keyboard 0.9 (directfb.org)
(*) Direct/Thread: Started &#39;tslib Input&#39; (237) [INPUT OTHER/OTHER 0/0] &lt;12288&gt;...
(*) DirectFB/Input: tslib touchscreen 0 0.1 (tslib)
(*) DirectFB/Graphics: Generic Software Rasterizer 0.6 (directfb.org)
(*) DirectFB/Core/WM: Default 0.3 (directfb.org)
(*) FBDev/Surface: Allocated 320x240 16 bit RGB16 buffer (index 0) at offset 0 and pitch 640.
(!) DirectFB/FBDev: Panning display failed (x=0 y=0 ywrap=0 vbl=1)!
    --&gt; Invalid argument
</pre></div>
</div>
</section>
</section>
<section id="driver-source">
<h3>Driver Source<a class="headerlink" href="#driver-source" title="Link to this heading">¶</a></h3>
<p>Most people should not care about the driver source - it just works as a normal Linux input device. If you are interested, you can look at the driver source at :</p>
<source trunk/drivers/input/touchscreen/ad7879.c:ad7879_report() c linux-kernel>
</section>
</section>
</section>


          </div>
              <div class="related">
                &nbsp;
    <a href="ad7877.html" title="Previous document" class="prev">AD7877 Input Touch Screen Controller Linux Driver</a>
    <a href="../leds/adp1650.html" title="Next document" class="next">ADP1650 LED Flash Linux Driver</a>
              </div>
          
        </div>
      </div>
  </div>

  <div id="vertical-border"></div>

  <label id="cancel-area-show-toc" for="input-show-toc"></label>
  <label id="cancel-area-show-localtoc" for="input-show-localtoc"></label>

  
  <form action="" method="get" class="search-area">
    <input type="text" name="q" aria-labelledby="search-documentation" value="" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="search" placeholder="Search"/>
    <button value="search"></button>
    <span id="search-progress"></span>
  </form>
  
    <footer>
      &#169;2024, Analog Devices, Inc.
      
      |
      Made with <a href="https://www.sphinx-doc.org/">Sphinx</a>
      &amp; <a href="https://github.com/analogdevicesinc/doctools">Doctools</a>
      
    </footer>
  </body>
</html>