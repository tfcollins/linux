<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>AD4003/AD4007/AD4011/AD4020/ADAQ4001/ADAQ4003 Linux Driver &#8212; Linux Kernel: Variant from Analog Devices, Inc. v6.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=8e8a900e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/style.min.css?v=cf8483f0" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    <script src="../../../_static/documentation_options.js?v=cb43cce9"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/tabs.js?v=3ee01567"></script>
    <script defer="" src="../../../_static/app.umd.js?v=96350458"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="AD4630 ADC Linux Driver" href="ad4630.html" />
    <link rel="prev" title="HMC425A Digital Step Attenuator Linux Driver" href="../iio-amplifiers/hmc425a.html" />
   
  
    <meta name="robots" content="noindex">
  
  


<style>
  body {
    
  }

  body.dark {
    
  }

  @media (prefers-color-scheme: dark) {
    body:not(.light) {
      
    }
  }
</style>
  </head><body>
  <input type="checkbox" id="input-show-toc">
  <input type="checkbox" id="input-show-localtoc">
  <header>
    <div class="header">
      <div id="left">
        <label id="show-sidebar" for="input-show-toc" title="Show/hide index"></label>
      </div>
      <div id="right">
        <span>
          <a id="logo-org" href="https://analog.com"></a>
              <a id="no-logo" href="../../../index.html">
                Linux Kernel: Variant from Analog Devices, Inc.
              </a>
        </span>
        <span class="reverse">
          <label id="show-localtoc" for="input-show-localtoc" title="Show/hide contents"></label>
        </span>
      </div>
    </div>
    <div class="repotoc-tree">
      <root>
  <a href="../../../../documentation/eval/index.html">Evaluation Boards</a>
  <a href="../../../../documentation/university/index.html">University Program</a>
  <a href="../../../../hdl/index.html">HDL</a>
  <a href="../../../../no-OS/index.html">no-OS</a>
  <a href="../../../../pyadi-iio/index.html">pyadi-iio</a>
  <a href="../../../../precision-converters-firmware/index.html">Precision Converters Firmware</a>
  <a href="../../../../PrecisionToolbox/index.html">Precision Toolbox</a>
</root>

    </div>
  </header>

    <div class="localtoc">
      <div class="tocwrapper">
        <div>
          <div class="localtoc-header">On this page</div>
          <a id="scroll-up" href="#top-anchor" title="Back to top"></a>
        </div>
        <nav>
          <ul>
<li><a class="reference internal" href="#">AD4003/AD4007/AD4011/AD4020/ADAQ4001/ADAQ4003 Linux Driver</a><ul>
<li><a class="reference internal" href="#supported-devices">Supported Devices</a></li>
<li><a class="reference internal" href="#evaluation-boards">Evaluation Boards</a></li>
<li><a class="reference internal" href="#description">Description</a></li>
<li><a class="reference internal" href="#status">Status</a></li>
<li><a class="reference internal" href="#files">Files</a></li>
<li><a class="reference internal" href="#driver-setup">Driver setup</a></li>
<li><a class="reference internal" href="#adding-linux-driver-support">Adding Linux driver support</a><ul>
<li><a class="reference internal" href="#enabling-the-driver">Enabling the driver</a></li>
</ul>
</li>
<li><a class="reference internal" href="#driver-testing">Driver testing</a><ul>
<li><a class="reference internal" href="#show-device-name">Show device name</a></li>
<li><a class="reference internal" href="#show-channel-scale">Show channel scale</a></li>
<li><a class="reference internal" href="#configure-sampling-rate">Configure sampling rate</a></li>
<li><a class="reference internal" href="#buffer-management">Buffer management</a></li>
<li><a class="reference internal" href="#buffer-example">Buffer Example</a><ul>
<li><a class="reference internal" href="#data-interpretation">Data interpretation</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#more-information">More Information</a></li>
</ul>
</li>
</ul>

        </nav>
      </div>
    </div>

  
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
              <a id="no-logo" href="../../../index.html">
                Linux Kernel: Variant from Analog Devices, Inc.
              </a><input id="input-switch-toc" type="checkbox">
<label id="show-repotoc" for="input-switch-toc">
All content
</label>
<label id="show-toc" for="input-switch-toc">
Content on this topic
</label>
<div class="repotoc-tree">
  <root>
  <a href="../../../../documentation/eval/index.html">Evaluation Boards</a>
  <a href="../../../../documentation/university/index.html">University Program</a>
  <a href="../../../../hdl/index.html">HDL</a>
  <a href="../../../../no-OS/index.html">no-OS</a>
  <a href="../../../../pyadi-iio/index.html">pyadi-iio</a>
  <a href="../../../../precision-converters-firmware/index.html">Precision Converters Firmware</a>
  <a href="../../../../PrecisionToolbox/index.html">Precision Toolbox</a>
</root>

</div>
<div class="toc-tree">
  <html>
  <body><ul class="current">
<li class="toctree-l1 current"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-1" id="toctree-collapse-1" checked=""/><div class="collapse"><a class="reference internal" href="../../../drivers_index.html">Linux Drivers</a><label for="toctree-collapse-1"><div class="icon"></div></label></div><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../multifunction-device/adp5520.html">ADP5501</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backlight/adp8860.html">ADP8860</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backlight/adp8870.html">ADP8870</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clk/adi/clk-ad9545.c.html">AD9545</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-keyboard/adp5588.html">ADP5587</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-keyboard/adp5589.html">ADP5585</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hwmon/axi_fan_control.html">Fan Control IP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hwmon/ltc2947.html">LTC2947</a></li>
<li class="toctree-l2"><a class="reference internal" href="../net-phy/adin1100.html">ADIN1100</a></li>
<li class="toctree-l2"><a class="reference internal" href="../net-phy/adin.html">ADIN1200</a></li>
<li class="toctree-l2"><a class="reference internal" href="../net-mac-phy/adin1110.html">ADIN1110</a></li>
<li class="toctree-l2"><a class="reference internal" href="../net-mac-phy/adin2111.html">ADIN2111</a></li>
<li class="toctree-l2"><a class="reference internal" href="../net-mac-phy/open_alliance.html">Open Alliance - 10BASE-T1x MAC-PHY Serial Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adxl313.html">ADXL312,</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-misc/adxl345.html">ADXL345</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adxl355.html">ADXL355</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-misc/adxl362.html">ADXL362</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adxl367.html">ADXL367</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adxl372.html">ADXL372</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adis16201.html">ADIS16201</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adis16203.html">ADIS16203</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adis16209.html">ADIS16209</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adis16240.html">ADIS16240</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-amplifiers/ad8366.html">AD8366</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-amplifiers/ada4250.html">ADA4250</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-amplifiers/hmc425a.html">HMC425</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">AD4003</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad4630.html">AD4030-24</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad9208.html">AD6684</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7476a.html">AD7091</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7091r5.html">AD7091R-5</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7091r8.html">AD7091R-8</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7124.html">AD7124</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7780.html">AD7170</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7192.html">AD7190</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7266.html">AD7265</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7280a.html">AD7280A</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7291.html">AD7291</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7298.html">AD7298</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad738x.html">AD7380</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7606.html">AD7605-4</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7766.html">AD7766-1</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7768-1.html">AD7768-1</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7768.html">AD7768</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7793.html">AD7785</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7791.html">AD7787</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7887.html">AD7887</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7998.html">AD7991</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad9083.html">AD9083</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-mxfe/ad9081.html">AD9207</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../resources/tools-software/linux-drivers/iio-adc/ad9208.html">AD9208</a></li>
<li class="toctree-l2"><a class="reference internal" href="axi-adc-hdl.html">AD9234</a></li>
<li class="toctree-l2"><a class="reference internal" href="adaq8092.html">ADAQ8092</a></li>
<li class="toctree-l2"><a class="reference internal" href="adas1000.html">ADAS1000</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-transceiver/adar1000.html">ADAR1000</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-cdc/ad7152.html">AD7152</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-cdc/ad7150.html">AD7150</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-cdc/ad7745.html">AD7745</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-addac/ad74413r.html">AD74412R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/axi-ad3552r.html">AD3552R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5064.html">AD5024</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5446.html">AD5300</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5676.html">AD5310R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5360.html">AD5360</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5380.html">AD5380</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5449.html">AD5415</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5421.html">AD5421</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5504.html">AD5501</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5592r.html">AD5592R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5593r.html">AD5593R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5624r.html">AD5624</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5755.html">AD5735</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5764.html">AD5744</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5758.html">AD5758</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5791.html">AD5760</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5770r.html">AD5770R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dds/axi-dac-dds-hdl.html">AD9122</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ltc2664.html">LTC2664</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dds/ad9832.html">AD9832</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dds/ad9834.html">AD9833</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-filter/admv8818.html">ADMV8818</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ad9162.html">AD9161</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ad9508.html">AD9508</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ad9517.html">AD9516-0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ad9523.html">AD9523-1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ad9528.html">AD9528</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf4159.html">ADF4159</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf4350.html">ADF4350</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf4360.html">ADF4360-0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf4371.html">ADF4371</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf4377.html">ADF4377</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf5355.html">ADF4355</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/admv1013.html">ADMV1013</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/admv1014.html">ADMV1014</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adrf6780.html">ADRF6780</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/hmc7044.html">HMC7044</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ltc6952.html">LTC6952</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adis16060.html">ADIS16060</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adis16080.html">ADIS16080</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adis16130.html">ADIS16130</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adis16136.html">ADIS16133</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adis16260.html">ADIS16251</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adxrs450.html">ADXRS450</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-impedance-analyzer/ad5933.html">AD5933</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-inertial-measurement-units/adis16400.html">ADIS16300</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-inertial-measurement-units/adis16480.html">ADIS16375</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-inertial-measurement-units/adis16475.html">ADIS16460</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-resolver/ad2s90.html">AD2S90</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-resolver/ad2s1200.html">AD2S1200</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-resolver/ad2s1210.html">AD2S1210</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad6676.html">AD6676</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-transceiver/ad9361.html">AD9361</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-transceiver/ad9371.html">AD9371</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-transceiver/adrv9002.html">ADRV9002</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-transceiver/adrv9009.html">ADRV9008-1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-temperature/ltc2983.html">LTC2983</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-vector-power/adl5960.html">ADL5960</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-misc/ad714x.html">AD7142</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-touchscreen/ad7873.html">AD7873</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-touchscreen/ad7877.html">AD7877</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-touchscreen/ad7879.html">AD7879</a></li>
<li class="toctree-l2"><a class="reference internal" href="../leds/adp1650.html">ADP1650</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc/dpot.html">AD5160</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mux/adgs1408.html">ADGS1408</a></li>
<li class="toctree-l2"><a class="reference internal" href="../networking-mac802154/adf7242.html">ADF7241</a></li>
<li class="toctree-l2"><a class="reference internal" href="../regulator/adp150.html">ADP122</a></li>
<li class="toctree-l2"><a class="reference internal" href="../regulator/ad5398.html">AD5398</a></li>
<li class="toctree-l2"><a class="reference internal" href="../serial/max310x.html">MAX3107</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/ad1835a.html">AD1835A</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/ad1936.html">AD1933</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/ad73322.html">AD73311</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/adau1361.html">ADAU1361</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/adau1372.html">ADAU1372</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/adau1373.html">ADAU1373</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/adau1381.html">ADAU1381</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/adau1701.html">ADAU1401A</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/adau1977.html">ADAU1977</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/adau7002.html">ADAU7002</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/adau7118.html">ADAU7118</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/adav801.html">ADAV801</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/ssm2602.html">SSM2602</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/ssm4567.html">SSM4567</a></li>
<li class="toctree-l2"><a class="reference internal" href="../drm/adv7511.html">ADV7511</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../guides/build.html">Building Kernels</a></li>
</ul>
</body>
</html>

</div>
        </div>
      </div>

  <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper" id="top-anchor">
          <div class="body" role="main">
            
  <section class="tex2jax_ignore mathjax_ignore" id="ad4003-ad4007-ad4011-ad4020-adaq4001-adaq4003-linux-driver">
<h1>AD4003/AD4007/AD4011/AD4020/ADAQ4001/ADAQ4003 Linux Driver<a class="headerlink" href="#ad4003-ad4007-ad4011-ad4020-adaq4001-adaq4003-linux-driver" title="Link to this heading">¶</a></h1>
<section id="supported-devices">
<h2>Supported Devices<a class="headerlink" href="#supported-devices" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#adi%3EAD4000"><span class="xref myst">AD4000</span></a></p></li>
<li><p><a class="reference internal" href="#adi%3EAD4001"><span class="xref myst">AD4001</span></a></p></li>
<li><p><a class="reference internal" href="#adi%3EAD4002"><span class="xref myst">AD4002</span></a></p></li>
<li><p><a class="reference internal" href="#adi%3EAD4003"><span class="xref myst">AD4003</span></a></p></li>
<li><p><a class="reference internal" href="#adi%3EAD4004"><span class="xref myst">AD4004</span></a></p></li>
<li><p><a class="reference internal" href="#adi%3EAD4005"><span class="xref myst">AD4005</span></a></p></li>
<li><p><a class="reference internal" href="#adi%3EAD4006"><span class="xref myst">AD4006</span></a></p></li>
<li><p><a class="reference internal" href="#adi%3EAD4007"><span class="xref myst">AD4007</span></a></p></li>
<li><p><a class="reference internal" href="#adi%3EAD4008"><span class="xref myst">AD4008</span></a></p></li>
<li><p><a class="reference internal" href="#adi%3EAD4010"><span class="xref myst">AD4010</span></a></p></li>
<li><p><a class="reference internal" href="#adi%3EAD4011"><span class="xref myst">AD4011</span></a></p></li>
<li><p><a class="reference internal" href="#adi%3EAD4020"><span class="xref myst">AD4020</span></a></p></li>
<li><p><a class="reference internal" href="#adi%3EAD4021"><span class="xref myst">AD4021</span></a></p></li>
<li><p><a class="reference internal" href="#adi%3EAD4022"><span class="xref myst">AD4022</span></a></p></li>
<li><p><a class="reference internal" href="#adi%3EADAQ4003"><span class="xref myst">ADAQ4003</span></a></p></li>
</ul>
</section>
<section id="evaluation-boards">
<h2>Evaluation Boards<a class="headerlink" href="#evaluation-boards" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#adi%3EEVAL-AD400x-FMCZ"><span class="xref myst">EVAL-AD400x-FMCZ</span></a></p></li>
<li><p><a class="reference internal" href="#adi%3EEVAL-ADAQ40xx"><span class="xref myst">EVAL-ADAQ40xx</span></a></p></li>
</ul>
</section>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<p>Analog Devices <a class="reference internal" href="#adi%3EAD4000"><span class="xref myst">AD4000</span></a> and the above listed devices are high accuracy, high speed, low power SAR ADCs.</p>
<p>This is the Linux industrial I/O (<a class="reference internal" href="#/software/linux/docs/iio/iio"><span class="xref myst">IIO</span></a>) subsystem driver, targeting single channel SPI interface <a class="reference internal" href="#adi%3EAD4000"><span class="xref myst">AD4000</span></a> and similar ADC devices. The industrial I/O subsystem provides a unified framework for drivers for many different types of converters and sensors using a number of different physical interfaces (I2C, SPI, etc). See <a class="reference internal" href="#/software/linux/docs/iio/iio"><span class="xref myst">IIO</span></a> for more information.</p>
<p>See the <a class="reference internal" href="#/resources/eval/ad400x-eval-board"><span class="xref myst">Evaluating AD400X and ADAQ400X devices</span></a> user guide for instructions on how to setup and evaluate devices supported by the ad400x Linux driver.</p>
</section>
<section id="status">
<h2>Status<a class="headerlink" href="#status" title="Link to this heading">¶</a></h2>
<table>
<thead>
<tr class="header">
<th>Source</th>
<th>Mainlined?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="linux.github&gt;main/drivers/iio/adc/ad400x.c">git</a></td>
<td>[No]</td>
</tr>
</tbody>
</table>
</section>
<section id="files">
<h2>Files<a class="headerlink" href="#files" title="Link to this heading">¶</a></h2>
<table>
<thead>
<tr class="header">
<th>Function</th>
<th>File</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>driver</td>
<td><a href="linux.github&gt;main?drivers/iio/adc/ad400x.c">drivers/iio/adc/ad400x.c</a></td>
</tr>
<tr class="even">
<td>devicetree bindings</td>
<td><a href="linux.github&gt;main?Documentation/devicetree/bindings/iio/adc/adi,ad400x.yaml">Documentation/devicetree/bindings/iio/adc/adi,ad400x.yaml</a></td>
</tr>
<tr class="odd">
<td>ZedBoard example devicetree</td>
<td><a href="linux.github&gt;main?arch/arm/boot/dts/zynq-zed-adv7511-ad4020.dts">arch/arm/boot/dts/zynq-zed-adv7511-ad4020.dts</a></td>
</tr>
<tr class="even">
<td>CoraZ7 example devicetree</td>
<td><a href="linux.github&gt;main?arch/arm/boot/dts/zynq-coraz7s-adaq4003.dts">arch/arm/boot/dts/zynq-coraz7s-adaq4003.dts</a></td>
</tr>
</tbody>
</table>
</section>
<section id="driver-setup">
<h2>Driver setup<a class="headerlink" href="#driver-setup" title="Link to this heading">¶</a></h2>
<p>Since AD4003/4007/4011/4020 are high speed analog-to-digital converters with speeds up to 2 MSPS, additional components are required to achieve high performance. In this scenario, the following HDL components are required:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#/resources/fpga/peripherals/spi_engine"><span class="xref myst">SPI Engine</span></a></p></li>
<li><p><a class="reference internal" href="#/resources/fpga/docs/axi_dmac"><span class="xref myst">High-Speed DMA Controller Peripheral</span></a></p></li>
</ul>
<p>The device will interface with these components and follow the device tree bindings.</p>
<p>&lt;WRAP box bggreen&gt;&lt;wrap info&gt;This specifies any shell prompt running on the target&lt;/wrap&gt;
&lt;xterm&gt;
properties:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>compatible:
  enum:
    - adi,ad4000
    - adi,ad4001
    - adi,ad4002
    - adi,ad4003
    - adi,ad4004
    - adi,ad4005
    - adi,ad4006
    - adi,ad4007
    - adi,ad4008
    - adi,ad4010
    - adi,ad4011
    - adi,ad4020
    - adi,ad4021
    - adi,ad4022
    - adi,adaq4003

reg: true
spi-max-frequency: true

dmas:
  description: |
    DMA specifier, consisting of a phandle to DMA controller node.
  maxItems: 1

dma-names:
  const: rx

clocks:
  maxItems: 1

clock-names:
  const: ref_clk
  description: AD400X reference clock name.

pwms:
  description: |
    PWM used as trigger source for the SPI engine, also represents the
    acquisition rate for the samples.
  maxItems: 1

pwm-names:
  const: cnv

vref-supply:
  description: Phandle to the regulator for ADC reference voltage.

&#39;#address-cells&#39;:
  const: 1

&#39;#size-cells&#39;:
  const: 0
</pre></div>
</div>
<p>patternProperties:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&quot;^channel@([0-1])$&quot;:
  $ref: adc.yaml
  type: object
  description: Represents the external channel connected to the ADC.

  properties:
    reg:
      maxItems: 1

    diff-channels: true

  required:
    - reg

  additionalProperties: false
</pre></div>
</div>
<p>required:</p>
<ol class="arabic simple">
<li><p>compatible</p></li>
<li><p>reg</p></li>
<li><p>dmas</p></li>
<li><p>dma-names</p></li>
<li><p>vref-supply</p></li>
</ol>
<p>allOf:</p>
<ol class="arabic simple">
<li><p>$ref: /schemas/spi/spi-peripheral-props.yaml#</p></li>
</ol>
<ol class="arabic simple">
<li><p>if:</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>    properties:
      compatible:
        contains:
          enum:
            - adi,adaq4003

  then:
    required:
      - compatible
      - reg
      - dmas
      - dma-names
      - clocks
      - clock-names
      - pwms
      - pwm-names
      - vref-supply
</pre></div>
</div>
<p>unevaluatedProperties: false</p>
<p>examples:</p>
<ol class="arabic simple">
<li><p>|</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>  spi {
      #address-cells = &lt;1&gt;;
      #size-cells = &lt;0&gt;;
      /* Example for a AD400X devices */
      adc@0 {
          compatible = &quot;adi,ad4020&quot;;
          reg = &lt;0&gt;;
          spi-max-frequency = &lt;71000000&gt;;
          vref-supply = &lt;&amp;vref&gt;;

          dmas = &lt;&amp;rx_dma 0&gt;;
          dma-names = &quot;rx&quot;;

          #address-cells = &lt;1&gt;;
          #size-cells = &lt;0&gt;;

          channel@0 {
              reg = &lt;0&gt;;
              diff-channels = &lt;0 1&gt;;
          };
      };
  };
- |
  spi {
      #address-cells = &lt;1&gt;;
      #size-cells = &lt;0&gt;;

      /* Example for a ADAQ400X devices */
      adc@0 {
          compatible = &quot;adi,adaq4003&quot;;
          reg = &lt;0&gt;;
          spi-max-frequency = &lt;80000000&gt;;
          dmas = &lt;&amp;rx_dma 0&gt;;
          dma-names = &quot;rx&quot;;
          clocks = &lt;&amp;spi_clk&gt;;
          clock-names = &quot;ref_clk&quot;;
          pwms = &lt;&amp;adc_trigger 0 0&gt;;
          pwm-names = &quot;cnv&quot;;
          vref-supply = &lt;&amp;vref&gt;;

          #address-cells = &lt;1&gt;;
          #size-cells = &lt;0&gt;;

          channel@0 {
              reg = &lt;0&gt;;
              diff-channels = &lt;0 1&gt;;
          };
      };
  };
</pre></div>
</div>
<p>&lt;/xterm&gt;&lt;/WRAP&gt;</p>
<p>See the <a class="reference internal" href="#/resources/eval/ad400x-eval-board"><span class="xref myst">Evaluating AD400X and ADAQ400X devices</span></a> user guide for examples of device trees used with devices supported by the ad400x Linux driver.</p>
</section>
<section id="adding-linux-driver-support">
<h2>Adding Linux driver support<a class="headerlink" href="#adding-linux-driver-support" title="Link to this heading">¶</a></h2>
<section id="enabling-the-driver">
<h3>Enabling the driver<a class="headerlink" href="#enabling-the-driver" title="Link to this heading">¶</a></h3>
<p>Configure kernel with “make menuconfig” (alternatively use “make xconfig” or
“make qconfig”)</p>
<p>&lt;WRAP round help&gt;
The AD400x driver depends on <strong>CONFIG_SPI_MASTER</strong>
&lt;/WRAP&gt;</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Linux Kernel Configuration
    Device Drivers  ---&gt;
        ...
        &lt;*&gt;     Industrial I/O support ---&gt;
            --- Industrial I/O support
            ...
            Analog to digital converters  ---&gt; 
                ...
                &lt;*&gt;   Analog Devices AD400X ADC Driver
                ...
            ...
        ...
</pre></div>
</div>
</section>
</section>
<section id="driver-testing">
<h2>Driver testing<a class="headerlink" href="#driver-testing" title="Link to this heading">¶</a></h2>
<p>![iio_snippets#iio device files&amp;noheader&amp;firstseconly&amp;noeditbtn](/page&gt;software/linux/docs/iio/iio_snippets#iio device files&amp;noheader&amp;firstseconly&amp;noeditbtn)</p>
<p>&lt;WRAP top tip round box 60%&gt;<strong>TIP:</strong>
An example program which uses the interface can be found here:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#/resources/tools-software/linux-software/iio_oscilloscope"><span class="xref myst">IIO Oscilloscope</span></a></p></li>
</ul>
<p>&lt;/WRAP&gt;<br />
&lt;WRAP box bggreen&gt;&lt;wrap info&gt;This specifies any shell prompt running on the target&lt;/wrap&gt;
&lt;xterm&gt;
root&#64;analog:~# ls -l /sys/bus/iio/devices/
total 0
lrwxrwxrwx 1 root root 0 Apr 2 21:42 iio:device0 -&gt; …/…/…/devices/soc0/axi/f8007100.adc/iio:device0
lrwxrwxrwx 1 root root 0 Apr 2 21:43 iio:device1 -&gt; …/…/…/devices/soc0/fpga-axi&#64;0/44a00000.spi/spi_master/spi0/spi0.0/iio:device1
lrwxrwxrwx 1 root root 0 Apr 2 21:42 iio_sysfs_trigger -&gt; …/…/…/devices/iio_sysfs_trigger</p>
<p>root&#64;analog:~# ls -l /sys/bus/iio/devices/iio:device1/
total 0
drwxr-xr-x 2 root root 0 Apr 2 21:43 buffer
drwxr-xr-x 2 root root 0 Apr 2 21:43 buffer0
-r–r–r– 1 root root 4096 Apr 2 21:43 dev
-rw-r–r– 1 root root 4096 Apr 2 21:43 in_voltage0_offset
-rw-r–r– 1 root root 4096 Apr 2 21:43 in_voltage0_raw
-rw-r–r– 1 root root 4096 Apr 2 21:43 in_voltage0_scale
-r–r–r– 1 root root 4096 Apr 2 21:43 name
lrwxrwxrwx 1 root root 0 Apr 2 21:43 of_node -&gt; …/…/…/…/…/…/…/…/firmware/devicetree/base/fpga-axi&#64;0/spi&#64;44a00000/adc&#64;0
drwxr-xr-x 2 root root 0 Apr 2 21:43 power
-rw-r–r– 1 root root 4096 Apr 2 21:43 sampling_frequency
drwxr-xr-x 2 root root 0 Apr 2 21:43 scan_elements
lrwxrwxrwx 1 root root 0 Apr 2 21:43 subsystem -&gt; …/…/…/…/…/…/…/…/bus/iio
-rw-r–r– 1 root root 4096 Apr 2 21:43 uevent
&lt;/xterm&gt;&lt;/WRAP&gt;</p>
<section id="show-device-name">
<h3>Show device name<a class="headerlink" href="#show-device-name" title="Link to this heading">¶</a></h3>
<p>&lt;WRAP box bggreen&gt;&lt;wrap info&gt;This specifies any shell prompt running on the target&lt;/wrap&gt;
&lt;xterm&gt;
root&#64;analog:~# cat /sys/bus/iio/devices/iio:device1/name
adaq4003
&lt;/xterm&gt;&lt;/WRAP&gt;</p>
</section>
<section id="show-channel-scale">
<h3>Show channel scale<a class="headerlink" href="#show-channel-scale" title="Link to this heading">¶</a></h3>
<p><strong>Description:</strong><br />
Scale to be applied to in_voltagex_raw in order to obtain the measured voltage in millivolts</p>
<p>&lt;WRAP box bggreen&gt;&lt;wrap info&gt;This specifies any shell prompt running on the target&lt;/wrap&gt;
&lt;xterm&gt;
root&#64;analog:~# cat /sys/bus/iio/devices/iio:device1/in_voltage0_scale
0.019073486
&lt;/xterm&gt;&lt;/WRAP&gt;</p>
</section>
<section id="configure-sampling-rate">
<h3>Configure sampling rate<a class="headerlink" href="#configure-sampling-rate" title="Link to this heading">¶</a></h3>
<p><strong>[Description:]{.underline}</strong> /sys/bus/iio/devices/iio:deviceX/sampling_frequency<br />
Configures the input sampling rate.</p>
<p>&lt;WRAP box bggreen&gt;&lt;wrap info&gt;This specifies any shell prompt running on the target&lt;/wrap&gt;
&lt;xterm&gt;
root&#64;analog:~# cat /sys/bus/iio/devices/iio:device1/sampling_frequency
2000000
&lt;/xterm&gt;&lt;/WRAP&gt;</p>
<p>&lt;WRAP box bggreen&gt;&lt;wrap info&gt;This specifies any shell prompt running on the target&lt;/wrap&gt;
&lt;xterm&gt;
root&#64;analog:~# <strong>echo 1000000 &gt; /sys/bus/iio/devices/iio:device1/sampling_frequency</strong>
root&#64;analog:~# cat /sys/bus/iio/devices/iio:device1/sampling_frequency
1000000
&lt;/xterm&gt;&lt;/WRAP&gt;</p>
</section>
<section id="buffer-management">
<h3>Buffer management<a class="headerlink" href="#buffer-management" title="Link to this heading">¶</a></h3>
<p>&lt;WRAP box bggreen&gt;&lt;wrap info&gt;This specifies any shell prompt running on the target&lt;/wrap&gt;
&lt;xterm&gt;
root&#64;analog:~# ls -l /sys/bus/iio/devices/iio:device1/buffer/
total 0
-r–r–r– 1 root root 4096 Apr 3 08:11 data_available
-r–r–r– 1 root root 4096 Apr 3 08:11 direction
-rw-r–r– 1 root root 4096 Apr 3 08:11 enable
-rw-r–r– 1 root root 4096 Apr 3 08:11 length
-r–r–r– 1 root root 4096 Apr 3 08:11 length_align_bytes
-r–r–r– 1 root root 4096 Apr 3 08:11 watermark
&lt;/xterm&gt;&lt;/WRAP&gt;</p>
<p>![iio_snippets#Buffer management&amp;noheader&amp;firstseconly&amp;noeditbtn](/page&gt;software/linux/docs/iio/iio_snippets#Buffer management&amp;noheader&amp;firstseconly&amp;noeditbtn)</p>
<p>&lt;WRAP box bggreen&gt;&lt;wrap info&gt;This specifies any shell prompt running on the target&lt;/wrap&gt;
&lt;xterm&gt;
root&#64;analog:~# ls -l /sys/bus/iio/devices/iio:device1/scan_elements/
total 0
-rw-r–r– 1 root root 4096 Apr 3 08:11 in_voltage0_en
-r–r–r– 1 root root 4096 Apr 3 08:11 in_voltage0_index
-r–r–r– 1 root root 4096 Apr 3 08:11 in_voltage0_type
&lt;/xterm&gt;&lt;/WRAP&gt;</p>
<p>![iio_snippets#Typical ADC scan elements&amp;noheader&amp;firstseconly&amp;noeditbtn](/page&gt;software/linux/docs/iio/iio_snippets#Typical ADC scan elements&amp;noheader&amp;firstseconly&amp;noeditbtn)</p>
<p>&lt;WRAP box bggreen&gt;&lt;wrap info&gt;This specifies any shell prompt running on the target&lt;/wrap&gt;
&lt;xterm&gt;
root&#64;analog:/sys/bus/iio/devices/iio:device1/scan_elements# grep “” *
in_voltage0_en:0
in_voltage0_index:0
in_voltage0_type:le:s18/32&gt;&gt;0
&lt;/xterm&gt;&lt;/WRAP&gt;</p>
</section>
<section id="buffer-example">
<h3>Buffer Example<a class="headerlink" href="#buffer-example" title="Link to this heading">¶</a></h3>
<p>When the buffer is enabled, the ad400x driver prepares a read transfer and configures the <a class="reference internal" href="#/resources/fpga/peripherals/spi_engine/offload"><span class="xref myst">SPI Engine Offload</span></a> module to repeat that transfer each time the offload module is triggered. Then, the ad400x driver sets a PWM device to trigger the offload module at the rate specified by the <code class="docutils literal notranslate"><span class="pre">sampling_frequency</span></code> attribute. With that, ADC readings are gathered continuously while the buffer remains enabled.</p>
<p>&lt;WRAP box bggreen&gt;&lt;wrap info&gt;This specifies any shell prompt running on the target - Example command sequence&lt;/wrap&gt;
&lt;xterm&gt;
root&#64;analog:~# echo 1 &gt; /sys/bus/iio/devices/iio:device1/scan_elements/in_voltage0_en
root&#64;analog:~# cat /sys/bus/iio/devices/iio:device1/scan_elements/in_voltage0_en
1
root&#64;analog:~# echo 1 &gt; /sys/bus/iio/devices/iio:device1/buffer/enable
root&#64;analog:~# cat /sys/bus/iio/devices/iio:device1/buffer/data_available
32768
&lt;/xterm&gt;&lt;/WRAP&gt;</p>
<section id="data-interpretation">
<h4>Data interpretation<a class="headerlink" href="#data-interpretation" title="Link to this heading">¶</a></h4>
<p>Each buffer entry contains one sample. The amount of bits and their meaning will vary according to ADC precision and output code pattern (whether output code is twos complement or not). Buffer raw data may be retrieved by reading the character device associated with the ADC device.</p>
<p>&lt;WRAP box bggreen&gt;&lt;wrap info&gt;This specifies any shell prompt running on the target&lt;/wrap&gt;
&lt;xterm&gt;
root&#64;analog:~# hexdump -n 512 -e ‘ 32 “%d “ “\n”’ /dev/iio:device1
4864 4889 4730 4716 4695 4678 4667 4659 4662 4676 4706 4738 4770 4789 4786 4785 4775 4763 4752 4737 4723 4703 4686 4673 4666 4672 4688 4715 4762 4799 4820 4821
4816 4807 4788 4773 4757 4737 4718 4694 4676 4664 4668 4692 4727 4777 4814 4837 4836 4829 4822 4808 4796 4771 4748 4728 4707 4685 4664 4654 4651 4659 4675 4709
4757 4801 4823 4826 4812 4800 4789 4770 4749 4724 4700 4677 4653 4644 4633 4639 4659 4695 4738 4777 4798 4799 4794 4785 4772 4755 4735 4712 4692 4668 4652 4646
4641 4648 4674 4709 4753 4793 4817 4818 4808 4797 4780 4764 4748 4724 4699 4674 4656 4639 4627 4633 4644 4677 4716 4765 4794 4804 4801 4791 4778 4763 4744 4721
&lt;/xterm&gt;&lt;/WRAP&gt;</p>
<p>Remove the <code class="docutils literal notranslate"><span class="pre">-n</span></code> parameter to keep reading the buffer continuously. To stop capture, disable the buffer by writing 0 to <code class="docutils literal notranslate"><span class="pre">/sys/bus/iio/devices/iio:device1/buffer/enable</span></code>.</p>
</section>
</section>
</section>
<section id="more-information">
<h2>More Information<a class="headerlink" href="#more-information" title="Link to this heading">¶</a></h2>
<p>![iio_snippets#iio pointers&amp;noheader&amp;firstseconly&amp;noeditbtn](/page&gt;software/linux/docs/iio/iio_snippets#iio pointers&amp;noheader&amp;firstseconly&amp;noeditbtn)</p>
</section>
</section>


          </div>
              <div class="related">
                &nbsp;
    <a href="../iio-amplifiers/hmc425a.html" title="Previous document" class="prev">HMC425A Digital Step Attenuator Linux Driver</a>
    <a href="ad4630.html" title="Next document" class="next">AD4630 ADC Linux Driver</a>
              </div>
          
        </div>
      </div>
  </div>

  <div id="vertical-border"></div>

  <label id="cancel-area-show-toc" for="input-show-toc"></label>
  <label id="cancel-area-show-localtoc" for="input-show-localtoc"></label>

  
  <form action="" method="get" class="search-area">
    <input type="text" name="q" aria-labelledby="search-documentation" value="" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="search" placeholder="Search"/>
    <button value="search"></button>
    <span id="search-progress"></span>
  </form>
  
    <footer>
      &#169;2024, Analog Devices, Inc.
      
      |
      Made with <a href="https://www.sphinx-doc.org/">Sphinx</a>
      &amp; <a href="https://github.com/analogdevicesinc/doctools">Doctools</a>
      
    </footer>
  </body>
</html>