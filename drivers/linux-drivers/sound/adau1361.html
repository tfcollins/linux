<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>ADAU1361 Sound CODEC Linux Driver &#8212; Linux Kernel: Variant from Analog Devices, Inc. v6.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=8e8a900e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/style.min.css?v=cf8483f0" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    <script src="../../../_static/documentation_options.js?v=cb43cce9"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/tabs.js?v=3ee01567"></script>
    <script defer="" src="../../../_static/app.umd.js?v=96350458"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="ADAU1372 Sound CODEC Linux Driver" href="adau1372.html" />
    <link rel="prev" title="ADAS1000: Low Power, 5-ELECTRODE ELECTROCARDIOGRAM (ECG) ANALOG FRONT END (AFE) Linux Driver" href="../iio-adc/adas1000.html" />
   
  
    <meta name="robots" content="noindex">
  
  


<style>
  body {
    
  }

  body.dark {
    
  }

  @media (prefers-color-scheme: dark) {
    body:not(.light) {
      
    }
  }
</style>
  </head><body>
  <input type="checkbox" id="input-show-toc">
  <input type="checkbox" id="input-show-localtoc">
  <header>
    <div class="header">
      <div id="left">
        <label id="show-sidebar" for="input-show-toc" title="Show/hide index"></label>
      </div>
      <div id="right">
        <span>
          <a id="logo-org" href="https://analog.com"></a>
              <a id="no-logo" href="../../../index.html">
                Linux Kernel: Variant from Analog Devices, Inc.
              </a>
        </span>
        <span class="reverse">
          <label id="show-localtoc" for="input-show-localtoc" title="Show/hide contents"></label>
        </span>
      </div>
    </div>
    <div class="repotoc-tree">
      <root>
  <a href="../../../../documentation/eval/index.html">Evaluation Boards</a>
  <a href="../../../../documentation/university/index.html">University Program</a>
  <a href="../../../../hdl/index.html">HDL</a>
  <a href="../../../../no-OS/index.html">no-OS</a>
  <a href="../../../../pyadi-iio/index.html">pyadi-iio</a>
  <a href="../../../../precision-converters-firmware/index.html">Precision Converters Firmware</a>
  <a href="../../../../PrecisionToolbox/index.html">Precision Toolbox</a>
</root>

    </div>
  </header>

    <div class="localtoc">
      <div class="tocwrapper">
        <div>
          <div class="localtoc-header">On this page</div>
          <a id="scroll-up" href="#top-anchor" title="Back to top"></a>
        </div>
        <nav>
          <ul>
<li><a class="reference internal" href="#">ADAU1361 Sound CODEC Linux Driver</a><ul>
<li><a class="reference internal" href="#supported-devices">Supported Devices</a></li>
<li><a class="reference internal" href="#reference-circuits">Reference Circuits</a></li>
<li><a class="reference internal" href="#evaluation-boards">Evaluation Boards</a></li>
<li><a class="reference internal" href="#source-code">Source Code</a><ul>
<li><a class="reference internal" href="#status">Status</a></li>
<li><a class="reference internal" href="#files">Files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-device-initialization">Example device initialization</a><ul>
<li><a class="reference internal" href="#i2c">I2C</a></li>
<li><a class="reference internal" href="#asoc-dapm-widgets">ASoC DAPM Widgets</a></li>
<li><a class="reference internal" href="#alsa-controls">ALSA Controls</a></li>
<li><a class="reference internal" href="#pll-configuration">PLL configuration</a></li>
<li><a class="reference internal" href="#dai-configuration">DAI configuration</a><ul>
<li><a class="reference internal" href="#supported-dai-formats">Supported DAI formats</a></li>
<li><a class="reference internal" href="#dai-sysclk">DAI sysclk</a></li>
<li><a class="reference internal" href="#example-dai-configuration">Example DAI configuration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tdm-configuration">TDM configuration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sigmadsp-firmware">SigmaDSP Firmware</a></li>
<li><a class="reference internal" href="#adau1x61-evaluation-board-driver">ADAU1X61 evaluation board driver</a><ul>
<li><a class="reference internal" href="#source">Source</a><ul>
<li><a class="reference internal" href="#id1">Status</a></li>
<li><a class="reference internal" href="#id2">Files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#kernel-configuration">Kernel configuration</a></li>
<li><a class="reference internal" href="#hardware-configuration">Hardware configuration</a></li>
<li><a class="reference internal" href="#driver-testing">Driver testing</a></li>
<li><a class="reference internal" href="#more-information">More information</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </nav>
      </div>
    </div>

  
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
              <a id="no-logo" href="../../../index.html">
                Linux Kernel: Variant from Analog Devices, Inc.
              </a><input id="input-switch-toc" type="checkbox">
<label id="show-repotoc" for="input-switch-toc">
All content
</label>
<label id="show-toc" for="input-switch-toc">
Content on this topic
</label>
<div class="repotoc-tree">
  <root>
  <a href="../../../../documentation/eval/index.html">Evaluation Boards</a>
  <a href="../../../../documentation/university/index.html">University Program</a>
  <a href="../../../../hdl/index.html">HDL</a>
  <a href="../../../../no-OS/index.html">no-OS</a>
  <a href="../../../../pyadi-iio/index.html">pyadi-iio</a>
  <a href="../../../../precision-converters-firmware/index.html">Precision Converters Firmware</a>
  <a href="../../../../PrecisionToolbox/index.html">Precision Toolbox</a>
</root>

</div>
<div class="toc-tree">
  <html>
  <body><ul class="current">
<li class="toctree-l1 current"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-1" id="toctree-collapse-1" checked=""/><div class="collapse"><a class="reference internal" href="../../../drivers_index.html">Linux Drivers</a><label for="toctree-collapse-1"><div class="icon"></div></label></div><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ad1835a.html">AD1835A</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad1936.html">AD1933</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-resolver/ad2s1200.html">AD2S1200</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-resolver/ad2s1210.html">AD2S1210</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-resolver/ad2s90.html">AD2S90</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/axi-ad3552r.html">AD3552R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad400x.html">AD4003</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad4630.html">AD4030-24</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5064.html">AD5024</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc/dpot.html">AD5160</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5446.html">AD5300</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5676.html">AD5310R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5360.html">AD5360</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5380.html">AD5380</a></li>
<li class="toctree-l2"><a class="reference internal" href="../regulator/ad5398.html">AD5398</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5449.html">AD5415</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5421.html">AD5421</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5504.html">AD5501</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5592r.html">AD5592R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5593r.html">AD5593R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5624r.html">AD5624</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5755.html">AD5735</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5764.html">AD5744</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5758.html">AD5758</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5791.html">AD5760</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5770r.html">AD5770R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-impedance-analyzer/ad5933.html">AD5933</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad6676.html">AD6676</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad9208.html">AD6684</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7476a.html">AD7091</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7091r5.html">AD7091R-5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7091r8.html">AD7091R-8</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7124.html">AD7124-4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-misc/ad714x.html">AD7142</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-cdc/ad7150.html">AD7150</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-cdc/ad7152.html">AD7152</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7780.html">AD7170</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7192.html">AD7190</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7266.html">AD7265</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7280a.html">AD7280A</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7291.html">AD7291</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7298.html">AD7298</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad73322.html">AD73311</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad738x.html">AD7380</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-addac/ad74413r.html">AD74412R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7606.html">AD7605-4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-cdc/ad7745.html">AD7745</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7766.html">AD7766-1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7768-1.html">AD7768-1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7768.html">AD7768</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7793.html">AD7785</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7791.html">AD7787</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-touchscreen/ad7873.html">AD7843</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-touchscreen/ad7877.html">AD7877</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-touchscreen/ad7879.html">AD7879-1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7887.html">AD7887</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7998.html">AD7991</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-amplifiers/ad8366.html">AD8366</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-mxfe/ad9081.html">AD9081</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad9083.html">AD9083</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dds/axi-dac-dds-hdl.html">AD9122</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ad9162.html">AD9161</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../resources/tools-software/linux-drivers/iio-adc/ad9208.html">AD9208</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/axi-adc-hdl.html">AD9234</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-transceiver/ad9361.html">AD9361</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-transceiver/ad9371.html">AD9371</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ad9508.html">AD9508</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ad9517.html">AD9516-0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ad9523.html">AD9523-1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ad9528.html">AD9528</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clk/adi/clk-ad9545.c.html">AD9545</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dds/ad9832.html">AD9832</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dds/ad9834.html">AD9833</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-amplifiers/ada4250.html">ADA4250</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/adaq8092.html">ADAQ8092</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-transceiver/adar1000.html">ADAR1000</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/adas1000.html">ADAS1000</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">ADAU1361</a></li>
<li class="toctree-l2"><a class="reference internal" href="adau1372.html">ADAU1372</a></li>
<li class="toctree-l2"><a class="reference internal" href="adau1373.html">ADAU1373</a></li>
<li class="toctree-l2"><a class="reference internal" href="adau1381.html">ADAU1381</a></li>
<li class="toctree-l2"><a class="reference internal" href="adau1701.html">ADAU1401</a></li>
<li class="toctree-l2"><a class="reference internal" href="adau1977.html">ADAU1977</a></li>
<li class="toctree-l2"><a class="reference internal" href="adau7002.html">ADAU7002</a></li>
<li class="toctree-l2"><a class="reference internal" href="adau7118.html">ADAU7118</a></li>
<li class="toctree-l2"><a class="reference internal" href="adav801.html">ADAV801</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf4159.html">ADF4159</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf4350.html">ADF4350</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf5355.html">ADF4355-2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf4360.html">ADF4360-0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf4371.html">ADF4371</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf4377.html">ADF4377</a></li>
<li class="toctree-l2"><a class="reference internal" href="../networking-mac802154/adf7242.html">ADF7241</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mux/adgs1408.html">ADGS1408</a></li>
<li class="toctree-l2"><a class="reference internal" href="../net-phy/adin1100.html">ADIN1100</a></li>
<li class="toctree-l2"><a class="reference internal" href="../net-mac-phy/adin1110.html">ADIN1110</a></li>
<li class="toctree-l2"><a class="reference internal" href="../net-phy/adin.html">ADIN1200</a></li>
<li class="toctree-l2"><a class="reference internal" href="../net-mac-phy/adin2111.html">ADIN2111</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adis16060.html">ADIS16060</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adis16080.html">ADIS16080</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adis16130.html">ADIS16130</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adis16136.html">ADIS16133</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adis16201.html">ADIS16201</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adis16203.html">ADIS16203</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adis16209.html">ADIS16209</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adis16240.html">ADIS16240</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adis16260.html">ADIS16250</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-inertial-measurement-units/adis16400.html">ADIS16300</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-inertial-measurement-units/adis16480.html">ADIS16375</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-inertial-measurement-units/adis16475.html">ADIS16460</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-vector-power/adl5960.html">ADL5960</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/admv1013.html">ADMV1013</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/admv1014.html">ADMV1014</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-filter/admv8818.html">ADMV8818</a></li>
<li class="toctree-l2"><a class="reference internal" href="../regulator/adp150.html">ADP122</a></li>
<li class="toctree-l2"><a class="reference internal" href="../leds/adp1650.html">ADP1650</a></li>
<li class="toctree-l2"><a class="reference internal" href="../multifunction-device/adp5520.html">ADP5501</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-keyboard/adp5589.html">ADP5585</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-keyboard/adp5588.html">ADP5587</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backlight/adp8860.html">ADP8860</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backlight/adp8870.html">ADP8870</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adrf6780.html">ADRF6780</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-transceiver/adrv9002.html">ADRV9002</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-transceiver/adrv9009.html">ADRV9008-1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../drm/adv7511.html">ADV7511</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adxl313.html">ADXL312,</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-misc/adxl345.html">ADXL345</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adxl355.html">ADXL355</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-misc/adxl362.html">ADXL362</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adxl367.html">ADXL367</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adxl372.html">ADXL372</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adxrs450.html">ADXRS450</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hwmon/axi_fan_control.html">Fan Control IP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-amplifiers/hmc425a.html">HMC425</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/hmc7044.html">HMC7043</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ltc2664.html">LTC2664</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hwmon/ltc2947.html">LTC2947</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-temperature/ltc2983.html">LTC2983</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ltc6952.html">LTC6952</a></li>
<li class="toctree-l2"><a class="reference internal" href="../serial/max310x.html">MAX14830</a></li>
<li class="toctree-l2"><a class="reference internal" href="../net-mac-phy/open_alliance.html">Open Alliance - 10BASE-T1x MAC-PHY Serial Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="ssm2602.html">SSM2602</a></li>
<li class="toctree-l2"><a class="reference internal" href="ssm4567.html">SSM4567</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../guides/build.html">Building Kernels</a></li>
</ul>
</body>
</html>

</div>
        </div>
      </div>

  <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper" id="top-anchor">
          <div class="body" role="main">
            
  <section class="tex2jax_ignore mathjax_ignore" id="adau1361-sound-codec-linux-driver">
<h1>ADAU1361 Sound CODEC Linux Driver<a class="headerlink" href="#adau1361-sound-codec-linux-driver" title="Link to this heading">¶</a></h1>
<section id="supported-devices">
<h2>Supported Devices<a class="headerlink" href="#supported-devices" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://analog.com/ADAU1361">ADAU1361</a></p></li>
<li><p><a class="reference external" href="https://analog.com/ADAU1461">ADAU1461</a></p></li>
<li><p><a class="reference external" href="https://analog.com/ADAU1761">ADAU1761</a></p></li>
<li><p><a class="reference external" href="https://analog.com/ADAU1961">ADAU1961</a></p></li>
</ul>
</section>
<section id="reference-circuits">
<h2>Reference Circuits<a class="headerlink" href="#reference-circuits" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://analog.com/CN0219">CN0219</a></p></li>
<li><p><a class="reference external" href="https://analog.com/CN0296">CN0296</a></p></li>
</ul>
</section>
<section id="evaluation-boards">
<h2>Evaluation Boards<a class="headerlink" href="#evaluation-boards" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://analog.com/EVAL-ADAU1361Z">EVAL-ADAU1361Z</a></p></li>
<li><p><a class="reference external" href="https://analog.com/EVAL-ADAU1761Z">EVAL-ADAU1761Z</a></p></li>
</ul>
</section>
<section id="source-code">
<h2>Source Code<a class="headerlink" href="#source-code" title="Link to this heading">¶</a></h2>
<section id="status">
<h3>Status<a class="headerlink" href="#status" title="Link to this heading">¶</a></h3>
<table>
<thead>
<tr class="header">
<th>Source</th>
<th>Mainlined?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="git.linux.org&gt;sound/soc/codecs/adau1761.c">git</a></td>
<td><a href="git.linux.org&gt;sound/soc/codecs/adau1761.c">Yes</a></td>
</tr>
</tbody>
</table>
</section>
<section id="files">
<h3>Files<a class="headerlink" href="#files" title="Link to this heading">¶</a></h3>
<table>
<thead>
<tr class="header">
<th>Function</th>
<th>File</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>driver</td>
<td><a href="git.linux.org&gt;sound/soc/codecs/adau1761.c">sound/soc/codecs/adau1761.c</a></td>
</tr>
<tr class="even">
<td>driver</td>
<td><a href="git.linux.org&gt;sound/soc/codecs/adau17x1.c">sound/soc/codecs/adau17x1.c</a></td>
</tr>
<tr class="odd">
<td>include</td>
<td><a href="git.linux.org&gt;sound/soc/codecs/adau17x1.h">sound/soc/codecs/adau17x1.h</a></td>
</tr>
<tr class="even">
<td>include</td>
<td><a href="git.linux.org&gt;include/linux/platform_data/adau17x1.h">include/linux/platform_data/adau17x1.h</a></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="example-device-initialization">
<h2>Example device initialization<a class="headerlink" href="#example-device-initialization" title="Link to this heading">¶</a></h2>
<!-- CMDS: noheader firstseconly noeditbtn -->
<section id="i2c">
<h3>I2C<a class="headerlink" href="#i2c" title="Link to this heading">¶</a></h3>
<!-- CMDS: firstseconly noeditbtn -->
<p>The I2C device id depends on the ADDR0 and ADDR1 pin settings and needs to be set according to your board setup.</p>
<table>
<thead>
<tr class="header">
<th>ADDR1</th>
<th>ADDR0</th>
<th>I2C device id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0</td>
<td>0x38</td>
</tr>
<tr class="even">
<td>0</td>
<td>1</td>
<td>0x39</td>
</tr>
<tr class="odd">
<td>1</td>
<td>0</td>
<td>0x3a</td>
</tr>
<tr class="even">
<td>1</td>
<td>1</td>
<td>0x3b</td>
</tr>
</tbody>
</table>
<p>In this example we assume ADDR0=0 and ADDR1=0.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">i2c_board_info</span><span class="w"> </span><span class="n">__initdata</span><span class="w"> </span><span class="n">bfin_i2c_board_info</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="p">[</span><span class="o">--</span><span class="n">snip</span><span class="o">--</span><span class="p">]</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">I2C_BOARD_INFO</span><span class="p">(</span><span class="s">&quot;adau1761&quot;</span><span class="p">,</span><span class="w"> </span><span class="mh">0x38</span><span class="p">),</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">[</span><span class="o">--</span><span class="n">snip</span><span class="o">--</span><span class="p">]</span>
<span class="p">}</span>

</pre></div>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">__init</span><span class="w"> </span><span class="nf">stamp_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="p">[</span><span class="o">--</span><span class="n">snip</span><span class="o">--</span><span class="p">]</span>
<span class="w">    </span><span class="n">i2c_register_board_info</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">bfin_i2c_board_info</span><span class="p">,</span>
<span class="w">                </span><span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">bfin_i2c_board_info</span><span class="p">));</span>
<span class="w">    </span><span class="p">[</span><span class="o">--</span><span class="n">snip</span><span class="o">--</span><span class="p">]</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">arch_initcall</span><span class="p">(</span><span class="n">board_init</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="asoc-dapm-widgets">
<h3>ASoC DAPM Widgets<a class="headerlink" href="#asoc-dapm-widgets" title="Link to this heading">¶</a></h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Description</th>
<th>Configuration</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>LAUX</td>
<td>Left Channel Single-Ended Auxiliary Input</td>
<td></td>
</tr>
<tr class="even">
<td>RAUX</td>
<td>Right Channel Single-Ended Auxiliary Input</td>
<td></td>
</tr>
<tr class="odd">
<td>LINP</td>
<td>Left Channel Noninverting Input or Single-Ended Input 0</td>
<td></td>
</tr>
<tr class="even">
<td>LINN</td>
<td>Left Channel Inverting Input or Single-Ended Input 1</td>
<td></td>
</tr>
<tr class="odd">
<td>RINP</td>
<td>Right Channel Noninverting Input or Single-Ended Input 2</td>
<td></td>
</tr>
<tr class="even">
<td>RINN</td>
<td>Right Channel Inverting Input or Single-Ended Input 3</td>
<td></td>
</tr>
<tr class="odd">
<td>LOUT</td>
<td>Left Line Output</td>
<td></td>
</tr>
<tr class="even">
<td>ROUT</td>
<td>Right Line Output</td>
<td></td>
</tr>
<tr class="odd">
<td>LHP</td>
<td>Left Headphone Output</td>
<td></td>
</tr>
<tr class="even">
<td>RHP</td>
<td>Right Headphone Output</td>
<td></td>
</tr>
<tr class="odd">
<td>MONOOUT</td>
<td>Mono Output</td>
<td>Headphone mode not capless</td>
</tr>
<tr class="even">
<td>DMIC</td>
<td>Digital Microphone in</td>
<td>JACKDET/MICIN pin configured for DMIC</td>
</tr>
<tr class="odd">
<td>MICBIAS</td>
<td>Bias Voltage for Electret Microphone</td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="alsa-controls">
<h3>ALSA Controls<a class="headerlink" href="#alsa-controls" title="Link to this heading">¶</a></h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Description</th>
<th>Configuration</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Digital Capture Volume</td>
<td>Digital volume attenuation for input from either the ADC or the digital microphone input.</td>
<td></td>
</tr>
<tr class="even">
<td>Digital Playback Volume</td>
<td>Digital volume attenuation for output from the DAC</td>
<td></td>
</tr>
<tr class="odd">
<td>ADC High Pass Filter Switch</td>
<td>Enable/Disable ADC high-pass-filter</td>
<td></td>
</tr>
<tr class="even">
<td>Playback De-emphasis</td>
<td>Enable/Disable Playback de-empahsis</td>
<td></td>
</tr>
<tr class="odd">
<td>Capture Boost</td>
<td>Mixer amplifier bias boost<br />
Valid values: "Normal operation", "Boost Level 1", "Boost Level 2", "Boost Level 3"</td>
<td></td>
</tr>
<tr class="even">
<td>Mic Bias Mode</td>
<td>Microphone bias.<br />
Valid values: "Normal operation", "High performance"</td>
<td></td>
</tr>
<tr class="odd">
<td>DAC Mono Stereo</td>
<td>DAC mono mode.<br />
Valid values: "Stereo", "Mono Left Channel (L+R)", "Mono Right Channel (L+R)", "Mono (L+R)"</td>
<td></td>
</tr>
<tr class="even">
<td>Capture Mux</td>
<td>Selects the source for the capture I2S audio data stream, can either be the DSP or the ADC/DMIC</td>
<td>ADAU1761 only</td>
</tr>
<tr class="odd">
<td>DAC Playback Mux</td>
<td>Selects the source for the DACs, can either be from the I2S audio interface or the DSP</td>
<td>ADAU1761 only</td>
</tr>
<tr class="even">
<td>Input 1 Capture Volume</td>
<td>Gain for single-ended input from the LINP pin</td>
<td>Single-ended inputs</td>
</tr>
<tr class="odd">
<td>Input 2 Capture Volume</td>
<td>Gain for single-ended input from the LINN pin</td>
<td>Single-ended inputs</td>
</tr>
<tr class="even">
<td>Input 3 Capture Volume</td>
<td>Gain for single-ended input from the RINP pin</td>
<td>Single-ended inputs</td>
</tr>
<tr class="odd">
<td>Input 4 Capture Volume</td>
<td>Gain for single-ended input from the RINN pin</td>
<td>Single-ended inputs</td>
</tr>
<tr class="even">
<td>Capture Volume</td>
<td>Differential PGA input volume</td>
<td>Differential inputs</td>
</tr>
<tr class="odd">
<td>Capture Switch</td>
<td>Mute/Unmute differential input</td>
<td>Differential inputs</td>
</tr>
<tr class="even">
<td>Aux Capture Volume</td>
<td>Single-ended auxiliary input gain in the record path</td>
<td></td>
</tr>
<tr class="odd">
<td>PGA Boost Capture Volume</td>
<td>Differential PGA input gain boost</td>
<td>Differential inputs</td>
</tr>
<tr class="even">
<td>Headphone Playback Volume</td>
<td>Headphone volume</td>
<td></td>
</tr>
<tr class="odd">
<td>Headphone Playback Switch</td>
<td>Mute/Unmute Headphone signal</td>
<td></td>
</tr>
<tr class="even">
<td>Lineout Playback Volume</td>
<td>Lineout volume</td>
<td></td>
</tr>
<tr class="odd">
<td>Lineout Playback Switch</td>
<td>Mute/Unmute Lineout signal</td>
<td></td>
</tr>
<tr class="even">
<td>ADC Bias</td>
<td>ADC bias.<br />
Valid values: "Normal operation", "Extreme powersaving", "Enhanced performance", "Power saving"</td>
<td></td>
</tr>
<tr class="odd">
<td>DAC Bias</td>
<td>DAC bias.<br />
Valid values: "Normal operation", "Extreme powersaving", "Enhanced performance", "Power saving"</td>
<td></td>
</tr>
<tr class="even">
<td>Capture Bias</td>
<td>Record path bias.<br />
Valid values: "Normal operation", "Enhanced performance", "Power saving"</td>
<td></td>
</tr>
<tr class="odd">
<td>Playback Bias</td>
<td>Playback path bias.<br />
Valid values: "Normal operation", "Enhanced performance", "Power saving"</td>
<td></td>
</tr>
<tr class="even">
<td>Headphone Bias</td>
<td>Headphone bias.<br />
Valid values: "Normal operation", "Extreme powersaving", "Enhanced performance", "Power saving"</td>
<td></td>
</tr>
<tr class="odd">
<td>Right LR Playback Mixer Left Volume</td>
<td>Left Playback Mixer gain to the Right LR Playback Mixer</td>
<td></td>
</tr>
<tr class="even">
<td>Right LR Playback Mixer Right Volume</td>
<td>Right Playback Mixer gain to the Right LR Playback Mixer</td>
<td></td>
</tr>
<tr class="odd">
<td>Left LR Playback Mixer Left Volume</td>
<td>Left Playback Mixer gain to the Left LR Playback Mixer</td>
<td></td>
</tr>
<tr class="even">
<td>Left LR Playback Mixer Right Volume</td>
<td>Right Playback Mixer gain to the Left LR Playback Mixer</td>
<td></td>
</tr>
<tr class="odd">
<td>Right Playback Mixer Left DAC Switch</td>
<td>Mix Left DAC signal into the Right Playback Mixer</td>
<td></td>
</tr>
<tr class="even">
<td>Right Playback Mixer Right DAC Switch</td>
<td>Mix Right DAC signal into the Right Playback Mixer</td>
<td></td>
</tr>
<tr class="odd">
<td>Right Playback Mixer Aux Bypass Volume</td>
<td>Auxiliary input gain to the Right Playback Mixer</td>
<td></td>
</tr>
<tr class="even">
<td>Right Playback Mixer Right Bypass Volume</td>
<td>Right Record Mixer gain to the Right Playback Mixer</td>
<td></td>
</tr>
<tr class="odd">
<td>Right Playback Mixer Left Bypass Volume</td>
<td>Left Record Mixer gain to the Right Playback Mixer</td>
<td></td>
</tr>
<tr class="even">
<td>Left Playback Mixer Left DAC Switch</td>
<td>Mix Left DAC signal into the Left Playback Mixer</td>
<td></td>
</tr>
<tr class="odd">
<td>Left Playback Mixer Right DAC Switch</td>
<td>Mix Right DAC signal into the Left Playback Mixer</td>
<td></td>
</tr>
<tr class="even">
<td>Left Playback Mixer Aux Bypass Volume</td>
<td>Auxiliary input gain to the Left Playback Mixer</td>
<td></td>
</tr>
<tr class="odd">
<td>Left Playback Mixer Right Bypass Volume</td>
<td>Right Record Mixer gain to the Left Playback Mixer</td>
<td></td>
</tr>
<tr class="even">
<td>Left Playback Mixer Left Bypass Volume</td>
<td>Left Record Mixer gain to the Left Playback Mixer</td>
<td></td>
</tr>
<tr class="odd">
<td>Mono Playback Switch</td>
<td>Mute/Unmute Mono out signal</td>
<td>Headphone mode not capless</td>
</tr>
<tr class="even">
<td>Input Select</td>
<td>Select capture path source.<br />
Valid values: "ADC", "DMIC"</td>
<td>DMIC/JACKDETECT pin configured as DMIC</td>
</tr>
<tr class="odd">
<td>Jack Detect Switch</td>
<td>Enable/Disable Jack insertion detection. If enable the Lineout signals are muted if a headphone is inserted.</td>
<td>DMIC/JACKDETECT pin configured as JACKDETECT</td>
</tr>
</tbody>
</table>
</section>
<section id="pll-configuration">
<h3>PLL configuration<a class="headerlink" href="#pll-configuration" title="Link to this heading">¶</a></h3>
<p>The ADAU1761 features one PLL:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">enum</span><span class="w"> </span><span class="n">adau17x1_pll</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ADAU17X1_PLL</span>
<span class="p">};</span>
</pre></div>
</div>
<p>The PLL input signal is the MCLK signal.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">enum</span><span class="w"> </span><span class="n">adau17x1_pll_src</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ADAU17X1_PLL_SRC_MCLK</span><span class="p">,</span>
<span class="p">};</span>
</pre></div>
</div>
<p>(The input frequency must configured to be between 8000000 and 27000000 Hz (8MHz - 27MHz). The output frequency must be configured to be between 45158000 and 49152000. Configuring the PLL with other input or output frequency will fail.)</p>
<p>The PLL runs at 1024 times the base sample rate. So for a 48000 Hz based sample rate you’d normally choose 49152000 Hz for the PLL output frequncey and for a 44100 Hz based sample rate 45158400 Hz.</p>
</section>
<section id="dai-configuration">
<h3>DAI configuration<a class="headerlink" href="#dai-configuration" title="Link to this heading">¶</a></h3>
<p>The codec driver registers one DAI: <strong>adau-hifi</strong></p>
<section id="supported-dai-formats">
<h4>Supported DAI formats<a class="headerlink" href="#supported-dai-formats" title="Link to this heading">¶</a></h4>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Supported by driver</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>SND_SOC_DAIFMT_I2S</td>
<td>yes</td>
<td>I2S mode</td>
</tr>
<tr class="even">
<td>SND_SOC_DAIFMT_RIGHT_J</td>
<td>yes</td>
<td>Right Justified mode</td>
</tr>
<tr class="odd">
<td>SND_SOC_DAIFMT_LEFT_J</td>
<td>yes</td>
<td>Left Justified mode</td>
</tr>
<tr class="even">
<td>SND_SOC_DAIFMT_DSP_A</td>
<td>yes</td>
<td>data MSB after FRM LRC</td>
</tr>
<tr class="odd">
<td>SND_SOC_DAIFMT_DSP_B</td>
<td>yes</td>
<td>data MSB during FRM LRC</td>
</tr>
<tr class="even">
<td>SND_SOC_DAIFMT_AC97</td>
<td>no</td>
<td>AC97 mode</td>
</tr>
<tr class="odd">
<td>SND_SOC_DAIFMT_PDM</td>
<td>no</td>
<td>Pulse density modulation</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>SND_SOC_DAIFMT_NB_NF</td>
<td>yes</td>
<td>Normal bit- and frameclock</td>
</tr>
<tr class="even">
<td>SND_SOC_DAIFMT_NB_IF</td>
<td>yes</td>
<td>Normal bitclock, inverted frameclock</td>
</tr>
<tr class="odd">
<td>SND_SOC_DAIFMT_IB_NF</td>
<td>yes</td>
<td>Inverted frameclock, normal bitclock</td>
</tr>
<tr class="even">
<td>SND_SOC_DAIFMT_IB_IF</td>
<td>yes</td>
<td>Inverted bit- and frameclock</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>SND_SOC_DAIFMT_CBM_CFM</td>
<td>yes</td>
<td>Codec bit- and frameclock master</td>
</tr>
<tr class="odd">
<td>SND_SOC_DAIFMT_CBS_CFM</td>
<td>no</td>
<td>Codec bitclock slave, frameclock master</td>
</tr>
<tr class="even">
<td>SND_SOC_DAIFMT_CBM_CFS</td>
<td>no</td>
<td>Codec bitclock master, frameclock slave</td>
</tr>
<tr class="odd">
<td>SND_SOC_DAIFMT_CBS_CFS</td>
<td>yes</td>
<td>Codec bit- and frameclock slave</td>
</tr>
</tbody>
</table>
</section>
<section id="dai-sysclk">
<h4>DAI sysclk<a class="headerlink" href="#dai-sysclk" title="Link to this heading">¶</a></h4>
<p>The DAIs can either use the PLL or the MCLK signal as source.</p>
<p>When using the PLL the DAIs rate should be set to the rate of the PLL. When using MCLK the rate should be set to frequency of the external MCLK signal.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">enum</span><span class="w"> </span><span class="n">adau17x1_clk_src</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ADAU17X1_CLK_SRC_MCLK</span><span class="p">,</span>
<span class="w">    </span><span class="n">ADAU17X1_CLK_SRC_PLL</span><span class="p">,</span>
<span class="p">};</span>
</pre></div>
</div>
</section>
<section id="example-dai-configuration">
<h4>Example DAI configuration<a class="headerlink" href="#example-dai-configuration" title="Link to this heading">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">bfin_eval_adau1x61_hw_params</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">snd_pcm_substream</span><span class="w"> </span><span class="o">*</span><span class="n">substream</span><span class="p">,</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">snd_pcm_hw_params</span><span class="w"> </span><span class="o">*</span><span class="n">params</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">snd_soc_pcm_runtime</span><span class="w"> </span><span class="o">*</span><span class="n">rtd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">substream</span><span class="o">-&gt;</span><span class="n">private_data</span><span class="p">;</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">snd_soc_dai</span><span class="w"> </span><span class="o">*</span><span class="n">cpu_dai</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rtd</span><span class="o">-&gt;</span><span class="n">cpu_dai</span><span class="p">;</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">snd_soc_dai</span><span class="w"> </span><span class="o">*</span><span class="n">codec_dai</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rtd</span><span class="o">-&gt;</span><span class="n">codec_dai</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">pll_rate</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>

<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snd_soc_dai_set_fmt</span><span class="p">(</span><span class="n">cpu_dai</span><span class="p">,</span><span class="w"> </span><span class="n">SND_SOC_DAIFMT_I2S</span><span class="w"> </span><span class="o">|</span>
<span class="w">            </span><span class="n">SND_SOC_DAIFMT_NB_NF</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">SND_SOC_DAIFMT_CBM_CFM</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>

<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snd_soc_dai_set_fmt</span><span class="p">(</span><span class="n">codec_dai</span><span class="p">,</span><span class="w"> </span><span class="n">SND_SOC_DAIFMT_I2S</span><span class="w"> </span><span class="o">|</span>
<span class="w">            </span><span class="n">SND_SOC_DAIFMT_NB_NF</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">SND_SOC_DAIFMT_CBM_CFM</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>

<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">params_rate</span><span class="p">(</span><span class="n">params</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">48000</span><span class="p">:</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">8000</span><span class="p">:</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">12000</span><span class="p">:</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">16000</span><span class="p">:</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">24000</span><span class="p">:</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">32000</span><span class="p">:</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">96000</span><span class="p">:</span>
<span class="w">        </span><span class="n">pll_rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">48000</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="p">;</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">44100</span><span class="p">:</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">7350</span><span class="p">:</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">11025</span><span class="p">:</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">14700</span><span class="p">:</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">22050</span><span class="p">:</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">29400</span><span class="p">:</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">88200</span><span class="p">:</span>
<span class="w">        </span><span class="n">pll_rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">44100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="p">;</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">default</span><span class="o">:</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snd_soc_dai_set_pll</span><span class="p">(</span><span class="n">codec_dai</span><span class="p">,</span><span class="w"> </span><span class="n">ADAU17X1_PLL</span><span class="p">,</span>
<span class="w">            </span><span class="n">ADAU17X1_PLL_SRC_MCLK</span><span class="p">,</span><span class="w"> </span><span class="mi">12288000</span><span class="p">,</span><span class="w"> </span><span class="n">pll_rate</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>

<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snd_soc_dai_set_sysclk</span><span class="p">(</span><span class="n">codec_dai</span><span class="p">,</span><span class="w"> </span><span class="n">ADAU17X1_CLK_SRC_PLL</span><span class="p">,</span><span class="w"> </span><span class="n">pll_rate</span><span class="p">,</span>
<span class="w">            </span><span class="n">SND_SOC_CLOCK_IN</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>


<span class="k">static</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">snd_soc_ops</span><span class="w"> </span><span class="n">bfin_eval_adau1x61_ops</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">.</span><span class="n">hw_params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bfin_eval_adau1x61_hw_params</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">snd_soc_dai_link</span><span class="w"> </span><span class="n">bfin_eval_adau1x61_dai</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;adau1x61&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">stream_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ADAU1X61&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="p">.</span><span class="n">cpu_dai_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;bfin-i2s.0&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="p">.</span><span class="n">codec_dai_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;adau-hifi&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">platform_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;bfin-i2s-pcm-audio&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">codec_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;adau1761.0-0038&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">ops</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">bfin_eval_adau1x61_ops</span><span class="p">,</span>
<span class="p">};</span>
</pre></div>
</div>
</section>
</section>
<section id="tdm-configuration">
<h3>TDM configuration<a class="headerlink" href="#tdm-configuration" title="Link to this heading">¶</a></h3>
<p>The ADAU1361 and ADAU1761 chips have basic TDM support.</p>
<ul class="simple">
<li><p>The number of slots can be either 2, 4 or 8 (ADAU1761 only).</p></li>
<li><p>The slot width can be 32 (ADAU1361 only), 64, 48, 128 or 256 (ADAU1761 only)</p></li>
<li><p>The slot mask must be either 0x03 (slot 0 and 1), 0x0c (slot 2 and 3), 0x30 (slot 4 and 5), 0xc0 (slot 6 and 7)</p></li>
</ul>
<p>Example TDM configuration:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snd_soc_dai_set_tdm_slot</span><span class="p">(</span><span class="n">codec_dai</span><span class="p">,</span><span class="w"> </span><span class="mh">0x30</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0c</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span>
</pre></div>
</div>
</section>
</section>
<section id="sigmadsp-firmware">
<h2>SigmaDSP Firmware<a class="headerlink" href="#sigmadsp-firmware" title="Link to this heading">¶</a></h2>
<p>In order to use the SigmaDSP core of the ADAU1761 you need to provide a firmware file. Please refer to the <a class="reference internal" href="#resources/tools-software/linux-software/sigmadsp_genfirmware"><span class="xref myst">SigmaDSP Firmware Utility for Linux</span></a> page on how to generate a firmware file. The firmware file for ADAU1761 driver has to be named <strong>adau1761.bin</strong>.</p>
</section>
<section id="adau1x61-evaluation-board-driver">
<h2>ADAU1X61 evaluation board driver<a class="headerlink" href="#adau1x61-evaluation-board-driver" title="Link to this heading">¶</a></h2>
<p>There is no dedicated Blackfin STAMP evaluation board for the ADAU1361 or ADAU1761. During test and driver development we used the <a class="reference external" href="https://analog.com/EVAL-ADAU1361Z">EVAL-ADAU1361Z</a> and <a class="reference external" href="https://analog.com/EVAL-ADAU1761Z">EVAL-ADAU1761Z</a> boards.</p>
<p>It can be easily wired to the Blackfin STAMP SPORT header.</p>
<section id="source">
<h3>Source<a class="headerlink" href="#source" title="Link to this heading">¶</a></h3>
<section id="id1">
<h4>Status<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h4>
<table>
<thead>
<tr class="header">
<th>Source</th>
<th>Mainlined?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="git.linux.org&gt;sound/soc/blackfin/bfin-eval-adau1x61.c">git</a></td>
<td><a href="git.linux.org&gt;sound/soc/blackfin/bfin-eval-adau1x61.c">Yes</a></td>
</tr>
</tbody>
</table>
</section>
<section id="id2">
<h4>Files<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h4>
<table>
<thead>
<tr class="header">
<th>Function</th>
<th>File</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>driver</td>
<td><a href="git.linux.org&gt;sound/soc/blackfin/bfin-eval-adau1x61.c">sound/soc/blackfin/bfin-eval-adau1x61.c</a></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="kernel-configuration">
<h3>Kernel configuration<a class="headerlink" href="#kernel-configuration" title="Link to this heading">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Device Drivers  ---&gt;
[*] I2C support  ---&gt;
[*]   I2C Hardware Bus support  ---&gt;
***     I2C system bus drivers (mostly embedded / system-on-chip) ***
&lt;*&gt;       Blackfin TWI I2C support
(100)     Blackfin TWI I2C clock (kHz)
</pre></div>
</div>
<p>Enable ALSA SoC evaluation board driver:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Device Drivers  ---&gt;
&lt;M&gt; Sound card support  ---&gt;
&lt;M&gt;   Advanced Linux Sound Architecture  ---&gt;
&lt;M&gt;     ALSA for SoC audio support  ---&gt;
&lt;M&gt;       Support for the EVAL-ADAU1X61 boards on Blackfin eval boards
</pre></div>
</div>
</section>
<section id="hardware-configuration">
<h3>Hardware configuration<a class="headerlink" href="#hardware-configuration" title="Link to this heading">¶</a></h3>
<p>Connect the STAMP SPORT 0 port (P6) to the EVAL-ADAU1X61 J1 and J6 headers.</p>
<p>Note that the SPORT has separate signals for the capture and playback clocks, while the ADAU1361 uses the same clock signals for both, so the EVAL-ADAU1X61 clock signal pins need to be connected to two STAMP pins each.</p>
<table>
<thead>
<tr class="header">
<th>STAMP pin</th>
<th>EVAL-ADAU1X61 pin</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>P6-26 (SPORT 0 - PJ2_SCL)</td>
<td>J1-1</td>
<td>I2C SCL</td>
</tr>
<tr class="even">
<td>P6-24 (SPORT 0 - PJ3_SDA)</td>
<td>J1-3</td>
<td>I2C SDA</td>
</tr>
<tr class="odd">
<td>P6-6 (SPORT 0 - PJ9_TSCLK0), P6-16 (SPORT 0 - PJ6_RSCLK0)</td>
<td>J6-6</td>
<td>BCLK</td>
</tr>
<tr class="even">
<td>P6-11 (SPORT 0 - PJ10_TFS0), P6-7 (SPORT 0 - PJ7_RFS0)</td>
<td>J6-8</td>
<td>LRCLK</td>
</tr>
<tr class="odd">
<td>P6-14 (SPORT 0 - PJ11_DT0PRI</td>
<td>J6-4</td>
<td>Playback data</td>
</tr>
<tr class="even">
<td>P6-8 (SPORT 0 - PJ8_DR0PRI)</td>
<td>J6-2</td>
<td>Captrue data</td>
</tr>
<tr class="odd">
<td>P6-33</td>
<td>J6-1</td>
<td>GND</td>
</tr>
</tbody>
</table>
</section>
<section id="driver-testing">
<h3>Driver testing<a class="headerlink" href="#driver-testing" title="Link to this heading">¶</a></h3>
<p>Load the driver and make sure the sound card is properly instantiated.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<!-- ATTRS: box="" bggreen="" -->
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<!-- ATTRS: info="" -->
<p>This specifies any shell prompt running on the target</p>
</div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>root:/&gt;<span class="w"> </span>modprobe<span class="w"> </span>snd-bf5xx-i2s
root:/&gt;<span class="w"> </span>modprobe<span class="w"> </span>snd-soc-bf5xx-i2s
root:/&gt;<span class="w"> </span>modprobe<span class="w"> </span>snd-soc-adau1761
root:/&gt;<span class="w"> </span>modprobe<span class="w"> </span>snd-soc-bfin-eval-adau1x61
bfin-i2s<span class="w"> </span>bfin-i2s.0:<span class="w"> </span>dma<span class="w"> </span>rx:3<span class="w"> </span>tx:4,<span class="w"> </span>err<span class="w"> </span>irq:45,<span class="w"> </span>regs:ffc00800
dma_alloc_init:<span class="w"> </span>dma_page<span class="w"> </span>@<span class="w"> </span>0x02791000<span class="w"> </span>-<span class="w"> </span><span class="m">256</span><span class="w"> </span>pages<span class="w"> </span>at<span class="w"> </span>0x03f00000
asoc:<span class="w"> </span>adau-hifi<span class="w"> </span>&lt;-&gt;<span class="w"> </span>bfin-i2s.0<span class="w"> </span>mapping<span class="w"> </span>ok
ALSA<span class="w"> </span>device<span class="w"> </span>list:

<span class="w">    </span><span class="c1">#0: bfin-eval-adau1x61</span>
</pre></div>
</div>
<div class="docutils">
<div class="admonition note">
<p class="admonition-title">Note</p>
<!-- ATTRS: box="" bggreen="" -->
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<!-- ATTRS: info="" -->
<p>This specifies any shell prompt running on the target</p>
</div>
</div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>root:/&gt;<span class="w"> </span>modprobe<span class="w"> </span>snd-pcm-oss
root:/&gt;<span class="w"> </span>tone
TONE:<span class="w"> </span>generating<span class="w"> </span>sine<span class="w"> </span>wave<span class="w"> </span>at<span class="w"> </span><span class="m">1000</span><span class="w"> </span>Hz...

root:/&gt;<span class="w"> </span>arecord<span class="w"> </span>-f<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>aplay
Recording<span class="w"> </span>WAVE<span class="w"> </span><span class="s1">&#39;stdin&#39;</span><span class="w"> </span>:<span class="w"> </span>Signed<span class="w"> </span><span class="m">16</span><span class="w"> </span>bit<span class="w"> </span>Little<span class="w"> </span>Endian,<span class="w"> </span>Rate<span class="w"> </span><span class="m">44100</span><span class="w"> </span>Hz,<span class="w"> </span>Stereo
Playing<span class="w"> </span>WAVE<span class="w"> </span><span class="s1">&#39;stdin&#39;</span><span class="w"> </span>:<span class="w"> </span>Signed<span class="w"> </span><span class="m">16</span><span class="w"> </span>bit<span class="w"> </span>Little<span class="w"> </span>Endian,<span class="w"> </span>Rate<span class="w"> </span><span class="m">44100</span><span class="w"> </span>Hz,<span class="w"> </span>Stereo
</pre></div>
</div>
<div class="docutils">
<div class="admonition note">
<p class="admonition-title">Note</p>
<!-- ATTRS: important="" -->
<p>If you do not hear any sound during testing make sure you have enabled the necessary Switches and Volumes. E.g. for playback on the Headphone output you need to enable the “Left Playback Mixer Left DAC”, “Right Playback Mixer Right DAC” and the “Headphone Playback” switches and set the “DAC Playback Mux” to “AIFIN”.</p>
</div>
</div>
</section>
<section id="more-information">
<h3>More information<a class="headerlink" href="#more-information" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="#resources/tools-software/sigmastudio"><span class="xref myst">SigmaStudio</span></a></p></li>
<li><p><a class="reference internal" href="#resources/tools-software/linux-software/sigmadsp_genfirmware"><span class="xref myst">SigmaDSP Firmware Utility for Linux</span></a></p></li>
<li><p><a class="reference internal" href="#resources/tools-software/linux-software/sigmatcp"><span class="xref myst">SigmaStudio Network Utility for Linux</span></a></p></li>
</ul>
<!-- CMDS: noheader firstseconly noeditbtn -->
</section>
</section>
</section>


          </div>
              <div class="related">
                &nbsp;
    <a href="../iio-adc/adas1000.html" title="Previous document" class="prev">ADAS1000: Low Power, 5-ELECTRODE ELECTROCARDIOGRAM (ECG) ANALOG FRONT END (AFE) Linux Driver</a>
    <a href="adau1372.html" title="Next document" class="next">ADAU1372 Sound CODEC Linux Driver</a>
              </div>
          
        </div>
      </div>
  </div>

  <div id="vertical-border"></div>

  <label id="cancel-area-show-toc" for="input-show-toc"></label>
  <label id="cancel-area-show-localtoc" for="input-show-localtoc"></label>

  
  <form action="" method="get" class="search-area">
    <input type="text" name="q" aria-labelledby="search-documentation" value="" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="search" placeholder="Search"/>
    <button value="search"></button>
    <span id="search-progress"></span>
  </form>
  
    <footer>
      &#169;2024, Analog Devices, Inc.
      
      |
      Made with <a href="https://www.sphinx-doc.org/">Sphinx</a>
      &amp; <a href="https://github.com/analogdevicesinc/doctools">Doctools</a>
      
    </footer>
  </body>
</html>