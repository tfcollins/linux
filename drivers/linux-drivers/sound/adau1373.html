<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>ADAU1373 Sound CODEC Linux Driver &#8212; Linux Kernel: Variant from Analog Devices, Inc. v6.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=8e8a900e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/style.min.css?v=cf8483f0" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    <script src="../../../_static/documentation_options.js?v=cb43cce9"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/tabs.js?v=3ee01567"></script>
    <script defer="" src="../../../_static/app.umd.js?v=96350458"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="ADAU1781 Sound CODEC Linux Driver" href="adau1381.html" />
    <link rel="prev" title="ADAU1372 Sound CODEC Linux Driver" href="adau1372.html" />
   
  
    <meta name="robots" content="noindex">
  
  


<style>
  body {
    
  }

  body.dark {
    
  }

  @media (prefers-color-scheme: dark) {
    body:not(.light) {
      
    }
  }
</style>
  </head><body>
  <input type="checkbox" id="input-show-toc">
  <input type="checkbox" id="input-show-localtoc">
  <header>
    <div class="header">
      <div id="left">
        <label id="show-sidebar" for="input-show-toc" title="Show/hide index"></label>
      </div>
      <div id="right">
        <span>
          <a id="logo-org" href="https://analog.com"></a>
              <a id="no-logo" href="../../../index.html">
                Linux Kernel: Variant from Analog Devices, Inc.
              </a>
        </span>
        <span class="reverse">
          <label id="show-localtoc" for="input-show-localtoc" title="Show/hide contents"></label>
        </span>
      </div>
    </div>
    <div class="repotoc-tree">
      <root>
  <a href="../../../../documentation/eval/index.html">Evaluation Boards</a>
  <a href="../../../../documentation/university/index.html">University Program</a>
  <a href="../../../../hdl/index.html">HDL</a>
  <a href="../../../../no-OS/index.html">no-OS</a>
  <a href="../../../../pyadi-iio/index.html">pyadi-iio</a>
  <a href="../../../../precision-converters-firmware/index.html">Precision Converters Firmware</a>
  <a href="../../../../PrecisionToolbox/index.html">Precision Toolbox</a>
</root>

    </div>
  </header>

    <div class="localtoc">
      <div class="tocwrapper">
        <div>
          <div class="localtoc-header">On this page</div>
          <a id="scroll-up" href="#top-anchor" title="Back to top"></a>
        </div>
        <nav>
          <ul>
<li><a class="reference internal" href="#">ADAU1373 Sound CODEC Linux Driver</a><ul>
<li><a class="reference internal" href="#supported-devices">Supported Devices</a></li>
<li><a class="reference internal" href="#evaluation-boards">Evaluation Boards</a></li>
<li><a class="reference internal" href="#source-code">Source Code</a><ul>
<li><a class="reference internal" href="#status">Status</a></li>
<li><a class="reference internal" href="#files">Files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-device-initialization">Example device initialization</a><ul>
<li><a class="reference internal" href="#i2c">I2C</a></li>
</ul>
</li>
<li><a class="reference internal" href="#asoc-dapm-widgets">ASoC DAPM Widgets</a></li>
<li><a class="reference internal" href="#alsa-controls">ALSA Controls</a></li>
<li><a class="reference internal" href="#pll-configuration">PLL Configuration</a></li>
<li><a class="reference internal" href="#dai-configuration">DAI configuration</a><ul>
<li><a class="reference internal" href="#supported-dai-formats">Supported DAI formats</a></li>
<li><a class="reference internal" href="#dai-sysclk">DAI sysclk</a></li>
<li><a class="reference internal" href="#example-dai-configuration">Example DAI configuration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adau1373-evaluation-board-driver">ADAU1373 evaluation board driver</a><ul>
<li><a class="reference internal" href="#source">Source</a><ul>
<li><a class="reference internal" href="#id1">Status</a></li>
<li><a class="reference internal" href="#id2">Files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#kernel-configuration">Kernel configuration</a></li>
<li><a class="reference internal" href="#hardware-configuration">Hardware configuration</a></li>
<li><a class="reference internal" href="#driver-testing">Driver testing</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </nav>
      </div>
    </div>

  
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
              <a id="no-logo" href="../../../index.html">
                Linux Kernel: Variant from Analog Devices, Inc.
              </a><input id="input-switch-toc" type="checkbox">
<label id="show-repotoc" for="input-switch-toc">
All content
</label>
<label id="show-toc" for="input-switch-toc">
Content on this topic
</label>
<div class="repotoc-tree">
  <root>
  <a href="../../../../documentation/eval/index.html">Evaluation Boards</a>
  <a href="../../../../documentation/university/index.html">University Program</a>
  <a href="../../../../hdl/index.html">HDL</a>
  <a href="../../../../no-OS/index.html">no-OS</a>
  <a href="../../../../pyadi-iio/index.html">pyadi-iio</a>
  <a href="../../../../precision-converters-firmware/index.html">Precision Converters Firmware</a>
  <a href="../../../../PrecisionToolbox/index.html">Precision Toolbox</a>
</root>

</div>
<div class="toc-tree">
  <html>
  <body><ul class="current">
<li class="toctree-l1 current"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-1" id="toctree-collapse-1" checked=""/><div class="collapse"><a class="reference internal" href="../../../drivers_index.html">Linux Drivers</a><label for="toctree-collapse-1"><div class="icon"></div></label></div><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../multifunction-device/adp5520.html">ADP5501</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backlight/adp8860.html">ADP8860</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backlight/adp8870.html">ADP8870</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clk/adi/clk-ad9545.c.html">AD9545</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-keyboard/adp5588.html">ADP5587</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-keyboard/adp5589.html">ADP5585</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hwmon/axi_fan_control.html">Fan Control IP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hwmon/ltc2947.html">LTC2947</a></li>
<li class="toctree-l2"><a class="reference internal" href="../net-phy/adin1100.html">ADIN1100</a></li>
<li class="toctree-l2"><a class="reference internal" href="../net-phy/adin.html">ADIN1200</a></li>
<li class="toctree-l2"><a class="reference internal" href="../net-mac-phy/adin1110.html">ADIN1110</a></li>
<li class="toctree-l2"><a class="reference internal" href="../net-mac-phy/adin2111.html">ADIN2111</a></li>
<li class="toctree-l2"><a class="reference internal" href="../net-mac-phy/open_alliance.html">Open Alliance - 10BASE-T1x MAC-PHY Serial Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adxl313.html">ADXL312,</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-misc/adxl345.html">ADXL345</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adxl355.html">ADXL355</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-misc/adxl362.html">ADXL362</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adxl367.html">ADXL367</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adxl372.html">ADXL372</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adis16201.html">ADIS16201</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adis16203.html">ADIS16203</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adis16209.html">ADIS16209</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adis16240.html">ADIS16240</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-amplifiers/ad8366.html">AD8366</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-amplifiers/ada4250.html">ADA4250</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-amplifiers/hmc425a.html">HMC425</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad400x.html">AD4003</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad4630.html">AD4030-24</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad9208.html">AD6684</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7476a.html">AD7091</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7091r5.html">AD7091R-5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7091r8.html">AD7091R-8</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7124.html">AD7124</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7780.html">AD7170</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7192.html">AD7190</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7266.html">AD7265</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7280a.html">AD7280A</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7291.html">AD7291</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7298.html">AD7298</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad738x.html">AD7380</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7606.html">AD7605-4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7766.html">AD7766-1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7768-1.html">AD7768-1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7768.html">AD7768</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7793.html">AD7785</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7791.html">AD7787</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7887.html">AD7887</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7998.html">AD7991</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad9083.html">AD9083</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-mxfe/ad9081.html">AD9207</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../resources/tools-software/linux-drivers/iio-adc/ad9208.html">AD9208</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/axi-adc-hdl.html">AD9234</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/adaq8092.html">ADAQ8092</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/adas1000.html">ADAS1000</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-transceiver/adar1000.html">ADAR1000</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-cdc/ad7152.html">AD7152</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-cdc/ad7150.html">AD7150</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-cdc/ad7745.html">AD7745</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-addac/ad74413r.html">AD74412R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/axi-ad3552r.html">AD3552R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5064.html">AD5024</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5446.html">AD5300</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5676.html">AD5310R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5360.html">AD5360</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5380.html">AD5380</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5449.html">AD5415</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5421.html">AD5421</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5504.html">AD5501</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5592r.html">AD5592R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5593r.html">AD5593R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5624r.html">AD5624</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5755.html">AD5735</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5764.html">AD5744</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5758.html">AD5758</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5791.html">AD5760</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5770r.html">AD5770R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dds/axi-dac-dds-hdl.html">AD9122</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ltc2664.html">LTC2664</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dds/ad9832.html">AD9832</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dds/ad9834.html">AD9833</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-filter/admv8818.html">ADMV8818</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ad9162.html">AD9161</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ad9508.html">AD9508</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ad9517.html">AD9516-0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ad9523.html">AD9523-1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ad9528.html">AD9528</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf4159.html">ADF4159</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf4350.html">ADF4350</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf4360.html">ADF4360-0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf4371.html">ADF4371</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf4377.html">ADF4377</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf5355.html">ADF4355</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/admv1013.html">ADMV1013</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/admv1014.html">ADMV1014</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adrf6780.html">ADRF6780</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/hmc7044.html">HMC7044</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ltc6952.html">LTC6952</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adis16060.html">ADIS16060</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adis16080.html">ADIS16080</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adis16130.html">ADIS16130</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adis16136.html">ADIS16133</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adis16260.html">ADIS16251</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adxrs450.html">ADXRS450</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-impedance-analyzer/ad5933.html">AD5933</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-inertial-measurement-units/adis16400.html">ADIS16300</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-inertial-measurement-units/adis16480.html">ADIS16375</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-inertial-measurement-units/adis16475.html">ADIS16460</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-resolver/ad2s90.html">AD2S90</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-resolver/ad2s1200.html">AD2S1200</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-resolver/ad2s1210.html">AD2S1210</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad6676.html">AD6676</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-transceiver/ad9361.html">AD9361</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-transceiver/ad9371.html">AD9371</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-transceiver/adrv9002.html">ADRV9002</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-transceiver/adrv9009.html">ADRV9008-1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-temperature/ltc2983.html">LTC2983</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-vector-power/adl5960.html">ADL5960</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-misc/ad714x.html">AD7142</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-touchscreen/ad7873.html">AD7873</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-touchscreen/ad7877.html">AD7877</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-touchscreen/ad7879.html">AD7879</a></li>
<li class="toctree-l2"><a class="reference internal" href="../leds/adp1650.html">ADP1650</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc/dpot.html">AD5160</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mux/adgs1408.html">ADGS1408</a></li>
<li class="toctree-l2"><a class="reference internal" href="../networking-mac802154/adf7242.html">ADF7241</a></li>
<li class="toctree-l2"><a class="reference internal" href="../regulator/adp150.html">ADP122</a></li>
<li class="toctree-l2"><a class="reference internal" href="../regulator/ad5398.html">AD5398</a></li>
<li class="toctree-l2"><a class="reference internal" href="../serial/max310x.html">MAX3107</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad1835a.html">AD1835A</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad1936.html">AD1933</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad73322.html">AD73311</a></li>
<li class="toctree-l2"><a class="reference internal" href="adau1361.html">ADAU1361</a></li>
<li class="toctree-l2"><a class="reference internal" href="adau1372.html">ADAU1372</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">ADAU1373</a></li>
<li class="toctree-l2"><a class="reference internal" href="adau1381.html">ADAU1381</a></li>
<li class="toctree-l2"><a class="reference internal" href="adau1701.html">ADAU1401A</a></li>
<li class="toctree-l2"><a class="reference internal" href="adau1977.html">ADAU1977</a></li>
<li class="toctree-l2"><a class="reference internal" href="adau7002.html">ADAU7002</a></li>
<li class="toctree-l2"><a class="reference internal" href="adau7118.html">ADAU7118</a></li>
<li class="toctree-l2"><a class="reference internal" href="adav801.html">ADAV801</a></li>
<li class="toctree-l2"><a class="reference internal" href="ssm2602.html">SSM2602</a></li>
<li class="toctree-l2"><a class="reference internal" href="ssm4567.html">SSM4567</a></li>
<li class="toctree-l2"><a class="reference internal" href="../drm/adv7511.html">ADV7511</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../guides/build.html">Building Kernels</a></li>
</ul>
</body>
</html>

</div>
        </div>
      </div>

  <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper" id="top-anchor">
          <div class="body" role="main">
            
  <section class="tex2jax_ignore mathjax_ignore" id="adau1373-sound-codec-linux-driver">
<h1>ADAU1373 Sound CODEC Linux Driver<a class="headerlink" href="#adau1373-sound-codec-linux-driver" title="Link to this heading">¶</a></h1>
<section id="supported-devices">
<h2>Supported Devices<a class="headerlink" href="#supported-devices" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#adi%3EADAU1373"><span class="xref myst">ADAU1373</span></a></p></li>
</ul>
</section>
<section id="evaluation-boards">
<h2>Evaluation Boards<a class="headerlink" href="#evaluation-boards" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#adi%3EEVAL-ADAU1373Z"><span class="xref myst">EVAL-ADAU1373Z</span></a></p></li>
</ul>
</section>
<section id="source-code">
<h2>Source Code<a class="headerlink" href="#source-code" title="Link to this heading">¶</a></h2>
<section id="status">
<h3>Status<a class="headerlink" href="#status" title="Link to this heading">¶</a></h3>
<table>
<thead>
<tr class="header">
<th>Source</th>
<th>Mainlined?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="git.linux.org&gt;sound/soc/codecs/adau1373.c">git</a></td>
<td><a href="git.linux.org&gt;sound/soc/codecs/adau1373.c">Yes</a></td>
</tr>
</tbody>
</table>
</section>
<section id="files">
<h3>Files<a class="headerlink" href="#files" title="Link to this heading">¶</a></h3>
<table>
<thead>
<tr class="header">
<th>Function</th>
<th>File</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>driver</td>
<td><a href="git.linux.org&gt;sound/soc/codecs/adau1373.c">sound/soc/codecs/adau1373.c</a></td>
</tr>
<tr class="even">
<td>include</td>
<td><a href="git.linux.org&gt;sound/soc/codecs/adau1373.h">sound/soc/codecs/adau1373.h</a></td>
</tr>
<tr class="odd">
<td>include</td>
<td><a href="git.linux.org&gt;include/sound/adau1373.h">include/sound/adau1373.h</a></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="example-device-initialization">
<h2>Example device initialization<a class="headerlink" href="#example-device-initialization" title="Link to this heading">¶</a></h2>
<p>![](page&gt;software/linux/docs/platform_and_bus_model#Platform Data&amp;noheader&amp;firstseconly&amp;noeditbtn)</p>
<section id="i2c">
<h3>I2C<a class="headerlink" href="#i2c" title="Link to this heading">¶</a></h3>
<p>![](page&gt;software/linux/docs/platform_and_bus_model#Declaring I2C devices&amp;firstseconly&amp;noeditbtn)</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">i2c_board_info</span><span class="w"> </span><span class="n">__initdata</span><span class="w"> </span><span class="n">bfin_i2c_board_info</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="p">[</span><span class="o">--</span><span class="n">snip</span><span class="o">--</span><span class="p">]</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">I2C_BOARD_INFO</span><span class="p">(</span><span class="s">&quot;adau1373&quot;</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1a</span><span class="p">),</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">[</span><span class="o">--</span><span class="n">snip</span><span class="o">--</span><span class="p">]</span>
<span class="p">}</span>

</pre></div>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">__init</span><span class="w"> </span><span class="nf">stamp_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="p">[</span><span class="o">--</span><span class="n">snip</span><span class="o">--</span><span class="p">]</span>
<span class="w">    </span><span class="n">i2c_register_board_info</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">bfin_i2c_board_info</span><span class="p">,</span>
<span class="w">                </span><span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">bfin_i2c_board_info</span><span class="p">));</span>
<span class="w">    </span><span class="p">[</span><span class="o">--</span><span class="n">snip</span><span class="o">--</span><span class="p">]</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">arch_initcall</span><span class="p">(</span><span class="n">board_init</span><span class="p">);</span>
</pre></div>
</div>
</section>
</section>
<section id="asoc-dapm-widgets">
<h2>ASoC DAPM Widgets<a class="headerlink" href="#asoc-dapm-widgets" title="Link to this heading">¶</a></h2>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>AIN1L</td>
<td>Left Channel Input 1</td>
</tr>
<tr class="even">
<td>AIN1R</td>
<td>Right Channel Input 1</td>
</tr>
<tr class="odd">
<td>AIN2L</td>
<td>Left Channel Input 2</td>
</tr>
<tr class="even">
<td>AIN2R</td>
<td>Right Channel Input 2</td>
</tr>
<tr class="odd">
<td>AIN3L</td>
<td>Left Channel Input 3</td>
</tr>
<tr class="even">
<td>AIN3R</td>
<td>Right Channel Input 3</td>
</tr>
<tr class="odd">
<td>AIN4L</td>
<td>Left Channel Input 4</td>
</tr>
<tr class="even">
<td>AIN4R</td>
<td>Right Channel Input 4</td>
</tr>
<tr class="odd">
<td>DMIC1DAT</td>
<td>Serial Data Input Digital Microphone 1 and 2</td>
</tr>
<tr class="even">
<td>DMIC2DAT</td>
<td>Serial Data Input Digital Microphone 3 and 4</td>
</tr>
<tr class="odd">
<td>LOUT1L</td>
<td>Left Channel Line Output 1</td>
</tr>
<tr class="even">
<td>LOUT1R</td>
<td>Right Channel Line Output 1</td>
</tr>
<tr class="odd">
<td>LOUT2L</td>
<td>Left Channel Line Output 2</td>
</tr>
<tr class="even">
<td>LOUT2R</td>
<td>Right Channel Line Output 2</td>
</tr>
<tr class="odd">
<td>HPL</td>
<td>Left Headphone Output</td>
</tr>
<tr class="even">
<td>HPR</td>
<td>Right Headphone Output</td>
</tr>
<tr class="odd">
<td>SPKL</td>
<td>Left Speaker Output</td>
</tr>
<tr class="even">
<td>SPKR</td>
<td>Right Speaker Output</td>
</tr>
<tr class="odd">
<td>EP</td>
<td>Eearpiece Output</td>
</tr>
<tr class="even">
<td>MICBIAS1</td>
<td>Micbias 1 supply</td>
</tr>
<tr class="odd">
<td>MICBIAS2</td>
<td>Micbias 2 supply</td>
</tr>
</tbody>
</table>
</section>
<section id="alsa-controls">
<h2>ALSA Controls<a class="headerlink" href="#alsa-controls" title="Link to this heading">¶</a></h2>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Description</th>
<th>Configuration</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>AIF1 Capture Volume</td>
<td>Digital Audio Interface A Recording Volume</td>
<td></td>
</tr>
<tr class="even">
<td>AIF2 Capture Volume</td>
<td>Digital Audio Interface B Recording Volume</td>
<td></td>
</tr>
<tr class="odd">
<td>AIF3 Capture Volume</td>
<td>Digital Audio Interface C Recording Volume</td>
<td></td>
</tr>
<tr class="even">
<td>ADC Capture Volume</td>
<td>ADC Recording Volume</td>
<td></td>
</tr>
<tr class="odd">
<td>DMIC Capture Volume</td>
<td>DMIC Recording Volume</td>
<td></td>
</tr>
<tr class="even">
<td>Input 1 Capture Volume</td>
<td>Input 1 Gain</td>
<td></td>
</tr>
<tr class="odd">
<td>Input 2 Capture Volume</td>
<td>Input 2 Gain</td>
<td></td>
</tr>
<tr class="even">
<td>Input 3 Capture Volume</td>
<td>Input 3 Gain</td>
<td></td>
</tr>
<tr class="odd">
<td>Input 4 Capture Volume</td>
<td>Input 4 Gain</td>
<td></td>
</tr>
<tr class="even">
<td>Input 1 Boost Capture Volume</td>
<td>Input 1 ADC Boost (+20dB)</td>
<td></td>
</tr>
<tr class="odd">
<td>Input 2 Boost Capture Volume</td>
<td>Input 2 ADC Boost (+20dB)</td>
<td></td>
</tr>
<tr class="even">
<td>Input 3 Boost Capture Volume</td>
<td>Input 3 ADC Boost (+20dB)</td>
<td></td>
</tr>
<tr class="odd">
<td>Input 4 Boost Capture Volume</td>
<td>Input 4 ADC Boost (+20dB)</td>
<td></td>
</tr>
<tr class="even">
<td>AIF1 Playback Volume</td>
<td>Digital Audio Interface A Playback Datapath Volume</td>
<td></td>
</tr>
<tr class="odd">
<td>AIF2 Playback Volume</td>
<td>Digital Audio Interface B Playback Datapath Volume</td>
<td></td>
</tr>
<tr class="even">
<td>AIF3 Playback Volume</td>
<td>Digital Audio Interface C Playback Datapath Volume</td>
<td></td>
</tr>
<tr class="odd">
<td>DAC1 Playback Volume</td>
<td>DAC1 Playback Volume</td>
<td></td>
</tr>
<tr class="even">
<td>DAC2 Playback Volume</td>
<td>DAC2 Playback Volume</td>
<td></td>
</tr>
<tr class="odd">
<td>Lineout1 Playback Volume</td>
<td>Lineout 1 Volume</td>
<td></td>
</tr>
<tr class="even">
<td>Lineout2 Playback Volume</td>
<td>Lineout 2 Volume</td>
<td>Single-ended lineout</td>
</tr>
<tr class="odd">
<td>Speaker Playback Volume</td>
<td>Speaker Out Volume</td>
<td></td>
</tr>
<tr class="even">
<td>Headphone Playback Volume</td>
<td>Heaphone Out Volume</td>
<td></td>
</tr>
<tr class="odd">
<td>Earpiece Playback Volume</td>
<td>Earpiece Amplifier Gain</td>
<td></td>
</tr>
<tr class="even">
<td>AIF1 Boost Playback Volume</td>
<td>Digital Audio Interface A Playback Gain (+6dB)</td>
<td></td>
</tr>
<tr class="odd">
<td>AIF2 Boost Playback Volume</td>
<td>Digital Audio Interface B Playback Gain (+6dB)</td>
<td></td>
</tr>
<tr class="even">
<td>AIF3 Boost Playback Volume</td>
<td>Digital Audio Interface C Playback Gain (+6dB)</td>
<td></td>
</tr>
<tr class="odd">
<td>AIF1 Boost Capture Volume</td>
<td>Digital Audio Interface C Recording Gain (+6dB)</td>
<td></td>
</tr>
<tr class="even">
<td>AIF2 Boost Capture Volume</td>
<td>Digital Audio Interface C Recording Gain (+6dB)</td>
<td></td>
</tr>
<tr class="odd">
<td>AIF3 Boost Capture Volume</td>
<td>Digital Audio Interface C Recording Gain (+6dB)</td>
<td></td>
</tr>
<tr class="even">
<td>ADC Boost Capture Volume</td>
<td>ADC Recording Gain (+6dB)</td>
<td></td>
</tr>
<tr class="odd">
<td>DMIC Boost Capture Volume</td>
<td>DMIC Recording Gain (+6dB)</td>
<td></td>
</tr>
<tr class="even">
<td>DAC1 Boost Playback Volume</td>
<td>DAC1 Playback Gain (+6dB)</td>
<td></td>
</tr>
<tr class="odd">
<td>DAC2 Boost Playback Volume</td>
<td>DAC1 Playback Gain (+6dB)</td>
<td></td>
</tr>
<tr class="even">
<td>Speaker Boost Playback Volume</td>
<td>Speaker Output Gain</td>
<td></td>
</tr>
<tr class="odd">
<td>Lineout1 LR Mux</td>
<td>Lineout1 Left-Right Mux (Mono Stereo Control)<br />
Valid values: "Mute", "Right Channel (L+R)", "Left Channel (L+R)", "Stereo"</td>
<td></td>
</tr>
<tr class="even">
<td>Lineout2 LR Mux</td>
<td>Lineout2 Left-Right Mux (Mono Stereo Control)<br />
Valid values: "Mute", "Right Channel (L+R)", "Left Channel (L+R)", "Stereo"</td>
<td>Single-ended lineout</td>
</tr>
<tr class="odd">
<td>Speaker LR Mux</td>
<td>Speaker Left-Right Mux (Mono Stereo Control)<br />
Valid values: "Mute", "Right Channel (L+R)", "Left Channel (L+R)", "Stereo"</td>
<td></td>
</tr>
<tr class="even">
<td>HPF Cutoff</td>
<td>High-pass-filter cutoff frequency.<br />
Valid values: "3.7Hz", "50Hz", "100Hz", ... steps of 50Hz ..., "800Hz"</td>
<td></td>
</tr>
<tr class="odd">
<td>HPF Switch</td>
<td>Enable/Disable High-pass-filter</td>
<td></td>
</tr>
<tr class="even">
<td>HPF Channel</td>
<td>Hight-pass-filter channel.<br />
Valid values: "Channel1", "Channel2", "Channel3", "Channel4", "Channel5"</td>
<td></td>
</tr>
<tr class="odd">
<td>Bass HPF Cutoff</td>
<td>Bass High-pass-filter cutoff frequency.<br />
Valid values: "158Hz", "232Hz", "347Hz", "520Hz"</td>
<td></td>
</tr>
<tr class="even">
<td>Bass Clip Level Threshold</td>
<td>Signal Extend Density (Clip Level). Overdrive level for bass enhancement.<br />
Valid values: "0.125", "0.250", "0.370", "0.500", "0.625", "0.750", "0.875"</td>
<td></td>
</tr>
<tr class="odd">
<td>Bass LPF Cutoff</td>
<td>Bass Low-pass-filter cutoff frequency.<br />
Valid values: "801Hz", "1001Hz"</td>
<td></td>
</tr>
<tr class="even">
<td>Bass Playback Switch</td>
<td>Enable/Disable Bass Enhancement</td>
<td></td>
</tr>
<tr class="odd">
<td>Bass Playback Volume</td>
<td>Bass Enhancement Gain</td>
<td></td>
</tr>
<tr class="even">
<td>Bass Channel</td>
<td>Bass Enhancement Channel.<br />
Valid values: "Channel1", "Channel2", "Channel3", "Channel4", "Channel5"</td>
<td></td>
</tr>
<tr class="odd">
<td>3D Freq</td>
<td>3D Enhancement cutoff frequency (relative to the sampling rate).<br />
Valid values: "No 3D", "0.03125 fs", "0.04583 fs", "0.075 fs", "0.11458 fs", "0.16875 fs", "0.27083 fs"</td>
<td></td>
</tr>
<tr class="even">
<td>3D Level</td>
<td>3D Enhancement effect level.<br />
Valid values: "0%", "6.67%", "13.33%", "20%", "26.67%", "33.33%", "40%", "46.67%", "53.33%",<br />
"60%", "66.67%", "73.33%", "80%", "86.67", "93.33%", "100%"</td>
<td></td>
</tr>
<tr class="odd">
<td>3D Playback Switch</td>
<td>Enable/Disable 3D Enhancement</td>
<td></td>
</tr>
<tr class="even">
<td>3D Playback Volume</td>
<td>3D Enhancement Gain</td>
<td></td>
</tr>
<tr class="odd">
<td>3D Channel</td>
<td>3D Enhancement Channel.<br />
Valid values: "Channel1", "Channel2", "Channel3", "Channel4", "Channel5"</td>
<td></td>
</tr>
<tr class="even">
<td>Zero Cross Switch</td>
<td>Enable/Disable Zero-Cross-Detection for volume updates</td>
<td></td>
</tr>
<tr class="odd">
<td>DRC1 Channel</td>
<td>Dynamic Range Control 1 Channel.<br />
Valid values: "Channel1", "Channel2", "Channel3", "Channel4", "Channel5"</td>
<td></td>
</tr>
<tr class="even">
<td>DRC2 Channel</td>
<td>Dynamic Range Control 2 Channel.<br />
Valid values: "Channel1", "Channel2", "Channel3", "Channel4", "Channel5"</td>
<td></td>
</tr>
<tr class="odd">
<td>DRC3 Channel</td>
<td>Dynamic Range Control 3 Channel.<br />
Valid values: "Channel1", "Channel2", "Channel3", "Channel4", "Channel5"</td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="pll-configuration">
<h2>PLL Configuration<a class="headerlink" href="#pll-configuration" title="Link to this heading">¶</a></h2>
<p>The ADAU1373 features two PLLs:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">enum</span><span class="w"> </span><span class="n">adau1373_pll</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ADAU1373_PLL1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">ADAU1373_PLL2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Each PLLs input frequency can be selected from a variety of signals:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">enum</span><span class="w"> </span><span class="n">adau1373_pll_src</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ADAU1373_PLL_SRC_MCLK1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">ADAU1373_PLL_SRC_BCLK1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="n">ADAU1373_PLL_SRC_BCLK2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">    </span><span class="n">ADAU1373_PLL_SRC_BCLK3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span>
<span class="w">    </span><span class="n">ADAU1373_PLL_SRC_LRCLK1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span>
<span class="w">    </span><span class="n">ADAU1373_PLL_SRC_LRCLK2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span>
<span class="w">    </span><span class="n">ADAU1373_PLL_SRC_LRCLK3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span>
<span class="w">    </span><span class="n">ADAU1373_PLL_SRC_GPIO1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span>
<span class="w">    </span><span class="n">ADAU1373_PLL_SRC_GPIO2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span>
<span class="w">    </span><span class="n">ADAU1373_PLL_SRC_GPIO3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span>
<span class="w">    </span><span class="n">ADAU1373_PLL_SRC_GPIO4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span>
<span class="w">    </span><span class="n">ADAU1373_PLL_SRC_MCLK2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span>
<span class="p">};</span>
</pre></div>
</div>
<p>The input frequency must configured to be between 7813 and 27000000 Hz. The output frequency must be configured to be between 45158000 and 49152000. Configuring the PLL with other input or output frequency will fail.</p>
<p>The PLL runs at 1024 times the base sample rate. So for a 48000 Hz based sample rate you’d normally choose 49152000 Hz for the PLL output frequncey and for a 44100 Hz based sample rate 45158400 Hz.</p>
</section>
<section id="dai-configuration">
<h2>DAI configuration<a class="headerlink" href="#dai-configuration" title="Link to this heading">¶</a></h2>
<p>The codec driver registers three DAIs:</p>
<ul class="simple">
<li><p>“adau1373-aif1” (Digital Audio Interface A)</p></li>
<li><p>“adau1373-aif2” (Digital Audio Interface B)</p></li>
<li><p>“adau1373-aif3” (Digital Audio Interface C)</p></li>
</ul>
<section id="supported-dai-formats">
<h3>Supported DAI formats<a class="headerlink" href="#supported-dai-formats" title="Link to this heading">¶</a></h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Supported by driver</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>SND_SOC_DAIFMT_I2S</td>
<td>yes</td>
<td>I2S mode</td>
</tr>
<tr class="even">
<td>SND_SOC_DAIFMT_RIGHT_J</td>
<td>yes</td>
<td>Right Justified mode</td>
</tr>
<tr class="odd">
<td>SND_SOC_DAIFMT_LEFT_J</td>
<td>yes</td>
<td>Left Justified mode</td>
</tr>
<tr class="even">
<td>SND_SOC_DAIFMT_DSP_A</td>
<td>no</td>
<td>data MSB after FRM LRC</td>
</tr>
<tr class="odd">
<td>SND_SOC_DAIFMT_DSP_B</td>
<td>yes</td>
<td>data MSB during FRM LRC</td>
</tr>
<tr class="even">
<td>SND_SOC_DAIFMT_AC97</td>
<td>no</td>
<td>AC97 mode</td>
</tr>
<tr class="odd">
<td>SND_SOC_DAIFMT_PDM</td>
<td>no</td>
<td>Pulse density modulation</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>SND_SOC_DAIFMT_NB_NF</td>
<td>yes</td>
<td>Normal bit- and frameclock</td>
</tr>
<tr class="even">
<td>SND_SOC_DAIFMT_NB_IF</td>
<td>yes</td>
<td>Normal bitclock, inverted frameclock</td>
</tr>
<tr class="odd">
<td>SND_SOC_DAIFMT_IB_NF</td>
<td>yes</td>
<td>Inverted frameclock, normal bitclock</td>
</tr>
<tr class="even">
<td>SND_SOC_DAIFMT_IB_IF</td>
<td>yes</td>
<td>Inverted bit- and frameclock</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>SND_SOC_DAIFMT_CBM_CFM</td>
<td>yes</td>
<td>Codec bit- and frameclock master</td>
</tr>
<tr class="odd">
<td>SND_SOC_DAIFMT_CBS_CFM</td>
<td>no</td>
<td>Codec bitclock slave, frameclock master</td>
</tr>
<tr class="even">
<td>SND_SOC_DAIFMT_CBM_CFS</td>
<td>no</td>
<td>Codec bitclock master, frameclock slave</td>
</tr>
<tr class="odd">
<td>SND_SOC_DAIFMT_CBS_CFS</td>
<td>yes</td>
<td>Codec bit- and frameclock slave</td>
</tr>
</tbody>
</table>
</section>
<section id="dai-sysclk">
<h3>DAI sysclk<a class="headerlink" href="#dai-sysclk" title="Link to this heading">¶</a></h3>
<p>The DAIs can either use PLL1 or PLL2 as source. When configuring a DAI its rate should be set to the rate of the source PLL.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">enum</span><span class="w"> </span><span class="n">adau1373_clk_src</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ADAU1373_CLK_SRC_PLL1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">ADAU1373_CLK_SRC_PLL2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="p">};</span>
</pre></div>
</div>
</section>
<section id="example-dai-configuration">
<h3>Example DAI configuration<a class="headerlink" href="#example-dai-configuration" title="Link to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">bfin_eval_adau1373_hw_params</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">snd_pcm_substream</span><span class="w"> </span><span class="o">*</span><span class="n">substream</span><span class="p">,</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">snd_pcm_hw_params</span><span class="w"> </span><span class="o">*</span><span class="n">params</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">snd_soc_pcm_runtime</span><span class="w"> </span><span class="o">*</span><span class="n">rtd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">substream</span><span class="o">-&gt;</span><span class="n">private_data</span><span class="p">;</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">snd_soc_dai</span><span class="w"> </span><span class="o">*</span><span class="n">cpu_dai</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rtd</span><span class="o">-&gt;</span><span class="n">cpu_dai</span><span class="p">;</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">snd_soc_dai</span><span class="w"> </span><span class="o">*</span><span class="n">codec_dai</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rtd</span><span class="o">-&gt;</span><span class="n">codec_dai</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">pll_rate</span><span class="p">;</span>

<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snd_soc_dai_set_fmt</span><span class="p">(</span><span class="n">cpu_dai</span><span class="p">,</span><span class="w"> </span><span class="n">SND_SOC_DAIFMT_I2S</span><span class="w"> </span><span class="o">|</span>
<span class="w">            </span><span class="n">SND_SOC_DAIFMT_NB_NF</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">SND_SOC_DAIFMT_CBM_CFM</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>

<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snd_soc_dai_set_fmt</span><span class="p">(</span><span class="n">codec_dai</span><span class="p">,</span><span class="w"> </span><span class="n">SND_SOC_DAIFMT_I2S</span><span class="w"> </span><span class="o">|</span>
<span class="w">            </span><span class="n">SND_SOC_DAIFMT_NB_NF</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">SND_SOC_DAIFMT_CBM_CFM</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>

<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">params_rate</span><span class="p">(</span><span class="n">params</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">48000</span><span class="p">:</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">8000</span><span class="p">:</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">12000</span><span class="p">:</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">16000</span><span class="p">:</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">24000</span><span class="p">:</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">32000</span><span class="p">:</span>
<span class="w">        </span><span class="n">pll_rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">48000</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="p">;</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">44100</span><span class="p">:</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">7350</span><span class="p">:</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">11025</span><span class="p">:</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">14700</span><span class="p">:</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">22050</span><span class="p">:</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">29400</span><span class="p">:</span>
<span class="w">        </span><span class="n">pll_rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">44100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="p">;</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">default</span><span class="o">:</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snd_soc_dai_set_pll</span><span class="p">(</span><span class="n">codec_dai</span><span class="p">,</span><span class="w"> </span><span class="n">ADAU1373_PLL1</span><span class="p">,</span>
<span class="w">            </span><span class="n">ADAU1373_PLL_SRC_MCLK1</span><span class="p">,</span><span class="w"> </span><span class="mi">12288000</span><span class="p">,</span><span class="w"> </span><span class="n">pll_rate</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>

<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snd_soc_dai_set_sysclk</span><span class="p">(</span><span class="n">codec_dai</span><span class="p">,</span><span class="w"> </span><span class="n">ADAU1373_CLK_SRC_PLL1</span><span class="p">,</span><span class="w"> </span><span class="n">pll_rate</span><span class="p">,</span>
<span class="w">            </span><span class="n">SND_SOC_CLOCK_IN</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">bfin_eval_adau1373_codec_init</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">snd_soc_pcm_runtime</span><span class="w"> </span><span class="o">*</span><span class="n">rtd</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">snd_soc_dai</span><span class="w"> </span><span class="o">*</span><span class="n">codec_dai</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rtd</span><span class="o">-&gt;</span><span class="n">codec_dai</span><span class="p">;</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">pll_rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">48000</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>

<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snd_soc_dai_set_pll</span><span class="p">(</span><span class="n">codec_dai</span><span class="p">,</span><span class="w"> </span><span class="n">ADAU1373_PLL1</span><span class="p">,</span>
<span class="w">            </span><span class="n">ADAU1373_PLL_SRC_MCLK1</span><span class="p">,</span><span class="w"> </span><span class="mi">12288000</span><span class="p">,</span><span class="w"> </span><span class="n">pll_rate</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>

<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snd_soc_dai_set_sysclk</span><span class="p">(</span><span class="n">codec_dai</span><span class="p">,</span><span class="w"> </span><span class="n">ADAU1373_CLK_SRC_PLL1</span><span class="p">,</span><span class="w"> </span><span class="n">pll_rate</span><span class="p">,</span>
<span class="w">            </span><span class="n">SND_SOC_CLOCK_IN</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">static</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">snd_soc_ops</span><span class="w"> </span><span class="n">bfin_eval_adau1373_ops</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">.</span><span class="n">hw_params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bfin_eval_adau1373_hw_params</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">snd_soc_dai_link</span><span class="w"> </span><span class="n">bfin_eval_adau1373_dai</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;adau1373&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">stream_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;adau1373&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">cpu_dai_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;bfin-i2s.0&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">codec_dai_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;adau1373-aif1&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">platform_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;bfin-i2s-pcm-audio&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">codec_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;adau1373.0-001a&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">ops</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">bfin_eval_adau1373_ops</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">init</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bfin_eval_adau1373_codec_init</span><span class="p">,</span>
<span class="p">};</span>
</pre></div>
</div>
</section>
</section>
<section id="adau1373-evaluation-board-driver">
<h2>ADAU1373 evaluation board driver<a class="headerlink" href="#adau1373-evaluation-board-driver" title="Link to this heading">¶</a></h2>
<p>There is no dedicated Blackfin STAMP evaluation board for the ADAU1373. During test and driver development we used the <a class="reference internal" href="#adi%3EEVAL-ADAU1373"><span class="xref myst">EVAL-ADAU1373</span></a> board.</p>
<p>It can be easily wired to the Blackfin STAMP SPORT header.</p>
<section id="source">
<h3>Source<a class="headerlink" href="#source" title="Link to this heading">¶</a></h3>
<section id="id1">
<h4>Status<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h4>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Source</th>
<th style="text-align: center;">Mainlined?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><a href="git.linux.org&gt;sound/soc/blackfin/bfin-eval-adau1373.c">git</a></td>
<td style="text-align: center;"><a href="git.linux.org&gt;sound/soc/blackfin/bfin-eval-adau1373.c">yes</a></td>
</tr>
</tbody>
</table>
</section>
<section id="id2">
<h4>Files<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h4>
<table>
<thead>
<tr class="header">
<th>Function</th>
<th>File</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>driver</td>
<td><a href="git.linux.org&gt;sound/soc/blackfin/bfin-eval-adau1373.c">sound/soc/blackfin/bfin-eval-adau1373.c</a></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="kernel-configuration">
<h3>Kernel configuration<a class="headerlink" href="#kernel-configuration" title="Link to this heading">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Device Drivers  ---&gt;
[*] I2C support  ---&gt;
[*]   I2C Hardware Bus support  ---&gt;
***     I2C system bus drivers (mostly embedded / system-on-chip) ***
&lt;*&gt;       Blackfin TWI I2C support
(100)     Blackfin TWI I2C clock (kHz)
</pre></div>
</div>
<p>Enable ALSA SoC evaluation board driver:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Device Drivers  ---&gt;
&lt;M&gt; Sound card support  ---&gt;
&lt;M&gt;   Advanced Linux Sound Architecture  ---&gt;
&lt;M&gt;     ALSA for SoC audio support  ---&gt;
&lt;M&gt;       Support for the EVAL-ADAU1373 boards on Blackfin eval boards
</pre></div>
</div>
</section>
<section id="hardware-configuration">
<h3>Hardware configuration<a class="headerlink" href="#hardware-configuration" title="Link to this heading">¶</a></h3>
<p>Connect the STAMP SPORT 0 port (P6) to the EVAL-ADAU1373 J23 and J28 headers.</p>
<p>Note that the SPORT has separate signals for the capture and playback clocks, while the ADAU1373 uses the same clock signals for both, so the EVAL-ADU1373 clock signal pins need to be connected to two STAMP pins each.</p>
<table>
<thead>
<tr class="header">
<th>STAMP pin</th>
<th>EVAL-ADAU1373 pin</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>P6-26 (SPORT 0 - PJ2_SCL)</td>
<td>J23-1</td>
<td>I2C SCL</td>
</tr>
<tr class="even">
<td>P6-24 (SPORT 0 - PJ3_SDA)</td>
<td>J23-3</td>
<td>I2C SDA</td>
</tr>
<tr class="odd">
<td>P6-6 (SPORT 0 - PJ9_TSCLK0), P6-16 (SPORT 0 - PJ6_RSCLK0)</td>
<td>J28-6 (A_BCLK)</td>
<td>BCLK</td>
</tr>
<tr class="even">
<td>P6-11 (SPORT 0 - PJ10_TFS0), P6-7 (SPORT 0 - PJ7_RFS0)</td>
<td>J28-8 (A_LRC)</td>
<td>LRCLK</td>
</tr>
<tr class="odd">
<td>P6-14 (SPORT 0 - PJ11_DT0PRI</td>
<td>J28-10 (A_DACDAT)</td>
<td>Playback data</td>
</tr>
<tr class="even">
<td>P6-8 (SPORT 0 - PJ8_DR0PRI)</td>
<td>J28-12 (A_ADCDAT)</td>
<td>Captrue data</td>
</tr>
<tr class="odd">
<td>P6-33</td>
<td>J28-1</td>
<td>GND</td>
</tr>
</tbody>
</table>
</section>
<section id="driver-testing">
<h3>Driver testing<a class="headerlink" href="#driver-testing" title="Link to this heading">¶</a></h3>
<p>Load the driver and make sure the sound card is properly instantiated.</p>
<p>&lt;WRAP box bggreen&gt;&lt;wrap info&gt;This specifies any shell prompt running on the target&lt;/wrap&gt;
&lt;xterm&gt;
root:/&gt; modprobe snd-bf5xx-i2s
root:/&gt; modprobe snd-soc-bf5xx-i2s
root:/&gt; modprobe snd-soc-adau1373
root:/&gt; modprobe snd-soc-bfin-eval-adau1373
dma rx:3 tx:4, err irq:45, regs:ffc00800
asoc: ADAU1373 &lt;-&gt; bf5xx-i2s mapping ok
&lt;/xterm&gt;
&lt;/WRAP&gt;</p>
<p>&lt;WRAP box bggreen&gt;&lt;wrap info&gt;This specifies any shell prompt running on the target&lt;/wrap&gt;
&lt;xterm&gt;
root:/&gt; modprobe snd-pcm-oss
root:/&gt; tone
TONE: generating sine wave at 1000 Hz.…</p>
<p>root:/&gt; arecord -f cd | aplay
Recording WAVE ‘stdin’ : Signed 16 bit Little Endian, Rate 44100 Hz, Stereo
Playing WAVE ‘stdin’ : Signed 16 bit Little Endian, Rate 44100 Hz, Stereo
&lt;/xterm&gt;
&lt;/WRAP&gt;</p>
</section>
</section>
</section>


          </div>
              <div class="related">
                &nbsp;
    <a href="adau1372.html" title="Previous document" class="prev">ADAU1372 Sound CODEC Linux Driver</a>
    <a href="adau1381.html" title="Next document" class="next">ADAU1781 Sound CODEC Linux Driver</a>
              </div>
          
        </div>
      </div>
  </div>

  <div id="vertical-border"></div>

  <label id="cancel-area-show-toc" for="input-show-toc"></label>
  <label id="cancel-area-show-localtoc" for="input-show-localtoc"></label>

  
  <form action="" method="get" class="search-area">
    <input type="text" name="q" aria-labelledby="search-documentation" value="" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="search" placeholder="Search"/>
    <button value="search"></button>
    <span id="search-progress"></span>
  </form>
  
    <footer>
      &#169;2024, Analog Devices, Inc.
      
      |
      Made with <a href="https://www.sphinx-doc.org/">Sphinx</a>
      &amp; <a href="https://github.com/analogdevicesinc/doctools">Doctools</a>
      
    </footer>
  </body>
</html>