<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>ADP5520/01 MFD Linux Driver &#8212; Linux Kernel: Variant from Analog Devices, Inc. v6.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=8e8a900e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/style.min.css?v=cf8483f0" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    <script src="../../../_static/documentation_options.js?v=cb43cce9"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/tabs.js?v=3ee01567"></script>
    <script defer="" src="../../../_static/app.umd.js?v=96350458"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="ADP5589 Input Keyboard and GPIO Linux Driver" href="../input-keyboard/adp5589.html" />
    <link rel="prev" title="ADP1650 LED Flash Linux Driver" href="../leds/adp1650.html" />
   
  
    <meta name="robots" content="noindex">
  
  


<style>
  body {
    
  }

  body.dark {
    
  }

  @media (prefers-color-scheme: dark) {
    body:not(.light) {
      
    }
  }
</style>
  </head><body>
  <input type="checkbox" id="input-show-toc">
  <input type="checkbox" id="input-show-localtoc">
  <header>
    <div class="header">
      <div id="left">
        <label id="show-sidebar" for="input-show-toc" title="Show/hide index"></label>
      </div>
      <div id="right">
        <span>
          <a id="logo-org" href="https://analog.com"></a>
              <a id="no-logo" href="../../../index.html">
                Linux Kernel: Variant from Analog Devices, Inc.
              </a>
        </span>
        <span class="reverse">
          <label id="show-localtoc" for="input-show-localtoc" title="Show/hide contents"></label>
        </span>
      </div>
    </div>
    <div class="repotoc-tree">
      <root>
  <a href="../../../../documentation/eval/index.html">Evaluation Boards</a>
  <a href="../../../../documentation/university/index.html">University Program</a>
  <a href="../../../../hdl/index.html">HDL</a>
  <a href="../../../../no-OS/index.html">no-OS</a>
  <a href="../../../../pyadi-iio/index.html">pyadi-iio</a>
  <a href="../../../../precision-converters-firmware/index.html">Precision Converters Firmware</a>
  <a href="../../../../PrecisionToolbox/index.html">Precision Toolbox</a>
</root>

    </div>
  </header>

    <div class="localtoc">
      <div class="tocwrapper">
        <div>
          <div class="localtoc-header">On this page</div>
          <a id="scroll-up" href="#top-anchor" title="Back to top"></a>
        </div>
        <nav>
          <ul>
<li><a class="reference internal" href="#">ADP5520/01 MFD Linux Driver</a><ul>
<li><a class="reference internal" href="#supported-devices">Supported Devices</a></li>
<li><a class="reference internal" href="#evaluation-boards">Evaluation Boards</a></li>
<li><a class="reference internal" href="#description">Description</a></li>
<li><a class="reference internal" href="#core">Core</a></li>
<li><a class="reference internal" href="#resources">Resources</a></li>
<li><a class="reference internal" href="#configuration">Configuration</a></li>
<li><a class="reference internal" href="#software-configurable-features">Software configurable features</a></li>
<li><a class="reference internal" href="#source-code">Source Code</a><ul>
<li><a class="reference internal" href="#status">Status</a></li>
<li><a class="reference internal" href="#files">Files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-platform-device-initialization">Example platform device initialization</a><ul>
<li><a class="reference internal" href="#backlight">Backlight</a></li>
<li><a class="reference internal" href="#led">LED</a></li>
<li><a class="reference internal" href="#gpio">GPIO</a></li>
<li><a class="reference internal" href="#keypad">Keypad</a></li>
<li><a class="reference internal" href="#adp5520-adp5501-mfd-core-support">ADP5520/ADP5501 MFD Core Support</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adding-linux-driver-support">Adding Linux driver support</a><ul>
<li><a class="reference internal" href="#adp5520-mfd-core-support">ADP5520 MFD Core Support</a></li>
<li><a class="reference internal" href="#id1">Backlight</a></li>
<li><a class="reference internal" href="#id2">LED</a></li>
<li><a class="reference internal" href="#id3">GPIO</a></li>
<li><a class="reference internal" href="#id4">Keypad</a></li>
</ul>
</li>
<li><a class="reference internal" href="#hardware-configuration">Hardware configuration</a></li>
<li><a class="reference internal" href="#driver-testing">Driver testing</a><ul>
<li><a class="reference internal" href="#id5">Backlight</a></li>
<li><a class="reference internal" href="#id6">LED</a></li>
<li><a class="reference internal" href="#id7">GPIO</a></li>
<li><a class="reference internal" href="#id8">Keypad</a></li>
</ul>
</li>
<li><a class="reference internal" href="#more-information">More Information</a></li>
</ul>
</li>
</ul>

        </nav>
      </div>
    </div>

  
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
              <a id="no-logo" href="../../../index.html">
                Linux Kernel: Variant from Analog Devices, Inc.
              </a><input id="input-switch-toc" type="checkbox">
<label id="show-repotoc" for="input-switch-toc">
All content
</label>
<label id="show-toc" for="input-switch-toc">
Content on this topic
</label>
<div class="repotoc-tree">
  <root>
  <a href="../../../../documentation/eval/index.html">Evaluation Boards</a>
  <a href="../../../../documentation/university/index.html">University Program</a>
  <a href="../../../../hdl/index.html">HDL</a>
  <a href="../../../../no-OS/index.html">no-OS</a>
  <a href="../../../../pyadi-iio/index.html">pyadi-iio</a>
  <a href="../../../../precision-converters-firmware/index.html">Precision Converters Firmware</a>
  <a href="../../../../PrecisionToolbox/index.html">Precision Toolbox</a>
</root>

</div>
<div class="toc-tree">
  <html>
  <body><ul class="current">
<li class="toctree-l1 current"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-1" id="toctree-collapse-1" checked=""/><div class="collapse"><a class="reference internal" href="../../../drivers_index.html">Linux Drivers</a><label for="toctree-collapse-1"><div class="icon"></div></label></div><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../sound/ad1835a.html">AD1835A</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/ad1936.html">AD1933</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-resolver/ad2s1200.html">AD2S1200</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-resolver/ad2s1210.html">AD2S1210</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-resolver/ad2s90.html">AD2S90</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/axi-ad3552r.html">AD3552R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad400x.html">AD4003</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad4630.html">AD4030-24</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5064.html">AD5024</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc/dpot.html">AD5160</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5446.html">AD5300</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5676.html">AD5310R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5360.html">AD5360</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5380.html">AD5380</a></li>
<li class="toctree-l2"><a class="reference internal" href="../regulator/ad5398.html">AD5398</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5449.html">AD5415</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5421.html">AD5421</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5504.html">AD5501</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5592r.html">AD5592R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5593r.html">AD5593R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5624r.html">AD5624</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5755.html">AD5735</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5764.html">AD5744</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5758.html">AD5758</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5791.html">AD5760</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ad5770r.html">AD5770R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-impedance-analyzer/ad5933.html">AD5933</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad6676.html">AD6676</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad9208.html">AD6684</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7476a.html">AD7091</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7091r5.html">AD7091R-5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7091r8.html">AD7091R-8</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7124.html">AD7124-4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-misc/ad714x.html">AD7142</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-cdc/ad7150.html">AD7150</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-cdc/ad7152.html">AD7152</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7780.html">AD7170</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7192.html">AD7190</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7266.html">AD7265</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7280a.html">AD7280A</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7291.html">AD7291</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7298.html">AD7298</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/ad73322.html">AD73311</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad738x.html">AD7380</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-addac/ad74413r.html">AD74412R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7606.html">AD7605-4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-cdc/ad7745.html">AD7745</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7766.html">AD7766-1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7768-1.html">AD7768-1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7768.html">AD7768</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7793.html">AD7785</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7791.html">AD7787</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-touchscreen/ad7873.html">AD7843</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-touchscreen/ad7877.html">AD7877</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-touchscreen/ad7879.html">AD7879-1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7887.html">AD7887</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad7998.html">AD7991</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-amplifiers/ad8366.html">AD8366</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-mxfe/ad9081.html">AD9081</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/ad9083.html">AD9083</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dds/axi-dac-dds-hdl.html">AD9122</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ad9162.html">AD9161</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../resources/tools-software/linux-drivers/iio-adc/ad9208.html">AD9208</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/axi-adc-hdl.html">AD9234</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-transceiver/ad9361.html">AD9361</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-transceiver/ad9371.html">AD9371</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ad9508.html">AD9508</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ad9517.html">AD9516-0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ad9523.html">AD9523-1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ad9528.html">AD9528</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clk/adi/clk-ad9545.c.html">AD9545</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dds/ad9832.html">AD9832</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dds/ad9834.html">AD9833</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-amplifiers/ada4250.html">ADA4250</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/adaq8092.html">ADAQ8092</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-transceiver/adar1000.html">ADAR1000</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-adc/adas1000.html">ADAS1000</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/adau1361.html">ADAU1361</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/adau1372.html">ADAU1372</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/adau1373.html">ADAU1373</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/adau1381.html">ADAU1381</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/adau1701.html">ADAU1401</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/adau1977.html">ADAU1977</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/adau7002.html">ADAU7002</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/adau7118.html">ADAU7118</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/adav801.html">ADAV801</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf4159.html">ADF4159</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf4350.html">ADF4350</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf5355.html">ADF4355-2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf4360.html">ADF4360-0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf4371.html">ADF4371</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adf4377.html">ADF4377</a></li>
<li class="toctree-l2"><a class="reference internal" href="../networking-mac802154/adf7242.html">ADF7241</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mux/adgs1408.html">ADGS1408</a></li>
<li class="toctree-l2"><a class="reference internal" href="../net-phy/adin1100.html">ADIN1100</a></li>
<li class="toctree-l2"><a class="reference internal" href="../net-mac-phy/adin1110.html">ADIN1110</a></li>
<li class="toctree-l2"><a class="reference internal" href="../net-phy/adin.html">ADIN1200</a></li>
<li class="toctree-l2"><a class="reference internal" href="../net-mac-phy/adin2111.html">ADIN2111</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adis16060.html">ADIS16060</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adis16080.html">ADIS16080</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adis16130.html">ADIS16130</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adis16136.html">ADIS16133</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adis16201.html">ADIS16201</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adis16203.html">ADIS16203</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adis16209.html">ADIS16209</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adis16240.html">ADIS16240</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adis16260.html">ADIS16250</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-inertial-measurement-units/adis16400.html">ADIS16300</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-inertial-measurement-units/adis16480.html">ADIS16375</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-inertial-measurement-units/adis16475.html">ADIS16460</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-vector-power/adl5960.html">ADL5960</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/admv1013.html">ADMV1013</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/admv1014.html">ADMV1014</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-filter/admv8818.html">ADMV8818</a></li>
<li class="toctree-l2"><a class="reference internal" href="../regulator/adp150.html">ADP122</a></li>
<li class="toctree-l2"><a class="reference internal" href="../leds/adp1650.html">ADP1650</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">ADP5501</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-keyboard/adp5589.html">ADP5585</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-keyboard/adp5588.html">ADP5587</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backlight/adp8860.html">ADP8860</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backlight/adp8870.html">ADP8870</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/adrf6780.html">ADRF6780</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-transceiver/adrv9002.html">ADRV9002</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-transceiver/adrv9009.html">ADRV9008-1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../drm/adv7511.html">ADV7511</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adxl313.html">ADXL312,</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-misc/adxl345.html">ADXL345</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adxl355.html">ADXL355</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input-misc/adxl362.html">ADXL362</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adxl367.html">ADXL367</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-accelerometer/adxl372.html">ADXL372</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-gyroscope/adxrs450.html">ADXRS450</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hwmon/axi_fan_control.html">Fan Control IP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-amplifiers/hmc425a.html">HMC425</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/hmc7044.html">HMC7043</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-dac/ltc2664.html">LTC2664</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hwmon/ltc2947.html">LTC2947</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-temperature/ltc2983.html">LTC2983</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio-pll/ltc6952.html">LTC6952</a></li>
<li class="toctree-l2"><a class="reference internal" href="../serial/max310x.html">MAX14830</a></li>
<li class="toctree-l2"><a class="reference internal" href="../net-mac-phy/open_alliance.html">Open Alliance - 10BASE-T1x MAC-PHY Serial Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/ssm2602.html">SSM2602</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/ssm4567.html">SSM4567</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../guides/build.html">Building Kernels</a></li>
</ul>
</body>
</html>

</div>
        </div>
      </div>

  <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper" id="top-anchor">
          <div class="body" role="main">
            
  <section class="tex2jax_ignore mathjax_ignore" id="adp5520-01-mfd-linux-driver">
<h1>ADP5520/01 MFD Linux Driver<a class="headerlink" href="#adp5520-01-mfd-linux-driver" title="Link to this heading">¶</a></h1>
<section id="supported-devices">
<h2>Supported Devices<a class="headerlink" href="#supported-devices" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://analog.com/ADP5520">ADP5520</a></p></li>
<li><p><a class="reference external" href="https://analog.com/ADP5501">ADP5501</a></p></li>
</ul>
</section>
<section id="evaluation-boards">
<h2>Evaluation Boards<a class="headerlink" href="#evaluation-boards" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://analog.com/ADP5520-EVALZ">ADP5520-EVALZ</a></p></li>
</ul>
</section>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<p>The ADP5520/01 driver utilizes several Linux device-driver subsystems and provides
various software interfaces. It is therefore implemented as a multifunction device (MFD).
In this particular case the ADP5520 backlight driver and I/O expander, concurrently
leverages the Linux backlight, LED, GPIO, and input subsystems for its keypad functionality.</p>
<!-- ATTRS: dot="" 650x200="" -->
<div class="graphviz"><img src="../../../_images/graphviz-256ed97fcafe45fc3e49cfb4d60494fddc584ef4.png" alt="digraph {
size=&quot;8,5&quot;
ADP5520_MFD_CORE [shape=box]
ADP5520_BACKLIGHT [shape=box]
ADP5520_GPIO[shape=box]
ADP5520_LED [shape=box]
ADP5520_KEYPAD [shape=box]
ADP5520_MFD_CORE -&gt; ADP5520_BACKLIGHT [dir=none];
ADP5520_MFD_CORE -&gt; ADP5520_LED [dir=none];
ADP5520_MFD_CORE -&gt; ADP5520_GPIO [dir=none];
ADP5520_MFD_CORE -&gt; ADP5520_KEYPAD [dir=none];
}" class="graphviz" /></div>
</section>
<section id="core">
<h2>Core<a class="headerlink" href="#core" title="Link to this heading">¶</a></h2>
<p>The ADP5520/01 core driver in drivers/mfd provides common services for the
subsystem drivers. These services include register access, control and shared interrupt management.</p>
<p>The core registers/enumerates platform devices for the various subsystems
via the platform device and driver system.</p>
<p>When a platform driver for one of the subsystems is instantiated,
the core initializes the chip (which may be specified by the platform data).</p>
<p>The ADP5520/01 platform drivers follow the standard driver model convention, where
discovery/enumeration is handled outside the drivers, and drivers
provide probe() and remove() methods.</p>
</section>
<section id="resources">
<h2>Resources<a class="headerlink" href="#resources" title="Link to this heading">¶</a></h2>
<p>Each peripheral (subsystem device) has a view of the device which is implicitly narrowed to
the specific set of resources that peripheral requires in order to
function correctly.</p>
</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Link to this heading">¶</a></h2>
<p>The device driver uses a set of platform data to pass
configurations through to the core and the subsidiary drivers
so that there can be support for multiple ADP5520/01 devices
built into a single kernel image.</p>
</section>
<section id="software-configurable-features">
<h2>Software configurable features<a class="headerlink" href="#software-configurable-features" title="Link to this heading">¶</a></h2>
<p>Backlight:</p>
<ul class="simple">
<li><p>Ambient Light Sensor Support</p></li>
<li><p>Configurable Fade On/Off times</p></li>
<li><p>Configurable Brightness/Intensity in 127 steps</p></li>
</ul>
<p>LED:</p>
<ul class="simple">
<li><p>Up to 3 LEDs configurable</p></li>
<li><p>Configurable Fade On/Off times</p></li>
<li><p>LED Blink On/Off times</p></li>
<li><p>Configurable Brightness/Intensity in 64 steps from [0…255]</p></li>
</ul>
<p>Keypad:</p>
<ul class="simple">
<li><p>Configurable keypad size matrix (rows, columns) up to 16 keys</p></li>
<li><p>Enabling and disabling automatic key repeat feature.</p></li>
</ul>
<p>GPIO:</p>
<ul class="simple">
<li><p>Configurable number of dedicated GPIOs, up to 8 GPIOs</p></li>
<li><p>Configurable Pull-Ups</p></li>
</ul>
</section>
<section id="source-code">
<h2>Source Code<a class="headerlink" href="#source-code" title="Link to this heading">¶</a></h2>
<section id="status">
<h3>Status<a class="headerlink" href="#status" title="Link to this heading">¶</a></h3>
<table>
<thead>
<tr class="header">
<th>Source</th>
<th>Mainlined?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="git.linux.org&gt;drivers/mfd/adp5520.c">git</a></td>
<td><a href="git.linux.org&gt;drivers/mfd/adp5520.c">Yes</a></td>
</tr>
</tbody>
</table>
</section>
<section id="files">
<h3>Files<a class="headerlink" href="#files" title="Link to this heading">¶</a></h3>
<table>
<thead>
<tr class="header">
<th>Function</th>
<th>File</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>MFD-CORE</td>
<td><a href="git.linux.org&gt;drivers/mfd/adp5520.c">drivers/mfd/adp5520.c</a></td>
</tr>
<tr class="even">
<td>include</td>
<td><a href="git.linux.org&gt;include/linux/mfd/adp5520.h">include/linux/mfd/adp5520.h</a></td>
</tr>
<tr class="odd">
<td>BACKLIGHT</td>
<td><a href="git.linux.org&gt;drivers/video/backlight/adp5520_bl.c">drivers/video/backlight/adp5520_bl.c</a></td>
</tr>
<tr class="even">
<td>LED</td>
<td><a href="git.linux.org&gt;drivers/led/leds-adp5520.c">drivers/led/leds-adp5520.c</a></td>
</tr>
<tr class="odd">
<td>GPIO</td>
<td><a href="git.linux.org&gt;drivers/gpio/adp5520-gpio.c">drivers/gpio/adp5520-gpio.c</a><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></td>
</tr>
<tr class="even">
<td>KEYPAD</td>
<td><a href="git.linux.org&gt;drivers/input/keyboard/adp5520-keys.c">drivers/input/keyboard/adp5520-keys.c</a><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></td>
</tr>
</tbody>
</table>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>ADP5520 only<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>ADP5520 only<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
</section>
</section>
<section id="example-platform-device-initialization">
<h2>Example platform device initialization<a class="headerlink" href="#example-platform-device-initialization" title="Link to this heading">¶</a></h2>
<!-- CMDS: noheader firstseconly noeditbtn -->
<div class="admonition note">
<p class="admonition-title">Note</p>
<!-- ATTRS: important="" -->
<p>Since Keypad, GPIO and optional LEDs (2, 3) are multiplexed, you need to avoid double configurations. Please refer to the table below.</p>
</div>
<table>
<thead>
<tr class="header">
<th>ADP5520 PIN</th>
<th>R3</th>
<th>R2</th>
<th>R1</th>
<th>R0</th>
<th>C0</th>
<th>C1</th>
<th>C2</th>
<th>C3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>GPIO</strong></td>
<td>GPIO_R3</td>
<td>GPIO_R2</td>
<td>GPIO_R1</td>
<td>GPIO_R0</td>
<td>GPIO_C0</td>
<td>GPIO_C1</td>
<td>GPIO_C2</td>
<td>GPIO_C3</td>
</tr>
<tr class="even">
<td><strong>Keypad</strong></td>
<td>ROW_R3</td>
<td>ROW_R2</td>
<td>ROW_R1</td>
<td>ROW_R0</td>
<td>COL_C0</td>
<td>COL_C1</td>
<td>COL_C2</td>
<td>COL_C3</td>
</tr>
<tr class="odd">
<td><strong>LED</strong></td>
<td>LED3</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>LED2</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<!-- ATTRS: tip="" -->
<p>Please refer to <a class="reference external" href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/mfd/adp5520.h">include/linux/mfd/adp5520.h</a> for detailed configuration defines.</p>
</div>
<section id="backlight">
<h3>Backlight<a class="headerlink" href="#backlight" title="Link to this heading">¶</a></h3>
<source trunk/arch/blackfin/mach-bf537/boards/stamp.c:adp5520_backlight_data{} c linux-kernel>
</section>
<section id="led">
<h3>LED<a class="headerlink" href="#led" title="Link to this heading">¶</a></h3>
<source trunk/arch/blackfin/mach-bf537/boards/stamp.c:adp5520_leds[] c linux-kernel>
<source trunk/arch/blackfin/mach-bf537/boards/stamp.c:adp5520_leds_data{} c linux-kernel>
</section>
<section id="gpio">
<h3>GPIO<a class="headerlink" href="#gpio" title="Link to this heading">¶</a></h3>
<source trunk/arch/blackfin/mach-bf537/boards/stamp.c:adp5520_gpio_data{} c linux-kernel>
</section>
<section id="keypad">
<h3>Keypad<a class="headerlink" href="#keypad" title="Link to this heading">¶</a></h3>
<source trunk/arch/blackfin/mach-bf537/boards/stamp.c:adp5520_keymap[] c linux-kernel>
<source trunk/arch/blackfin/mach-bf537/boards/stamp.c:adp5520_keys_data{} c linux-kernel>
</section>
<section id="adp5520-adp5501-mfd-core-support">
<h3>ADP5520/ADP5501 MFD Core Support<a class="headerlink" href="#adp5520-adp5501-mfd-core-support" title="Link to this heading">¶</a></h3>
<!-- CMDS: firstseconly noeditbtn -->
<source trunk/arch/blackfin/mach-bf537/boards/stamp.c:adp5520_pdev_data{} c linux-kernel>
<source trunk/arch/blackfin/mach-bf537/boards/stamp.c:/CONFIG_PMIC_ADP5520/2-/#if/ c linux-kernel>
<div class="admonition note">
<p class="admonition-title">Note</p>
<!-- ATTRS: tip="" -->
<p><strong>ADP5520 IRQ Usage:</strong>
If you aren’t planning to utilize the Keypad interface, you don’t need to specify an IRQ in bfin_i2c_board_info.</p>
</div>
</section>
</section>
<section id="adding-linux-driver-support">
<h2>Adding Linux driver support<a class="headerlink" href="#adding-linux-driver-support" title="Link to this heading">¶</a></h2>
<p>Fist of all you need to enable i2c support followed by the ADP5520 MFD Core Driver.
Then you may select individual components like LCD backlight, LEDs, GPIOs and Keypad under the corresponding menus.</p>
<section id="adp5520-mfd-core-support">
<h3>ADP5520 MFD Core Support<a class="headerlink" href="#adp5520-mfd-core-support" title="Link to this heading">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Device<span class="w"> </span>Drivers<span class="w"> </span>---&gt;

<span class="w">      </span>&lt;*&gt;<span class="w"> </span>I2C<span class="w"> </span>support<span class="w">  </span>---&gt;
<span class="w">          </span>&lt;*&gt;<span class="w"> </span>Blackfin<span class="w"> </span>TWI<span class="w"> </span>I2C<span class="w"> </span>support
<span class="w">          </span>Or:
<span class="w">          </span>&lt;*&gt;<span class="w"> </span>GPIO-based<span class="w"> </span>bitbanging<span class="w"> </span>I2C

Device<span class="w"> </span>Drivers<span class="w"> </span>---&gt;

<span class="w">      </span>Multifunction<span class="w"> </span>device<span class="w"> </span>drivers<span class="w">  </span>---&gt;
<span class="w">          </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Analog<span class="w"> </span>Devices<span class="w"> </span>ADP5520/01<span class="w"> </span>MFD<span class="w"> </span>PMIC<span class="w"> </span>Core<span class="w"> </span>Support
</pre></div>
</div>
</section>
<section id="id1">
<h3>Backlight<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Device<span class="w"> </span>Drivers<span class="w"> </span>---&gt;

<span class="w">      </span>Graphics<span class="w"> </span>support<span class="w">  </span>---&gt;
<span class="w">          </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Backlight<span class="w"> </span><span class="p">&amp;</span><span class="w"> </span>LCD<span class="w"> </span>device<span class="w"> </span>support<span class="w">  </span>---&gt;
<span class="w">              </span>&lt;*&gt;<span class="w">   </span>Lowlevel<span class="w"> </span>Backlight<span class="w"> </span>controls
<span class="w">              </span>&lt;M&gt;<span class="w">     </span>Backlight<span class="w"> </span>Driver<span class="w"> </span><span class="k">for</span><span class="w"> </span>ADP5520/ADP5501<span class="w"> </span>using<span class="w"> </span>WLED
</pre></div>
</div>
</section>
<section id="id2">
<h3>LED<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Device<span class="w"> </span>Drivers<span class="w"> </span>---&gt;

<span class="w">      </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>LED<span class="w"> </span>Support<span class="w">  </span>---&gt;
<span class="w">          </span>&lt;*&gt;<span class="w">   </span>LED<span class="w"> </span>Class<span class="w"> </span>Support
<span class="w">          </span>&lt;M&gt;<span class="w">   </span>LED<span class="w"> </span>Support<span class="w"> </span><span class="k">for</span><span class="w"> </span>ADP5520/ADP5501<span class="w"> </span>PMIC
</pre></div>
</div>
</section>
<section id="id3">
<h3>GPIO<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Device<span class="w"> </span>Drivers<span class="w"> </span>---&gt;

<span class="w">      </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>GPIO<span class="w"> </span>Support<span class="w">  </span>---&gt;
<span class="w">          </span><span class="o">[</span>*<span class="o">]</span><span class="w">   </span>/sys/class/gpio/...<span class="w"> </span><span class="o">(</span>sysfs<span class="w"> </span>interface<span class="o">)</span>
<span class="w">          </span>&lt;M&gt;<span class="w">   </span>GPIO<span class="w"> </span>Support<span class="w"> </span><span class="k">for</span><span class="w"> </span>ADP5520<span class="w"> </span>PMIC
</pre></div>
</div>
</section>
<section id="id4">
<h3>Keypad<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Device<span class="w"> </span>Drivers<span class="w"> </span>---&gt;

<span class="w">      </span>Input<span class="w"> </span>device<span class="w"> </span>support<span class="w">  </span>---&gt;
<span class="w">          </span>&lt;*&gt;<span class="w"> </span>Generic<span class="w"> </span>input<span class="w"> </span>layer<span class="w"> </span><span class="o">(</span>needed<span class="w"> </span><span class="k">for</span><span class="w"> </span>keyboard,<span class="w"> </span>mouse,<span class="w"> </span>...<span class="o">)</span>
<span class="w">          </span>&lt;*&gt;<span class="w">   </span>Event<span class="w"> </span>interface
<span class="w">          </span><span class="o">[</span>*<span class="o">]</span><span class="w">   </span>Keyboards<span class="w">  </span>---&gt;
<span class="w">              </span>&lt;M&gt;<span class="w">   </span>Keypad<span class="w"> </span>Support<span class="w"> </span><span class="k">for</span><span class="w"> </span>ADP5520<span class="w"> </span>PMIC
</pre></div>
</div>
</section>
</section>
<section id="hardware-configuration">
<h2>Hardware configuration<a class="headerlink" href="#hardware-configuration" title="Link to this heading">¶</a></h2>
<a class="reference internal image-reference" href="../../../_images/adp5520_brd.jpg"><img alt="ADP5520 Demo Mother/Daughter Board" src="../../../_images/adp5520_brd.jpg" style="width: 800px;" />
</a>
<p>There is no dedicated Blackfin STAMP evaluation board for the ADP5520.
During test and driver development we used the ADP5520 Demo Mother/Daughter Board.
Connect the ADP5520 Demo Mother to an USB port.</p>
<p>It can be easily wired to the Blackfin STAMP TWI/I2C header.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">BF537-STAMP (P10) TWI/I2C header</th>
<th></th>
<th>ADP5520 Daughter Board</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PIN</td>
<td>Function</td>
<td>PIN/Function</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td>SCL</td>
<td>SCL</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td>SDA</td>
<td>SDA</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td>GPIO_PG0</td>
<td>nINT</td>
</tr>
<tr class="odd">
<td style="text-align: left;">20</td>
<td>GND</td>
<td>GND</td>
</tr>
</tbody>
</table>
</section>
<section id="driver-testing">
<h2>Driver testing<a class="headerlink" href="#driver-testing" title="Link to this heading">¶</a></h2>
<section id="id5">
<h3>Backlight<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>root:/&gt;<span class="w"> </span>**modprobe<span class="w"> </span>adp5520_bl**
root:/&gt;

root:/&gt;<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>sys/class/backlight/adp5520-backlight/
root:/sys/devices/platform/i2c-bfin-twi.0/i2c-adapter/i2c-0/0-0032/backlight/adp5520-backlight&gt;<span class="w"> </span>ls<span class="w"> </span>-l
-r--r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span>:31<span class="w"> </span>actual_brightness
-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span>:31<span class="w"> </span>bl_power
-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span>:31<span class="w"> </span>brightness
-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span>:31<span class="w"> </span>dark_dim
-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span>:31<span class="w"> </span>dark_max
-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span>:31<span class="w"> </span>daylight_dim
-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span>:31<span class="w"> </span>daylight_max
lrwxrwxrwx<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">0</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span>:31<span class="w"> </span>device<span class="w"> </span>-&gt;<span class="w"> </span>../../../0-0032
-r--r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span>:31<span class="w"> </span>max_brightness
-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span>:31<span class="w"> </span>office_dim
-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span>:31<span class="w"> </span>office_max
drwxr-xr-x<span class="w"> </span><span class="m">2</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">0</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span>:31<span class="w"> </span>power
lrwxrwxrwx<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">0</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span>:31<span class="w"> </span>subsystem<span class="w"> </span>-&gt;<span class="w"> </span>../../../../../../../../class/backlight

root:/sys/devices/platform/i2c-bfin-twi.0/i2c-adapter/i2c-0/0-0032/backlight/adp5520-backlight&gt;<span class="w"> </span>**echo<span class="w"> </span><span class="m">127</span><span class="w"> </span>&gt;<span class="w"> </span>brightness**
root:/sys/devices/platform/i2c-bfin-twi.0/i2c-adapter/i2c-0/0-0032/backlight/adp5520-backlight&gt;<span class="w"> </span>**echo<span class="w"> </span><span class="m">50</span><span class="w"> </span>&gt;<span class="w"> </span>brightness**
root:/sys/devices/platform/i2c-bfin-twi.0/i2c-adapter/i2c-0/0-0032/backlight/adp5520-backlight&gt;<span class="w"> </span>**echo<span class="w"> </span><span class="m">0</span><span class="w"> </span>&gt;<span class="w"> </span>brightness**
</pre></div>
</div>
<p><em><strong>For more information on Backlight handling in Linux read:</strong></em> <a class="reference external" href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/ABI/stable/sysfs-class-backlight">Documentation/ABI/stable/sysfs-class-backlight</a></p>
</section>
<section id="id6">
<h3>LED<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>root:/&gt;<span class="w"> </span>**modprobe<span class="w"> </span>leds-adp5520**
Registered<span class="w"> </span>led<span class="w"> </span>device:<span class="w"> </span>adp5520-led1
Registered<span class="w"> </span>led<span class="w"> </span>device:<span class="w"> </span>adp5520-led2
Registered<span class="w"> </span>led<span class="w"> </span>device:<span class="w"> </span>adp5520-led3

root:/&gt;<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>sys/class/leds/adp5520-led
sys/class/leds/adp5520-led1/<span class="w"> </span>sys/class/leds/adp5520-led3/
sys/class/leds/adp5520-led2/

root:/&gt;<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>sys/class/leds/adp5520-led1
root:/sys/devices/platform/i2c-bfin-twi.0/i2c-adapter/i2c-0/0-0032/leds/adp5520-led1&gt;<span class="w"> </span>ls<span class="w"> </span>-l
-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span>:34<span class="w"> </span>brightness
lrwxrwxrwx<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">0</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span>:34<span class="w"> </span>device<span class="w"> </span>-&gt;<span class="w"> </span>../../../0-0032
drwxr-xr-x<span class="w"> </span><span class="m">2</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">0</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span>:34<span class="w"> </span>power
lrwxrwxrwx<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">0</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span>:34<span class="w"> </span>subsystem<span class="w"> </span>-&gt;<span class="w"> </span>../../../../../../../../class/leds
-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span>:34<span class="w"> </span>trigger
root:/sys/devices/platform/i2c-bfin-twi.0/i2c-adapter/i2c-0/0-0032/leds/adp5520-led1&gt;<span class="w"> </span>**echo<span class="w"> </span><span class="m">10</span><span class="w"> </span>&gt;<span class="w"> </span>brightness**
root:/sys/devices/platform/i2c-bfin-twi.0/i2c-adapter/i2c-0/0-0032/leds/adp5520-led1&gt;<span class="w"> </span>**echo<span class="w"> </span><span class="m">255</span><span class="w"> </span>&gt;<span class="w"> </span>brightness**
root:/sys/devices/platform/i2c-bfin-twi.0/i2c-adapter/i2c-0/0-0032/leds/adp5520-led1&gt;<span class="w"> </span>**echo<span class="w"> </span><span class="m">0</span><span class="w"> </span>&gt;<span class="w"> </span>brightness**

root:/&gt;<span class="w"> </span>**modprobe<span class="w"> </span>-r<span class="w"> </span>leds-adp5520**
root:/&gt;
</pre></div>
</div>
<p><em><strong>For more information on LEDs handling in Linux read:</strong></em> <a class="reference external" href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/leds-class.txt">Documentation/leds-class.txt</a></p>
</section>
<section id="id7">
<h3>GPIO<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>root:/&gt;<span class="w"> </span>**modprobe<span class="w"> </span>adp5520-gpio**
root:/&gt;<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>sys/class/gpio/gpiochip50/
root:/sys/devices/virtual/gpio/gpiochip50&gt;<span class="w"> </span>ls<span class="w"> </span>-l
-r--r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span>:37<span class="w"> </span>base
-r--r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span>:37<span class="w"> </span>label
-r--r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span>:37<span class="w"> </span>ngpio
drwxr-xr-x<span class="w"> </span><span class="m">2</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">0</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span>:37<span class="w"> </span>power
lrwxrwxrwx<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">0</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span>:37<span class="w"> </span>subsystem<span class="w"> </span>-&gt;<span class="w"> </span>../../../../class/gpio
-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span>:37<span class="w"> </span>uevent
root:/sys/devices/virtual/gpio/gpiochip50&gt;<span class="w"> </span><span class="nb">cd</span>
root:/&gt;
</pre></div>
</div>
<p>Note that you will have to enable the event_test utility under “Blackfin test programs” in your user space configuration.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p><em><strong>For more information on GPIO handling in Linux read:</strong></em> <a class="reference external" href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/gpio.txt">Documentation/gpio.txt</a></p>
</section>
<section id="id8">
<h3>Keypad<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>root:/&gt;<span class="w"> </span>**modprobe<span class="w"> </span>adp5520-keys**
input:<span class="w"> </span>adp5520-keys<span class="w"> </span>as<span class="w"> </span>/devices/platform/i2c-bfin-twi.0/i2c-adapter/i2c-0/0-0032/adp5520-keys.5520/input/input0

root:/&gt;<span class="w"> </span>**event_test<span class="w"> </span>/dev/input/event0**
Input<span class="w"> </span>driver<span class="w"> </span>version<span class="w"> </span>is<span class="w"> </span><span class="m">1</span>.0.0
Input<span class="w"> </span>device<span class="w"> </span>ID:<span class="w"> </span>bus<span class="w"> </span>0x18<span class="w"> </span>vendor<span class="w"> </span>0x1<span class="w"> </span>product<span class="w"> </span>0x5520<span class="w"> </span>version<span class="w"> </span>0x1
Input<span class="w"> </span>device<span class="w"> </span>name:<span class="w"> </span><span class="s2">&quot;adp5520-keys&quot;</span>
Supported<span class="w"> </span>events:

<span class="w">    </span>Event<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>Reset<span class="o">)</span>
<span class="w">      </span>Event<span class="w"> </span>code<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>Reset<span class="o">)</span>
<span class="w">      </span>Event<span class="w"> </span>code<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">(</span>Key<span class="o">)</span>
<span class="w">    </span>Event<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">(</span>Key<span class="o">)</span>
<span class="w">      </span>Event<span class="w"> </span>code<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="o">)</span>
<span class="w">      </span>Event<span class="w"> </span>code<span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">(</span><span class="m">2</span><span class="o">)</span>
<span class="w">      </span>Event<span class="w"> </span>code<span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="o">(</span><span class="m">3</span><span class="o">)</span>
<span class="w">      </span>Event<span class="w"> </span>code<span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="o">(</span><span class="m">4</span><span class="o">)</span>
<span class="w">      </span>Event<span class="w"> </span>code<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="o">(</span><span class="m">5</span><span class="o">)</span>
<span class="w">      </span>Event<span class="w"> </span>code<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="o">(</span><span class="m">6</span><span class="o">)</span>
<span class="w">      </span>Event<span class="w"> </span>code<span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="o">(</span><span class="m">7</span><span class="o">)</span>
<span class="w">      </span>Event<span class="w"> </span>code<span class="w"> </span><span class="m">9</span><span class="w"> </span><span class="o">(</span><span class="m">8</span><span class="o">)</span>
<span class="w">      </span>Event<span class="w"> </span>code<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="o">(</span><span class="m">9</span><span class="o">)</span>
<span class="w">      </span>Event<span class="w"> </span>code<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="o">(</span><span class="m">0</span><span class="o">)</span>
<span class="w">      </span>Event<span class="w"> </span>code<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="o">(</span>Minus<span class="o">)</span>
<span class="w">      </span>Event<span class="w"> </span>code<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="o">(</span>Equal<span class="o">)</span>
<span class="w">      </span>Event<span class="w"> </span>code<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="o">(</span>Enter<span class="o">)</span>
<span class="w">      </span>Event<span class="w"> </span>code<span class="w"> </span><span class="m">41</span><span class="w"> </span><span class="o">(</span>Grave<span class="o">)</span>
<span class="w">      </span>Event<span class="w"> </span>code<span class="w"> </span><span class="m">43</span><span class="w"> </span><span class="o">(</span>BackSlash<span class="o">)</span>

Testing<span class="w"> </span>...<span class="w"> </span><span class="o">(</span>interrupt<span class="w"> </span>to<span class="w"> </span><span class="nb">exit</span><span class="o">)</span>
Event:<span class="w"> </span><span class="nb">time</span><span class="w"> </span><span class="m">1415788674</span>.340000,<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">(</span>Key<span class="o">)</span>,<span class="w"> </span>code<span class="w"> </span><span class="m">41</span><span class="w"> </span><span class="o">(</span>Grave<span class="o">)</span>,<span class="w"> </span>value<span class="w"> </span><span class="m">1</span>
Event:<span class="w"> </span><span class="nb">time</span><span class="w"> </span><span class="m">1415788674</span>.340000,<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>Reset<span class="o">)</span>,<span class="w"> </span>code<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>Reset<span class="o">)</span>,<span class="w"> </span>value<span class="w"> </span><span class="m">0</span>
Event:<span class="w"> </span><span class="nb">time</span><span class="w"> </span><span class="m">1415788674</span>.516000,<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">(</span>Key<span class="o">)</span>,<span class="w"> </span>code<span class="w"> </span><span class="m">41</span><span class="w"> </span><span class="o">(</span>Grave<span class="o">)</span>,<span class="w"> </span>value<span class="w"> </span><span class="m">0</span>
Event:<span class="w"> </span><span class="nb">time</span><span class="w"> </span><span class="m">1415788674</span>.516000,<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>Reset<span class="o">)</span>,<span class="w"> </span>code<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>Reset<span class="o">)</span>,<span class="w"> </span>value<span class="w"> </span><span class="m">0</span>
Event:<span class="w"> </span><span class="nb">time</span><span class="w"> </span><span class="m">1415788674</span>.912000,<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">(</span>Key<span class="o">)</span>,<span class="w"> </span>code<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="o">)</span>,<span class="w"> </span>value<span class="w"> </span><span class="m">1</span>
Event:<span class="w"> </span><span class="nb">time</span><span class="w"> </span><span class="m">1415788674</span>.912000,<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>Reset<span class="o">)</span>,<span class="w"> </span>code<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>Reset<span class="o">)</span>,<span class="w"> </span>value<span class="w"> </span><span class="m">0</span>
Event:<span class="w"> </span><span class="nb">time</span><span class="w"> </span><span class="m">1415788675</span>.140000,<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">(</span>Key<span class="o">)</span>,<span class="w"> </span>code<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="o">)</span>,<span class="w"> </span>value<span class="w"> </span><span class="m">0</span>
Event:<span class="w"> </span><span class="nb">time</span><span class="w"> </span><span class="m">1415788675</span>.140000,<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>Reset<span class="o">)</span>,<span class="w"> </span>code<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>Reset<span class="o">)</span>,<span class="w"> </span>value<span class="w"> </span><span class="m">0</span>
Event:<span class="w"> </span><span class="nb">time</span><span class="w"> </span><span class="m">1415788675</span>.892000,<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">(</span>Key<span class="o">)</span>,<span class="w"> </span>code<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="o">(</span><span class="m">5</span><span class="o">)</span>,<span class="w"> </span>value<span class="w"> </span><span class="m">1</span>
Event:<span class="w"> </span><span class="nb">time</span><span class="w"> </span><span class="m">1415788675</span>.892000,<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>Reset<span class="o">)</span>,<span class="w"> </span>code<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>Reset<span class="o">)</span>,<span class="w"> </span>value<span class="w"> </span><span class="m">0</span>
Event:<span class="w"> </span><span class="nb">time</span><span class="w"> </span><span class="m">1415788676</span>.092000,<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">(</span>Key<span class="o">)</span>,<span class="w"> </span>code<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="o">(</span><span class="m">5</span><span class="o">)</span>,<span class="w"> </span>value<span class="w"> </span><span class="m">0</span>
Event:<span class="w"> </span><span class="nb">time</span><span class="w"> </span><span class="m">1415788676</span>.092000,<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>Reset<span class="o">)</span>,<span class="w"> </span>code<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>Reset<span class="o">)</span>,<span class="w"> </span>value<span class="w"> </span><span class="m">0</span>

root:/&gt;<span class="w"> </span>**modprobe<span class="w"> </span>-r<span class="w"> </span>adp5520-keys**
root:/&gt;
</pre></div>
</div>
<p><em><strong>For more information on Input handling in Linux read:</strong></em> <a class="reference external" href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/input/input.txt">Documentation/input/input.txt</a></p>
</section>
</section>
<section id="more-information">
<h2>More Information<a class="headerlink" href="#more-information" title="Link to this heading">¶</a></h2>
<!-- CMDS: noheader firstseconly noeditbtn -->
</section>
</section>


          </div>
              <div class="related">
                &nbsp;
    <a href="../leds/adp1650.html" title="Previous document" class="prev">ADP1650 LED Flash Linux Driver</a>
    <a href="../input-keyboard/adp5589.html" title="Next document" class="next">ADP5589 Input Keyboard and GPIO Linux Driver</a>
              </div>
          
        </div>
      </div>
  </div>

  <div id="vertical-border"></div>

  <label id="cancel-area-show-toc" for="input-show-toc"></label>
  <label id="cancel-area-show-localtoc" for="input-show-localtoc"></label>

  
  <form action="" method="get" class="search-area">
    <input type="text" name="q" aria-labelledby="search-documentation" value="" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="search" placeholder="Search"/>
    <button value="search"></button>
    <span id="search-progress"></span>
  </form>
  
    <footer>
      &#169;2024, Analog Devices, Inc.
      
      |
      Made with <a href="https://www.sphinx-doc.org/">Sphinx</a>
      &amp; <a href="https://github.com/analogdevicesinc/doctools">Doctools</a>
      
    </footer>
  </body>
</html>